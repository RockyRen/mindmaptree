var er=Object.defineProperty;var ir=(T,e,s)=>e in T?er(T,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):T[e]=s;var b=(T,e,s)=>(ir(T,typeof e!="symbol"?e+"":e,s),s);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const u of document.querySelectorAll('link[rel="modulepreload"]'))h(u);new MutationObserver(u=>{for(const g of u)if(g.type==="childList")for(const w of g.addedNodes)w.tagName==="LINK"&&w.rel==="modulepreload"&&h(w)}).observe(document,{childList:!0,subtree:!0});function s(u){const g={};return u.integrity&&(g.integrity=u.integrity),u.referrerpolicy&&(g.referrerPolicy=u.referrerpolicy),u.crossorigin==="use-credentials"?g.credentials="include":u.crossorigin==="anonymous"?g.credentials="omit":g.credentials="same-origin",g}function h(u){if(u.ep)return;u.ep=!0;const g=s(u);fetch(u.href,g)}})();var bt=(T=>(T[T.LEFT=-1]="LEFT",T[T.NONE=0]="NONE",T[T.RIGHT=1]="RIGHT",T))(bt||{}),$t=(T=>(T[T.root=0]="root",T[T.firstLevel=1]="firstLevel",T[T.grandchild=2]="grandchild",T))($t||{});function De(T){return T===0?0:T===1?1:2}function ei(){function T(){return((1+Math.random())*65536|0).toString(16).substring(1)}return`${T()}${T()}-${T()}${T()}${T()}`}const rr=40,sr=25,nr=24,or=15;function ii(T){return De(T)===$t.firstLevel?sr:or}function Pi(T){return De(T)===$t.firstLevel?rr:nr}class ar{constructor(){b(this,"areaHeightMap",{})}getAreaHeight(e,s){const h=e.getBBox().height;if(!e.isExpand)return h;const u=`${e.id}_${s}`;if(this.areaHeightMap[u])return this.areaHeightMap[u];let g=0;const w=e.getDirectionChildren(s);if(w.length===0)g=h;else{const l=w.reduce((k,N)=>{const V=this.getAreaHeight(N,s);return k+V},0),o=ii(e.depth+1);if(g=l+(w.length-1)*o,g<h)return h}return this.areaHeightMap[e.id]=g,g}}class ri{constructor(e){b(this,"root");this.root=e===void 0?null:e}init(e){this.root=e}reset(e){if(!this.root)throw new Error("Position is called without root.");const s=new ar;e===bt.LEFT||e===bt.RIGHT?this.resetInner({node:this.root,direction:e,areaHeightHandler:s}):(this.resetInner({node:this.root,direction:bt.LEFT,areaHeightHandler:s}),this.resetInner({node:this.root,direction:bt.RIGHT,areaHeightHandler:s}))}resetInner({node:e,direction:s,areaHeightHandler:h}){if(!e.isExpand)return;const u=e.depth+1;let g=h.getAreaHeight(e,s);const w=ii(u),l=e.getBBox();let o=l.cy-g/2;const k=e.getDirectionChildren(s);k.forEach(N=>{const V=h.getAreaHeight(N,s);let W=k.length===1?g:V;const lt=N.getBBox(),Q=Pi(u),q=s===bt.RIGHT?l.x2+Q:l.x-Q-lt.width,J=o+W/2-lt.height/2;N.translateTo(q,J),this.resetInner({node:N,direction:s,areaHeightHandler:h}),o+=W+w})}}class hr{constructor({root:e,position:s,createNode:h}){b(this,"root");b(this,"position");b(this,"createNode");this.root=e,this.position=s,this.createNode=h}render(e){e&&(this.renderWithRelativeNode({nodeDataMap:e,sourceId:this.root.id,relativeNode:this.root,depth:0}),this.position.reset())}renderWithRelativeNode({nodeDataMap:e,sourceId:s,relativeNode:h,depth:u}){const g=h,w=e[s];w.label!==g.label&&g.setLabel(w.label,!1),w.isExpand!==g.isExpand&&g.changeExpand(w.isExpand,!1);const l=g.children;return g.clearChild(),w.children.forEach(o=>{if(!e[o])return;const N=l.findIndex(lt=>lt.id===o);let V=null;N>-1&&(V=l.splice(N,1)[0]);const W=V!==null?this.renderWithRelativeNode({nodeDataMap:e,sourceId:o,relativeNode:V,depth:u+1}):this.renderNew({nodeDataMap:e,sourceId:o,depth:u+1,father:g});g.pushChild(W)}),l.forEach(o=>{o.remove()}),g}renderNew({nodeDataMap:e,sourceId:s,depth:h,father:u}){const g=e[s],w=this.createNode({id:s,depth:h,label:g.label,direction:g.direction,father:u,isExpand:g.isExpand});return g.children.forEach(l=>{if(!e[l])return;const k=this.renderNew({nodeDataMap:e,sourceId:l,depth:h+1,father:w});w.pushChild(k)}),w}}class lr{constructor({data:e,viewport:s,selection:h,nodeCreator:u}){b(this,"root");b(this,"position");b(this,"selection");b(this,"treeRenderer");b(this,"nodeCreator");this.selection=h,this.nodeCreator=u,this.root=this.createRoot(e,s),this.position=new ri(this.root),this.treeRenderer=new hr({root:this.root,position:this.position,createNode:u.createNode}),this.render(e)}getRoot(){return this.root}clear(){this.root.remove()}render(e){this.treeRenderer.render(e)}createRoot(e={},s){let h=Object.keys(e).find(V=>e[V].isRoot===!0);const u=e[h],g=this.nodeCreator.createNode({id:h,depth:0,label:u.label,direction:u.direction}),{width:w,height:l}=s.getViewbox(),o=g.getBBox(),k=(w-o.width)/2,N=(l-o.height)/2;return g.translateTo(k,N),g}}class cr{constructor({position:e,selection:s,dataProxy:h,createNode:u}){b(this,"position");b(this,"selection");b(this,"dataProxy");b(this,"createNode");b(this,"changeFather",({newFather:e,direction:s,nodes:h,childIndex:u})=>{this.dataProxy.addSnapshot();const g=h.map(l=>this.cloneNode(l,e,s)),w=u===void 0?e.getDirectionChildren(s).length:u;e.spliceChild(w,0,s,g),e.changeExpand(!0),h.forEach(l=>l.remove()),this.selection.select(g),this.position.reset(),this.dataProxy.resetData()});this.position=e,this.selection=s,this.dataProxy=h,this.createNode=u}cloneNode(e,s,h){const u=this.createNode({id:ei(),depth:s.depth+1,label:e.label,direction:h,father:s,isExpand:e.isExpand});return e.children.forEach(g=>{const w=this.cloneNode(g,u,h);u.pushChild(w)}),u}}class dr{constructor({root:e,selection:s,dataProxy:h,nodeCreator:u}){b(this,"position");b(this,"selection");b(this,"dataProxy");b(this,"nodeCreator");b(this,"changeFatherOperation");b(this,"changeFather",e=>{this.changeFatherOperation.changeFather(e)});this.position=new ri(e),this.dataProxy=h,this.selection=s,this.nodeCreator=u,this.changeFatherOperation=new cr({position:this.position,selection:s,dataProxy:h,createNode:this.nodeCreator.createNode})}addChildNode(){var u;const e=this.selection.getSingleSelectNode();if(!e)return;let s=e.direction;if(e.isRoot()){const g=(u=e.children)==null?void 0:u.reduce((w,l)=>(l.direction===bt.LEFT?w[0]+=1:w[1]+=1,w),[0,0]);s=g[1]>g[0]?bt.LEFT:bt.RIGHT}const h=this.nodeCreator.createNode({depth:e.depth+1,label:"子主题",direction:s,father:e});this.dataProxy.addSnapshot(),e.pushChild(h),e.changeExpand(!0),this.position.reset(s),this.selection.select([h]),this.dataProxy.resetData()}addBrotherNode(){const e=this.selection.getSingleSelectNode();if(!e)return;if(e.isRoot()){this.addChildNode();return}const s=e.direction,h=e.father,u=this.nodeCreator.createNode({depth:e.depth,label:"子主题",direction:s,father:h});this.dataProxy.addSnapshot(),h.insertAfterChild(e,u),this.position.reset(s),this.selection.select([u]),this.dataProxy.resetData()}removeNode(){const e=this.selection.getTopNodes();if(e.length===0)return;const s=this.selection.getRemoveNextNode();this.dataProxy.addSnapshot(),e.forEach(h=>{h.remove()}),this.position.reset(),this.selection.select(s!==null?[s]:[]),this.dataProxy.resetData()}}function ur(T){return T&&T.__esModule&&Object.prototype.hasOwnProperty.call(T,"default")?T.default:T}var ie={},pr={get exports(){return ie},set exports(T){ie=T}};(function(T){var e=Object.prototype.hasOwnProperty,s="~";function h(){}Object.create&&(h.prototype=Object.create(null),new h().__proto__||(s=!1));function u(o,k,N){this.fn=o,this.context=k,this.once=N||!1}function g(o,k,N,V,W){if(typeof N!="function")throw new TypeError("The listener must be a function");var lt=new u(N,V||o,W),Q=s?s+k:k;return o._events[Q]?o._events[Q].fn?o._events[Q]=[o._events[Q],lt]:o._events[Q].push(lt):(o._events[Q]=lt,o._eventsCount++),o}function w(o,k){--o._eventsCount===0?o._events=new h:delete o._events[k]}function l(){this._events=new h,this._eventsCount=0}l.prototype.eventNames=function(){var k=[],N,V;if(this._eventsCount===0)return k;for(V in N=this._events)e.call(N,V)&&k.push(s?V.slice(1):V);return Object.getOwnPropertySymbols?k.concat(Object.getOwnPropertySymbols(N)):k},l.prototype.listeners=function(k){var N=s?s+k:k,V=this._events[N];if(!V)return[];if(V.fn)return[V.fn];for(var W=0,lt=V.length,Q=new Array(lt);W<lt;W++)Q[W]=V[W].fn;return Q},l.prototype.listenerCount=function(k){var N=s?s+k:k,V=this._events[N];return V?V.fn?1:V.length:0},l.prototype.emit=function(k,N,V,W,lt,Q){var q=s?s+k:k;if(!this._events[q])return!1;var J=this._events[q],Ct=arguments.length,U,R;if(J.fn){switch(J.once&&this.removeListener(k,J.fn,void 0,!0),Ct){case 1:return J.fn.call(J.context),!0;case 2:return J.fn.call(J.context,N),!0;case 3:return J.fn.call(J.context,N,V),!0;case 4:return J.fn.call(J.context,N,V,W),!0;case 5:return J.fn.call(J.context,N,V,W,lt),!0;case 6:return J.fn.call(J.context,N,V,W,lt,Q),!0}for(R=1,U=new Array(Ct-1);R<Ct;R++)U[R-1]=arguments[R];J.fn.apply(J.context,U)}else{var ct=J.length,rt;for(R=0;R<ct;R++)switch(J[R].once&&this.removeListener(k,J[R].fn,void 0,!0),Ct){case 1:J[R].fn.call(J[R].context);break;case 2:J[R].fn.call(J[R].context,N);break;case 3:J[R].fn.call(J[R].context,N,V);break;case 4:J[R].fn.call(J[R].context,N,V,W);break;default:if(!U)for(rt=1,U=new Array(Ct-1);rt<Ct;rt++)U[rt-1]=arguments[rt];J[R].fn.apply(J[R].context,U)}}return!0},l.prototype.on=function(k,N,V){return g(this,k,N,V,!1)},l.prototype.once=function(k,N,V){return g(this,k,N,V,!0)},l.prototype.removeListener=function(k,N,V,W){var lt=s?s+k:k;if(!this._events[lt])return this;if(!N)return w(this,lt),this;var Q=this._events[lt];if(Q.fn)Q.fn===N&&(!W||Q.once)&&(!V||Q.context===V)&&w(this,lt);else{for(var q=0,J=[],Ct=Q.length;q<Ct;q++)(Q[q].fn!==N||W&&!Q[q].once||V&&Q[q].context!==V)&&J.push(Q[q]);J.length?this._events[lt]=J.length===1?J[0]:J:w(this,lt)}return this},l.prototype.removeAllListeners=function(k){var N;return k?(N=s?s+k:k,this._events[N]&&w(this,N)):(this._events=new h,this._eventsCount=0),this},l.prototype.off=l.prototype.removeListener,l.prototype.addListener=l.prototype.on,l.prefixed=s,l.EventEmitter=l,T.exports=l})(pr);const He=3,Fe=.25;class fr{constructor(e,s=1){b(this,"paper");b(this,"eventEmitter");b(this,"viewbox",{x:0,y:0,width:0,height:0});b(this,"wrapperWidth");b(this,"wrapperHeight");this.paperWrapper=e,this.scale=s,this.paper=this.paperWrapper.getPaper();const h=this.paperWrapper.getSize();this.wrapperWidth=h.width,this.wrapperHeight=h.height,this.eventEmitter=new ie,s>He?s=He:s<Fe&&(s=Fe),this.setScale(s)}getViewbox(){return this.viewbox}getScale(){return this.scale}setScale(e){e>He?e=He:e<Fe&&(e=Fe);const s=this.viewbox;s.width=this.wrapperWidth/e,s.height=this.wrapperHeight/e,s.x=this.getScalePosition(this.scale,e,s.x,this.wrapperWidth),s.y=this.getScalePosition(this.scale,e,s.y,this.wrapperHeight),this.scale=e,this.setViewBox(),this.eventEmitter.emit("changeScale",this.scale)}addScale(e){const s=this.scale+e;this.setScale(s)}on(e,s){this.eventEmitter.on(e,s)}translate(e,s){const h=this.viewbox;h.x=h.x+e/this.scale,h.y=h.y+s/this.scale,this.setViewBox()}translateTo(e,s){const h=this.viewbox;h.x=e,h.y=s,this.setViewBox()}resize(e,s){const h=this.viewbox;h.width=e/this.wrapperWidth*h.width,h.height=s/this.wrapperHeight*h.height,this.setViewBox(),this.wrapperWidth=e,this.wrapperHeight=s}getViewportPosition(e,s){const u=this.paperWrapper.getWrapperDom().getBoundingClientRect();return{x:this.viewbox.x+(e-u.x)/this.scale,y:this.viewbox.y+(s-u.y)/this.scale}}getOffsetPosition(e,s){return{offsetX:(e-this.viewbox.x)*this.scale,offsetY:(s-this.viewbox.y)*this.scale}}getScalePosition(e,s,h,u){return h+u*(1/e-1/s)/2}setViewBox(){const e=this.viewbox;this.paper.setViewBox(e.x,e.y,e.width,e.height,!0)}}class zi{constructor(e){b(this,"eventArgs",{});this.shape=e}on(e,...s){e&&(this.eventArgs[e]===void 0&&(this.eventArgs[e]=[]),this.eventArgs[e].push(s),this.shape[e](...s))}removeAllListeners(){Object.keys(this.eventArgs).forEach(s=>{const h=this.eventArgs[s];h==null||h.forEach(u=>{this.shape[`un${s}`](...u)})})}}const gr={"font-size":16,fill:"#000",opacity:1},vr={"fill-opacity":0,stroke:"#808080","stroke-opacity":1,opacity:1},mr={stroke:"#fff","stroke-width":2,fill:"#fff","fill-opacity":0,opacity:0};class yr{constructor({shapeSet:e,labelShape:s,borderShape:h,rectShape:u,labelBaseAttr:g,rectBaseAttr:w,borderBaseAttr:l}){b(this,"shapeSet");b(this,"borderShape");b(this,"labelShape");b(this,"rectShape");b(this,"labelBaseAttr");b(this,"rectBaseAttr");b(this,"borderBaseAttr");b(this,"styleType","base");this.shapeSet=e,this.labelShape=s,this.borderShape=h,this.rectShape=u,this.labelBaseAttr={...gr,...g},this.rectBaseAttr={...vr,...w},this.borderBaseAttr={...mr,...l}}setBaseStyle(){this.labelShape.attr(this.labelBaseAttr),this.borderShape.attr(this.borderBaseAttr),this.rectShape.attr(this.rectBaseAttr)}setStyle(e){switch(e){case"select":{this.setBaseStyle(),this.borderShape.attr({stroke:"#3498DB",opacity:1});break}case"overlay":{this.setBaseStyle(),this.borderShape.attr({stroke:"#E74C3C",opacity:.8});break}case"disable":{this.shapeSet.attr({opacity:.4});break}case"hover":{this.setBaseStyle(),this.borderShape.attr({stroke:"#3498DB",opacity:.5});break}case"base":default:{this.setBaseStyle();break}}this.styleType=e}getStyle(){return this.styleType}getBaseAttr(){return{labelBaseAttr:this.labelBaseAttr,borderBaseAttr:this.borderBaseAttr,rectBaseAttr:this.rectBaseAttr}}}const xr=-999999,br=-999999,wr=40,Sr=37,Oe=6;class Le{constructor({paper:e,x:s,y:h,label:u,paddingWidth:g=wr,rectHeight:w=Sr,labelBaseAttr:l,rectBaseAttr:o,borderBaseAttr:k}){b(this,"paper");b(this,"shapeSet");b(this,"borderShape");b(this,"labelShape");b(this,"rectShape");b(this,"paddingWidth");b(this,"rectHeight");b(this,"shapeEventEmitter");b(this,"nodeShapeStyle");b(this,"label");b(this,"isHide",!1);b(this,"isHoverInCalled",!1);this.paper=e,this.label=u,this.paddingWidth=g,this.rectHeight=w;const N=s!==void 0&&h!==void 0,V=N?s:xr,W=N?h:br;this.labelShape=e.text(V,W,u),this.borderShape=e.rect(V,W,0,0,4),this.rectShape=e.rect(V,W,0,0,4),this.shapeSet=e.set().push(this.labelShape).push(this.borderShape).push(this.rectShape),this.nodeShapeStyle=new yr({shapeSet:this.shapeSet,labelShape:this.labelShape,borderShape:this.borderShape,rectShape:this.rectShape,labelBaseAttr:l,rectBaseAttr:o,borderBaseAttr:k}),this.nodeShapeStyle.setBaseStyle(),this.labelShape.toFront(),this.labelShape.node.style["user-select"]="none",this.setPosition(V,W),this.shapeEventEmitter=new zi(this.shapeSet),N||this.hide(),this.initHover()}getBBox(){return this.rectShape.getBBox()}setLabel(e,s){const h=this.labelShape.getBBox();this.labelShape.attr({text:e});const u=this.labelShape.getBBox(),g=this.getBBox(),w=u.width-h.width;this.setPosition(g.x,g.y),s!==bt.RIGHT&&s!==bt.LEFT&&this.shapeSet.translate(-w/2,0),this.label=e}translateTo(e,s){const{x:h,y:u}=this.getBBox(),g=e-h,w=s-u;this.show(),!(g===0&&w===0)&&this.shapeSet.translate(g,w)}translate(e,s){this.shapeSet.translate(e,s)}setStyle(e){this.nodeShapeStyle.setStyle(e)}getStyle(){return this.nodeShapeStyle.getStyle()}clone(){const{x:e,y:s}=this.getBBox();return new Le({paper:this.paper,x:e,y:s,label:this.label,paddingWidth:this.paddingWidth,rectHeight:this.rectHeight,...this.nodeShapeStyle.getBaseAttr()})}remove(){this.shapeSet.remove(),this.shapeEventEmitter.removeAllListeners()}on(e,...s){this.shapeEventEmitter.on(e,...s)}show(){this.shapeSet.show(),this.isHide=!1}hide(){this.shapeSet.hide(),this.isHide=!0}getIsHide(){return this.isHide}toFront(){this.borderShape.toFront(),this.rectShape.toFront(),this.labelShape.toFront()}shapeTranslateTo(e,s,h){const{x:u,y:g}=e.getBBox(),w=s-u,l=h-g;w===0&&l===0||e.translate(w,l)}setPosition(e,s){const{labelShape:h,borderShape:u,rectShape:g,paddingWidth:w,rectHeight:l}=this,o=h.getBBox(),k=o.width+w;g.attr({width:k,height:l}),u.attr({width:k+Oe,height:l+Oe});const N=g.getBBox();this.shapeTranslateTo(h,e+(N.width-o.width)/2,s+(N.height-o.height)/2),this.shapeTranslateTo(g,e,s),this.shapeTranslateTo(u,e-Oe/2,s-Oe/2)}initHover(){this.shapeEventEmitter.on("hover",()=>{const e=this.nodeShapeStyle.getStyle();e!=="select"&&e!=="disable"&&(this.nodeShapeStyle.setStyle("hover"),this.isHoverInCalled=!0)},()=>{const e=this.nodeShapeStyle.getStyle();this.isHoverInCalled&&e!=="select"&&e!=="disable"&&(this.nodeShapeStyle.setStyle("base"),this.isHoverInCalled=!1)})}}const Hi=25,Er=42,_r=52;function kr(T){return new Le({...T,labelBaseAttr:{"font-size":Hi,fill:"#fff","fill-opacity":1},rectBaseAttr:{fill:"#3F89DE","fill-opacity":1,"stroke-opacity":0},paddingWidth:Er,rectHeight:_r})}const Fi=16,Cr=40,Nr=37;function Br(T){return new Le({...T,labelBaseAttr:{"font-size":Fi},rectBaseAttr:{fill:"#eee","fill-opacity":1,stroke:"#808080","stroke-opacity":0},paddingWidth:Cr,rectHeight:Nr})}const Oi=13,Dr=20,Lr=21;function Tr(T){return new Le({...T,labelBaseAttr:{"font-size":Oi},rectBaseAttr:{"stroke-opacity":0},paddingWidth:Dr,rectHeight:Lr})}const _i={[$t.root]:Hi,[$t.firstLevel]:Fi,[$t.grandchild]:Oi};class Ir{constructor({viewport:e,selection:s,dataProxy:h,paperWrapper:u}){b(this,"editorWrapperDom");b(this,"editorDom");b(this,"viewport");b(this,"dataProxy");b(this,"isShow",!1);b(this,"node",null);this.viewport=e,this.dataProxy=h;const g=this.initTextEditorElement(u);this.editorWrapperDom=g.editorWrapperDom,this.editorDom=g.editorDom,s.on("select",()=>{var l;const w=s.getSelectNodes();w.length===1&&((l=this.node)==null?void 0:l.id)!==w[0].id?(console.log("focus & change----"),this.setLabel(),this.editorDom.focus(),this.editorDom.innerText="",this.hide(),this.node=w[0],this.translate()):this.node!==null&&(w.length!==1||w[0].id!==this.node.id)&&(console.log("blur----"),this.setLabel(),this.editorDom.innerText="",this.editorDom.blur(),this.hide(),this.node=null)}),this.editorDom.addEventListener("compositionstart",()=>{this.isShow||this.show()}),this.editorDom.addEventListener("input",w=>{const l=w.data;console.log("input",l,this.isEditableKey(l)),this.isShow||(this.isEditableKey(l)?this.show():this.editorDom.innerText="")})}showBySelectionLabel(){var e;this.show(),this.editorDom.innerText=((e=this.node)==null?void 0:e.label)||"",document.execCommand("selectAll",!1,null),document.getSelection().collapseToEnd()}isShowing(){return this.isShow}finishEdit(){this.setLabel(),this.editorDom.innerText="",this.hide()}show(){if(this.node===null)return;console.log("show----",this.node.id);const e=this.viewport.getScale(),s=_i[this.node.getDepthType()]*e;this.editorWrapperDom.style.zIndex="3",this.editorDom.style.fontSize=`${s}px`,this.translate(),this.editorDom.focus(),this.isShow=!0}hide(){console.log("hide----"),this.editorWrapperDom.style.zIndex="-9999",this.isShow=!1}initTextEditorElement(e){const s=document.createElement("div");s.className="node-edit-text-wrapper";const h=document.createElement("div");h.className="node-edit-text",h.setAttribute("contenteditable","true");const u=e.getContainerDom();return s.appendChild(h),u.appendChild(s),{editorWrapperDom:s,editorDom:h}}isEditableKey(e){const s=["`","-","=","[","]","\\",";","'",",",".","/"];return/^[\w\s]$/.test(e)||s.includes(e)}translate(){if(this.node===null)return;const{cx:e,cy:s}=this.node.getBBox(),{offsetX:h,offsetY:u}=this.viewport.getOffsetPosition(e,s),g=this.viewport.getScale(),l=(1.4*_i[this.node.getDepthType()]+6)*g;this.editorWrapperDom.style.left=`${h-300}px`,this.editorWrapperDom.style.top=`${u-l/2}px`}setLabel(){const e=this.editorDom.innerText;this.node!==null&&this.isShow&&e!==this.node.label&&(this.node.setLabel(e),this.dataProxy.setData(this.node.id,{label:e},[this.node.id]))}}class Mr{constructor(){}getRemoveNextNode(e){return e[e.length-1],null}getArrowNextNode(e,s){let h=null;switch(s){case"ArrowUp":{h=this.getVeriticalNext(e,!0);break}case"ArrowRight":{h=this.getHorizontal(e,bt.RIGHT);break}case"ArrowDown":{h=this.getVeriticalNext(e,!1);break}case"ArrowLeft":{h=this.getHorizontal(e,bt.LEFT);break}}return h}getHorizontal(e,s){if(e.direction!==bt.NONE&&e.direction!==s)return e.father;const u=e.getDirectionChildren(s),g=Math.floor((u.length-1)/2);return u[g]||null}getVeriticalNext(e,s){if(e.isRoot()){const w=e.getDirectionChildren(bt.RIGHT),l=e.getDirectionChildren(bt.LEFT),o=w.length>0?w:l,k=o[0]||null,N=o[o.length-1]||null;return s?k:N}let h=0,u=e,g=null;for(;u!==null&&!(u!=null&&u.isRoot());){const w=this.getNextBrothers(u,s);for(let l=0;l<w.length;l++){const o=this.findTargetDepthNode(w[l],h,0,s);if(o){g=o;break}}if(g)break;u=u==null?void 0:u.father,h+=1}return g}findTargetDepthNode(e,s,h,u){if(s===h)return e;let g=null,w=e.getDirectionChildren(e.direction);u&&(w=w.reverse());for(let l=0;l<w.length;l++){const o=w[l],k=this.findTargetDepthNode(o,s,h+1,u);if(k){g=k;break}}return g}getNextBrothers(e,s){var w;const h=[];let u=((w=e==null?void 0:e.father)==null?void 0:w.getDirectionChildren(e.direction))||[];s&&(u=u.reverse());let g=!1;for(let l=0;l<u.length;l++)g&&h.push(u[l]),u[l].id===e.id&&(g=!0);return h}}class Rr{constructor(){}getRemoveNextNode(e){if(e.length===0)return null;for(let s=e.length-1;s>=0;s--){const h=e[s],u=this.getTopNode(h,e);if(u.isRoot())return null;const g=u.father.getDirectionChildren(u.direction),w=g.findIndex(W=>W.id===u.id);let l=w-1,o=g[l];for(;e.includes(o)&&o;)l-=1,o=g[l];if(o)return o;let k=w+1,N=g[k];for(;e.includes(N)&&N;)k+=1,N=g[k];if(N)return N;if(u.getDepthType()===$t.firstLevel){const W=u.direction===bt.RIGHT?bt.LEFT:bt.RIGHT,lt=u.father.getDirectionChildren(W),Q=lt[lt.length-1];if(Q&&!e.includes(Q))return Q}const V=u.father;if(!V.isRoot())return V}return null}getTopNode(e,s){let h=e,u=e;for(;u!==null;)s.includes(u)&&(h=u),u=u.father;return h}}class Ar{constructor(){b(this,"selectNodes",[]);b(this,"selectionArrowNext");b(this,"selectionRemoveNext");b(this,"eventEmitter");b(this,"isMultiClickMode",!1);b(this,"getTopNodes",()=>{if(this.selectNodes.length===0)return[];const e=this.selectNodes.reduce((h,u)=>(h[u.id]=u,h),{}),s=this.selectNodes[0].getRoot();return!s||e[s.id]?[]:this.getTopNodesInner(s,e)});this.selectionArrowNext=new Mr,this.selectionRemoveNext=new Rr,this.eventEmitter=new ie}setIsMultiClickMode(e){this.isMultiClickMode=e}select(e){const s=[...e];this.selectNodes.forEach(h=>h.setStyle("base")),s.forEach(h=>h.setStyle("select")),this.selectNodes=s,this.eventEmitter.emit("select",this.selectNodes)}selectSingle(e){if(!this.isMultiClickMode){this.select([e]);return}const s=this.selectNodes.findIndex(h=>h.id===e.id);s>=0?(e.setStyle("base"),this.selectNodes.splice(s,1)):(e.setStyle("select"),this.selectNodes.push(e)),this.eventEmitter.emit("select",this.selectNodes)}selectArrowNext(e){const s=this.selectNodes[this.selectNodes.length-1];if(!s)return;const h=this.selectionArrowNext.getArrowNextNode(s,e);h&&this.select([h])}empty(){this.select([])}on(e,s){this.eventEmitter.on(e,s)}getSelectNodes(){return this.selectNodes}getSelectIds(){return this.selectNodes.map(e=>e.id)}getSingleSelectNode(){return this.selectNodes.length!==1?null:this.selectNodes[0]}getRemoveNextNode(){return this.selectionRemoveNext.getRemoveNextNode(this.selectNodes)}getTopNodesInner(e,s){if(!e.isRoot()&&s[e.id])return[e];let h=[];return e.children&&e.children.forEach(u=>{const g=this.getTopNodesInner(u,s);g.length>0&&(h=h.concat(g))}),h}}var Qe={},Pr={get exports(){return Qe},set exports(T){Qe=T}};(function(T,e){(function(s,h){T.exports=h()})(window,function(){return function(s){var h={};function u(g){if(h[g])return h[g].exports;var w=h[g]={i:g,l:!1,exports:{}};return s[g].call(w.exports,w,w.exports,u),w.l=!0,w.exports}return u.m=s,u.c=h,u.d=function(g,w,l){u.o(g,w)||Object.defineProperty(g,w,{enumerable:!0,get:l})},u.r=function(g){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(g,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(g,"__esModule",{value:!0})},u.t=function(g,w){if(1&w&&(g=u(g)),8&w||4&w&&typeof g=="object"&&g&&g.__esModule)return g;var l=Object.create(null);if(u.r(l),Object.defineProperty(l,"default",{enumerable:!0,value:g}),2&w&&typeof g!="string")for(var o in g)u.d(l,o,function(k){return g[k]}.bind(null,o));return l},u.n=function(g){var w=g&&g.__esModule?function(){return g.default}:function(){return g};return u.d(w,"a",w),w},u.o=function(g,w){return Object.prototype.hasOwnProperty.call(g,w)},u.p="",u(u.s=1)}([function(s,h,u){var g,w;g=[u(2)],(w=function(l){function o(t){if(o.is(t,"function"))return k?t():l.on("raphael.DOMload",t);if(o.is(t,mt))return o._engine.create[U](o,t.splice(0,3+o.is(t[0],ft))).add(t);var i=Array.prototype.slice.call(arguments,0);if(o.is(i[i.length-1],"function")){var r=i.pop();return k?r.call(o._engine.create[U](o,i)):l.on("raphael.DOMload",function(){r.call(o._engine.create[U](o,i))})}return o._engine.create[U](o,arguments)}o.version="2.3.0",o.eve=l;var k,N,V=/[, ]+/,W={circle:1,rect:1,path:1,ellipse:1,text:1,image:1},lt=/\{(\d+)\}/g,Q="hasOwnProperty",q={doc:document,win:window},J={was:Object.prototype[Q].call(q.win,"Raphael"),is:q.win.Raphael},Ct=function(){this.ca=this.customAttributes={}},U="apply",R="concat",ct="ontouchstart"in window||window.TouchEvent||window.DocumentTouch&&document instanceof DocumentTouch,rt="",pt=" ",Y=String,tt="split",nt="click dblclick mousedown mousemove mouseout mouseover mouseup touchstart touchmove touchend touchcancel"[tt](pt),wt={mousedown:"touchstart",mousemove:"touchmove",mouseup:"touchend"},at=Y.prototype.toLowerCase,K=Math,st=K.max,it=K.min,Et=K.abs,Dt=K.pow,Lt=K.PI,ft="number",mt="array",Wt=Object.prototype.toString,f=(o._ISURL=/^url\(['"]?(.+?)['"]?\)$/i,/^\s*((#[a-f\d]{6})|(#[a-f\d]{3})|rgba?\(\s*([\d\.]+%?\s*,\s*[\d\.]+%?\s*,\s*[\d\.]+%?(?:\s*,\s*[\d\.]+%?)?)\s*\)|hsba?\(\s*([\d\.]+(?:deg|\xb0|%)?\s*,\s*[\d\.]+%?\s*,\s*[\d\.]+(?:%?\s*,\s*[\d\.]+)?)%?\s*\)|hsla?\(\s*([\d\.]+(?:deg|\xb0|%)?\s*,\s*[\d\.]+%?\s*,\s*[\d\.]+(?:%?\s*,\s*[\d\.]+)?)%?\s*\))\s*$/i),d={NaN:1,Infinity:1,"-Infinity":1},c=/^(?:cubic-)?bezier\(([^,]+),([^,]+),([^,]+),([^\)]+)\)/,y=K.round,S=parseFloat,_=parseInt,C=Y.prototype.toUpperCase,z=o._availableAttrs={"arrow-end":"none","arrow-start":"none",blur:0,"clip-rect":"0 0 1e9 1e9",cursor:"default",cx:0,cy:0,fill:"#fff","fill-opacity":1,font:'10px "Arial"',"font-family":'"Arial"',"font-size":"10","font-style":"normal","font-weight":400,gradient:0,height:0,href:"http://raphaeljs.com/","letter-spacing":0,opacity:1,path:"M0,0",r:0,rx:0,ry:0,src:"",stroke:"#000","stroke-dasharray":"","stroke-linecap":"butt","stroke-linejoin":"butt","stroke-miterlimit":0,"stroke-opacity":1,"stroke-width":1,target:"_blank","text-anchor":"middle",title:"Raphael",transform:"",width:0,x:0,y:0,class:""},B=o._availableAnimAttrs={blur:ft,"clip-rect":"csv",cx:ft,cy:ft,fill:"colour","fill-opacity":ft,"font-size":ft,height:ft,opacity:ft,path:"path",r:ft,rx:ft,ry:ft,stroke:"colour","stroke-opacity":ft,"stroke-width":ft,transform:"transform",width:ft,x:ft,y:ft},G=/[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*,[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*/,j={hs:1,rg:1},et=/,?([achlmqrstvxz]),?/gi,gt=/([achlmrqstvz])[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029,]*((-?\d*\.?\d*(?:e[\-+]?\d+)?[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*,?[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*)+)/gi,yt=/([rstm])[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029,]*((-?\d*\.?\d*(?:e[\-+]?\d+)?[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*,?[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*)+)/gi,vt=/(-?\d*\.?\d*(?:e[\-+]?\d+)?)[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*,?[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*/gi,kt=(o._radial_gradient=/^r(?:\(([^,]+?)[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*,[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*([^\)]+?)\))?/,{}),Nt=function(t,i){return S(t)-S(i)},St=function(t){return t},ht=o._rectPath=function(t,i,r,n,a){return a?[["M",t+a,i],["l",r-2*a,0],["a",a,a,0,0,1,a,a],["l",0,n-2*a],["a",a,a,0,0,1,-a,a],["l",2*a-r,0],["a",a,a,0,0,1,-a,-a],["l",0,2*a-n],["a",a,a,0,0,1,a,-a],["z"]]:[["M",t,i],["l",r,0],["l",0,n],["l",-r,0],["z"]]},It=function(t,i,r,n){return n==null&&(n=r),[["M",t,i],["m",0,-n],["a",r,n,0,1,1,0,2*n],["a",r,n,0,1,1,0,-2*n],["z"]]},Tt=o._getPath={path:function(t){return t.attr("path")},circle:function(t){var i=t.attrs;return It(i.cx,i.cy,i.r)},ellipse:function(t){var i=t.attrs;return It(i.cx,i.cy,i.rx,i.ry)},rect:function(t){var i=t.attrs;return ht(i.x,i.y,i.width,i.height,i.r)},image:function(t){var i=t.attrs;return ht(i.x,i.y,i.width,i.height)},text:function(t){var i=t._getBBox();return ht(i.x,i.y,i.width,i.height)},set:function(t){var i=t._getBBox();return ht(i.x,i.y,i.width,i.height)}},Mt=o.mapPath=function(t,i){if(!i)return t;var r,n,a,p,m,v,x;for(a=0,m=(t=ke(t)).length;a<m;a++)for(p=1,v=(x=t[a]).length;p<v;p+=2)r=i.x(x[p],x[p+1]),n=i.y(x[p],x[p+1]),x[p]=r,x[p+1]=n;return t};if(o._g=q,o.type=q.win.SVGAngle||q.doc.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#BasicStructure","1.1")?"SVG":"VML",o.type=="VML"){var Bt,Ft=q.doc.createElement("div");if(Ft.innerHTML='<v:shape adj="1"/>',(Bt=Ft.firstChild).style.behavior="url(#default#VML)",!Bt||typeof Bt.adj!="object")return o.type=rt;Ft=null}function Pt(t){if(typeof t=="function"||Object(t)!==t)return t;var i=new t.constructor;for(var r in t)t[Q](r)&&(i[r]=Pt(t[r]));return i}o.svg=!(o.vml=o.type=="VML"),o._Paper=Ct,o.fn=N=Ct.prototype=o.prototype,o._id=0,o.is=function(t,i){return(i=at.call(i))=="finite"?!d[Q](+t):i=="array"?t instanceof Array:i=="null"&&t===null||i==typeof t&&t!==null||i=="object"&&t===Object(t)||i=="array"&&Array.isArray&&Array.isArray(t)||Wt.call(t).slice(8,-1).toLowerCase()==i},o.angle=function(t,i,r,n,a,p){if(a==null){var m=t-r,v=i-n;return m||v?(180+180*K.atan2(-v,-m)/Lt+360)%360:0}return o.angle(t,i,a,p)-o.angle(r,n,a,p)},o.rad=function(t){return t%360*Lt/180},o.deg=function(t){return Math.round(180*t/Lt%360*1e3)/1e3},o.snapTo=function(t,i,r){if(r=o.is(r,"finite")?r:10,o.is(t,mt)){for(var n=t.length;n--;)if(Et(t[n]-i)<=r)return t[n]}else{var a=i%(t=+t);if(a<r)return i-a;if(a>t-r)return i-a+t}return i};var Ut,we;o.createUUID=(Ut=/[xy]/g,we=function(t){var i=16*K.random()|0;return(t=="x"?i:3&i|8).toString(16)},function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(Ut,we).toUpperCase()}),o.setWindow=function(t){l("raphael.setWindow",o,q.win,t),q.win=t,q.doc=q.win.document,o._engine.initWin&&o._engine.initWin(q.win)};var Kt=function(t){if(o.vml){var i,r=/^\s+|\s+$/g;try{var n=new ActiveXObject("htmlfile");n.write("<body>"),n.close(),i=n.body}catch{i=createPopup().document.body}var a=i.createTextRange();Kt=Rt(function(m){try{i.style.color=Y(m).replace(r,rt);var v=a.queryCommandValue("ForeColor");return"#"+("000000"+(v=(255&v)<<16|65280&v|(16711680&v)>>>16).toString(16)).slice(-6)}catch{return"none"}})}else{var p=q.doc.createElement("i");p.title="Raphaël Colour Picker",p.style.display="none",q.doc.body.appendChild(p),Kt=Rt(function(m){return p.style.color=m,q.doc.defaultView.getComputedStyle(p,rt).getPropertyValue("color")})}return Kt(t)},he=function(){return"hsb("+[this.h,this.s,this.b]+")"},le=function(){return"hsl("+[this.h,this.s,this.l]+")"},Se=function(){return this.hex},ce=function(t,i,r){if(i==null&&o.is(t,"object")&&"r"in t&&"g"in t&&"b"in t&&(r=t.b,i=t.g,t=t.r),i==null&&o.is(t,"string")){var n=o.getRGB(t);t=n.r,i=n.g,r=n.b}return(t>1||i>1||r>1)&&(t/=255,i/=255,r/=255),[t,i,r]},Te=function(t,i,r,n){var a={r:t*=255,g:i*=255,b:r*=255,hex:o.rgb(t,i,r),toString:Se};return o.is(n,"finite")&&(a.opacity=n),a};function Rt(t,i,r){return function n(){var a=Array.prototype.slice.call(arguments,0),p=a.join("␀"),m=n.cache=n.cache||{},v=n.count=n.count||[];return m[Q](p)?(function(x,E){for(var L=0,H=x.length;L<H;L++)if(x[L]===E)return x.push(x.splice(L,1)[0])}(v,p),r?r(m[p]):m[p]):(v.length>=1e3&&delete m[v.shift()],v.push(p),m[p]=t[U](i,a),r?r(m[p]):m[p])}}o.color=function(t){var i;return o.is(t,"object")&&"h"in t&&"s"in t&&"b"in t?(i=o.hsb2rgb(t),t.r=i.r,t.g=i.g,t.b=i.b,t.hex=i.hex):o.is(t,"object")&&"h"in t&&"s"in t&&"l"in t?(i=o.hsl2rgb(t),t.r=i.r,t.g=i.g,t.b=i.b,t.hex=i.hex):(o.is(t,"string")&&(t=o.getRGB(t)),o.is(t,"object")&&"r"in t&&"g"in t&&"b"in t?(i=o.rgb2hsl(t),t.h=i.h,t.s=i.s,t.l=i.l,i=o.rgb2hsb(t),t.v=i.b):(t={hex:"none"}).r=t.g=t.b=t.h=t.s=t.v=t.l=-1),t.toString=Se,t},o.hsb2rgb=function(t,i,r,n){var a,p,m,v,x;return this.is(t,"object")&&"h"in t&&"s"in t&&"b"in t&&(r=t.b,i=t.s,n=t.o,t=t.h),v=(x=r*i)*(1-Et((t=(t*=360)%360/60)%2-1)),a=p=m=r-x,Te(a+=[x,v,0,0,v,x][t=~~t],p+=[v,x,x,v,0,0][t],m+=[0,0,v,x,x,v][t],n)},o.hsl2rgb=function(t,i,r,n){var a,p,m,v,x;return this.is(t,"object")&&"h"in t&&"s"in t&&"l"in t&&(r=t.l,i=t.s,t=t.h),(t>1||i>1||r>1)&&(t/=360,i/=100,r/=100),v=(x=2*i*(r<.5?r:1-r))*(1-Et((t=(t*=360)%360/60)%2-1)),a=p=m=r-x/2,Te(a+=[x,v,0,0,v,x][t=~~t],p+=[v,x,x,v,0,0][t],m+=[0,0,v,x,x,v][t],n)},o.rgb2hsb=function(t,i,r){var n,a;return t=(r=ce(t,i,r))[0],i=r[1],r=r[2],{h:(((a=(n=st(t,i,r))-it(t,i,r))==0?null:n==t?(i-r)/a:n==i?(r-t)/a+2:(t-i)/a+4)+360)%6*60/360,s:a==0?0:a/n,b:n,toString:he}},o.rgb2hsl=function(t,i,r){var n,a,p,m;return t=(r=ce(t,i,r))[0],i=r[1],r=r[2],n=((a=st(t,i,r))+(p=it(t,i,r)))/2,{h:(((m=a-p)==0?null:a==t?(i-r)/m:a==i?(r-t)/m+2:(t-i)/m+4)+360)%6*60/360,s:m==0?0:n<.5?m/(2*n):m/(2-2*n),l:n,toString:le}},o._path2string=function(){return this.join(",").replace(et,"$1")},o._preload=function(t,i){var r=q.doc.createElement("img");r.style.cssText="position:absolute;left:-9999em;top:-9999em",r.onload=function(){i.call(this),this.onload=null,q.doc.body.removeChild(this)},r.onerror=function(){q.doc.body.removeChild(this)},q.doc.body.appendChild(r),r.src=t};function Zt(){return this.hex}function de(t,i){for(var r=[],n=0,a=t.length;a-2*!i>n;n+=2){var p=[{x:+t[n-2],y:+t[n-1]},{x:+t[n],y:+t[n+1]},{x:+t[n+2],y:+t[n+3]},{x:+t[n+4],y:+t[n+5]}];i?n?a-4==n?p[3]={x:+t[0],y:+t[1]}:a-2==n&&(p[2]={x:+t[0],y:+t[1]},p[3]={x:+t[2],y:+t[3]}):p[0]={x:+t[a-2],y:+t[a-1]}:a-4==n?p[3]=p[2]:n||(p[0]={x:+t[n],y:+t[n+1]}),r.push(["C",(-p[0].x+6*p[1].x+p[2].x)/6,(-p[0].y+6*p[1].y+p[2].y)/6,(p[1].x+6*p[2].x-p[3].x)/6,(p[1].y+6*p[2].y-p[3].y)/6,p[2].x,p[2].y])}return r}o.getRGB=Rt(function(t){if(!t||(t=Y(t)).indexOf("-")+1)return{r:-1,g:-1,b:-1,hex:"none",error:1,toString:Zt};if(t=="none")return{r:-1,g:-1,b:-1,hex:"none",toString:Zt};!j[Q](t.toLowerCase().substring(0,2))&&t.charAt()!="#"&&(t=Kt(t));var i,r,n,a,p,m,v=t.match(f);return v?(v[2]&&(n=_(v[2].substring(5),16),r=_(v[2].substring(3,5),16),i=_(v[2].substring(1,3),16)),v[3]&&(n=_((p=v[3].charAt(3))+p,16),r=_((p=v[3].charAt(2))+p,16),i=_((p=v[3].charAt(1))+p,16)),v[4]&&(m=v[4][tt](G),i=S(m[0]),m[0].slice(-1)=="%"&&(i*=2.55),r=S(m[1]),m[1].slice(-1)=="%"&&(r*=2.55),n=S(m[2]),m[2].slice(-1)=="%"&&(n*=2.55),v[1].toLowerCase().slice(0,4)=="rgba"&&(a=S(m[3])),m[3]&&m[3].slice(-1)=="%"&&(a/=100)),v[5]?(m=v[5][tt](G),i=S(m[0]),m[0].slice(-1)=="%"&&(i*=2.55),r=S(m[1]),m[1].slice(-1)=="%"&&(r*=2.55),n=S(m[2]),m[2].slice(-1)=="%"&&(n*=2.55),(m[0].slice(-3)=="deg"||m[0].slice(-1)=="°")&&(i/=360),v[1].toLowerCase().slice(0,4)=="hsba"&&(a=S(m[3])),m[3]&&m[3].slice(-1)=="%"&&(a/=100),o.hsb2rgb(i,r,n,a)):v[6]?(m=v[6][tt](G),i=S(m[0]),m[0].slice(-1)=="%"&&(i*=2.55),r=S(m[1]),m[1].slice(-1)=="%"&&(r*=2.55),n=S(m[2]),m[2].slice(-1)=="%"&&(n*=2.55),(m[0].slice(-3)=="deg"||m[0].slice(-1)=="°")&&(i/=360),v[1].toLowerCase().slice(0,4)=="hsla"&&(a=S(m[3])),m[3]&&m[3].slice(-1)=="%"&&(a/=100),o.hsl2rgb(i,r,n,a)):((v={r:i,g:r,b:n,toString:Zt}).hex="#"+(16777216|n|r<<8|i<<16).toString(16).slice(1),o.is(a,"finite")&&(v.opacity=a),v)):{r:-1,g:-1,b:-1,hex:"none",error:1,toString:Zt}},o),o.hsb=Rt(function(t,i,r){return o.hsb2rgb(t,i,r).hex}),o.hsl=Rt(function(t,i,r){return o.hsl2rgb(t,i,r).hex}),o.rgb=Rt(function(t,i,r){function n(a){return a+.5|0}return"#"+(16777216|n(r)|n(i)<<8|n(t)<<16).toString(16).slice(1)}),o.getColor=function(t){var i=this.getColor.start=this.getColor.start||{h:0,s:1,b:t||.75},r=this.hsb2rgb(i.h,i.s,i.b);return i.h+=.075,i.h>1&&(i.h=0,i.s-=.2,i.s<=0&&(this.getColor.start={h:0,s:1,b:i.b})),r.hex},o.getColor.reset=function(){delete this.start},o.parsePathString=function(t){if(!t)return null;var i=Yt(t);if(i.arr)return zt(i.arr);var r={a:7,c:6,h:1,l:2,m:2,r:4,q:4,s:4,t:2,v:1,z:0},n=[];return o.is(t,mt)&&o.is(t[0],mt)&&(n=zt(t)),n.length||Y(t).replace(gt,function(a,p,m){var v=[],x=p.toLowerCase();if(m.replace(vt,function(E,L){L&&v.push(+L)}),x=="m"&&v.length>2&&(n.push([p][R](v.splice(0,2))),x="l",p=p=="m"?"l":"L"),x=="r")n.push([p][R](v));else for(;v.length>=r[x]&&(n.push([p][R](v.splice(0,r[x]))),r[x]););}),n.toString=o._path2string,i.arr=zt(n),n},o.parseTransformString=Rt(function(t){if(!t)return null;var i=[];return o.is(t,mt)&&o.is(t[0],mt)&&(i=zt(t)),i.length||Y(t).replace(yt,function(r,n,a){var p=[];at.call(n),a.replace(vt,function(m,v){v&&p.push(+v)}),i.push([n][R](p))}),i.toString=o._path2string,i},this,function(t){if(!t)return t;for(var i=[],r=0;r<t.length;r++){for(var n=[],a=0;a<t[r].length;a++)n.push(t[r][a]);i.push(n)}return i});var Yt=function(t){var i=Yt.ps=Yt.ps||{};return i[t]?i[t].sleep=100:i[t]={sleep:100},setTimeout(function(){for(var r in i)i[Q](r)&&r!=t&&(i[r].sleep--,!i[r].sleep&&delete i[r])}),i[t]};function ue(t,i,r,n,a){return t*(t*(-3*i+9*r-9*n+3*a)+6*i-12*r+6*n)-3*i+3*r}function Vt(t,i,r,n,a,p,m,v,x){x==null&&(x=1);for(var E=(x=x>1?1:x<0?0:x)/2,L=[-.1252,.1252,-.3678,.3678,-.5873,.5873,-.7699,.7699,-.9041,.9041,-.9816,.9816],H=[.2491,.2491,.2335,.2335,.2032,.2032,.1601,.1601,.1069,.1069,.0472,.0472],M=0,D=0;D<12;D++){var A=E*L[D]+E,F=ue(A,t,r,a,m),P=ue(A,i,n,p,v),I=F*F+P*P;M+=H[D]*K.sqrt(I)}return E*M}function Ee(t,i,r,n,a,p,m,v){if(!(st(t,r)<it(a,m)||it(t,r)>st(a,m)||st(i,n)<it(p,v)||it(i,n)>st(p,v))){var x=(t-r)*(p-v)-(i-n)*(a-m);if(x){var E=((t*n-i*r)*(a-m)-(t-r)*(a*v-p*m))/x,L=((t*n-i*r)*(p-v)-(i-n)*(a*v-p*m))/x,H=+E.toFixed(2),M=+L.toFixed(2);if(!(H<+it(t,r).toFixed(2)||H>+st(t,r).toFixed(2)||H<+it(a,m).toFixed(2)||H>+st(a,m).toFixed(2)||M<+it(i,n).toFixed(2)||M>+st(i,n).toFixed(2)||M<+it(p,v).toFixed(2)||M>+st(p,v).toFixed(2)))return{x:E,y:L}}}}function pe(t,i,r){var n=o.bezierBBox(t),a=o.bezierBBox(i);if(!o.isBBoxIntersect(n,a))return r?0:[];for(var p=Vt.apply(0,t),m=Vt.apply(0,i),v=st(~~(p/5),1),x=st(~~(m/5),1),E=[],L=[],H={},M=r?0:[],D=0;D<v+1;D++){var A=o.findDotsAtSegment.apply(o,t.concat(D/v));E.push({x:A.x,y:A.y,t:D/v})}for(D=0;D<x+1;D++)A=o.findDotsAtSegment.apply(o,i.concat(D/x)),L.push({x:A.x,y:A.y,t:D/x});for(D=0;D<v;D++)for(var F=0;F<x;F++){var P=E[D],I=E[D+1],Z=L[F],O=L[F+1],X=Et(I.x-P.x)<.001?"y":"x",$=Et(O.x-Z.x)<.001?"y":"x",dt=Ee(P.x,P.y,I.x,I.y,Z.x,Z.y,O.x,O.y);if(dt){if(H[dt.x.toFixed(4)]==dt.y.toFixed(4))continue;H[dt.x.toFixed(4)]=dt.y.toFixed(4);var ot=P.t+Et((dt[X]-P[X])/(I[X]-P[X]))*(I.t-P.t),ut=Z.t+Et((dt[$]-Z[$])/(O[$]-Z[$]))*(O.t-Z.t);ot>=0&&ot<=1.001&&ut>=0&&ut<=1.001&&(r?M++:M.push({x:dt.x,y:dt.y,t1:it(ot,1),t2:it(ut,1)}))}}return M}function _e(t,i,r){t=o._path2curve(t),i=o._path2curve(i);for(var n,a,p,m,v,x,E,L,H,M,D=r?0:[],A=0,F=t.length;A<F;A++){var P=t[A];if(P[0]=="M")n=v=P[1],a=x=P[2];else{P[0]=="C"?(H=[n,a].concat(P.slice(1)),n=H[6],a=H[7]):(H=[n,a,n,a,v,x,v,x],n=v,a=x);for(var I=0,Z=i.length;I<Z;I++){var O=i[I];if(O[0]=="M")p=E=O[1],m=L=O[2];else{O[0]=="C"?(M=[p,m].concat(O.slice(1)),p=M[6],m=M[7]):(M=[p,m,p,m,E,L,E,L],p=E,m=L);var X=pe(H,M,r);if(r)D+=X;else{for(var $=0,dt=X.length;$<dt;$++)X[$].segment1=A,X[$].segment2=I,X[$].bez1=H,X[$].bez2=M;D=D.concat(X)}}}}}return D}o.findDotsAtSegment=function(t,i,r,n,a,p,m,v,x){var E=1-x,L=Dt(E,3),H=Dt(E,2),M=x*x,D=M*x,A=L*t+3*H*x*r+3*E*x*x*a+D*m,F=L*i+3*H*x*n+3*E*x*x*p+D*v,P=t+2*x*(r-t)+M*(a-2*r+t),I=i+2*x*(n-i)+M*(p-2*n+i),Z=r+2*x*(a-r)+M*(m-2*a+r),O=n+2*x*(p-n)+M*(v-2*p+n),X=E*t+x*r,$=E*i+x*n,dt=E*a+x*m,ot=E*p+x*v,ut=90-180*K.atan2(P-Z,I-O)/Lt;return(P>Z||I<O)&&(ut+=180),{x:A,y:F,m:{x:P,y:I},n:{x:Z,y:O},start:{x:X,y:$},end:{x:dt,y:ot},alpha:ut}},o.bezierBBox=function(t,i,r,n,a,p,m,v){o.is(t,"array")||(t=[t,i,r,n,a,p,m,v]);var x=Me.apply(null,t);return{x:x.min.x,y:x.min.y,x2:x.max.x,y2:x.max.y,width:x.max.x-x.min.x,height:x.max.y-x.min.y}},o.isPointInsideBBox=function(t,i,r){return i>=t.x&&i<=t.x2&&r>=t.y&&r<=t.y2},o.isBBoxIntersect=function(t,i){var r=o.isPointInsideBBox;return r(i,t.x,t.y)||r(i,t.x2,t.y)||r(i,t.x,t.y2)||r(i,t.x2,t.y2)||r(t,i.x,i.y)||r(t,i.x2,i.y)||r(t,i.x,i.y2)||r(t,i.x2,i.y2)||(t.x<i.x2&&t.x>i.x||i.x<t.x2&&i.x>t.x)&&(t.y<i.y2&&t.y>i.y||i.y<t.y2&&i.y>t.y)},o.pathIntersection=function(t,i){return _e(t,i)},o.pathIntersectionNumber=function(t,i){return _e(t,i,1)},o.isPointInsidePath=function(t,i,r){var n=o.pathBBox(t);return o.isPointInsideBBox(n,i,r)&&_e(t,[["M",i,r],["H",n.x2+10]],1)%2==1},o._removedFactory=function(t){return function(){l("raphael.log",null,"Raphaël: you are calling to method “"+t+"” of removed object",t)}};var Qt=o.pathBBox=function(t){var i=Yt(t);if(i.bbox)return Pt(i.bbox);if(!t)return{x:0,y:0,width:0,height:0,x2:0,y2:0};for(var r,n=0,a=0,p=[],m=[],v=0,x=(t=ke(t)).length;v<x;v++)if((r=t[v])[0]=="M")n=r[1],a=r[2],p.push(n),m.push(a);else{var E=Me(n,a,r[1],r[2],r[3],r[4],r[5],r[6]);p=p[R](E.min.x,E.max.x),m=m[R](E.min.y,E.max.y),n=r[5],a=r[6]}var L=it[U](0,p),H=it[U](0,m),M=st[U](0,p),D=st[U](0,m),A=M-L,F=D-H,P={x:L,y:H,x2:M,y2:D,width:A,height:F,cx:L+A/2,cy:H+F/2};return i.bbox=Pt(P),P},zt=function(t){var i=Pt(t);return i.toString=o._path2string,i},si=o._pathToRelative=function(t){var i=Yt(t);if(i.rel)return zt(i.rel);o.is(t,mt)&&o.is(t&&t[0],mt)||(t=o.parsePathString(t));var r=[],n=0,a=0,p=0,m=0,v=0;t[0][0]=="M"&&(p=n=t[0][1],m=a=t[0][2],v++,r.push(["M",n,a]));for(var x=v,E=t.length;x<E;x++){var L=r[x]=[],H=t[x];if(H[0]!=at.call(H[0]))switch(L[0]=at.call(H[0]),L[0]){case"a":L[1]=H[1],L[2]=H[2],L[3]=H[3],L[4]=H[4],L[5]=H[5],L[6]=+(H[6]-n).toFixed(3),L[7]=+(H[7]-a).toFixed(3);break;case"v":L[1]=+(H[1]-a).toFixed(3);break;case"m":p=H[1],m=H[2];default:for(var M=1,D=H.length;M<D;M++)L[M]=+(H[M]-(M%2?n:a)).toFixed(3)}else{L=r[x]=[],H[0]=="m"&&(p=H[1]+n,m=H[2]+a);for(var A=0,F=H.length;A<F;A++)r[x][A]=H[A]}var P=r[x].length;switch(r[x][0]){case"z":n=p,a=m;break;case"h":n+=+r[x][P-1];break;case"v":a+=+r[x][P-1];break;default:n+=+r[x][P-2],a+=+r[x][P-1]}}return r.toString=o._path2string,i.rel=zt(r),r},fe=o._pathToAbsolute=function(t){var i=Yt(t);if(i.abs)return zt(i.abs);if(o.is(t,mt)&&o.is(t&&t[0],mt)||(t=o.parsePathString(t)),!t||!t.length)return[["M",0,0]];var r=[],n=0,a=0,p=0,m=0,v=0;t[0][0]=="M"&&(p=n=+t[0][1],m=a=+t[0][2],v++,r[0]=["M",n,a]);for(var x,E,L=t.length==3&&t[0][0]=="M"&&t[1][0].toUpperCase()=="R"&&t[2][0].toUpperCase()=="Z",H=v,M=t.length;H<M;H++){if(r.push(x=[]),(E=t[H])[0]!=C.call(E[0]))switch(x[0]=C.call(E[0]),x[0]){case"A":x[1]=E[1],x[2]=E[2],x[3]=E[3],x[4]=E[4],x[5]=E[5],x[6]=+(E[6]+n),x[7]=+(E[7]+a);break;case"V":x[1]=+E[1]+a;break;case"H":x[1]=+E[1]+n;break;case"R":for(var D=[n,a][R](E.slice(1)),A=2,F=D.length;A<F;A++)D[A]=+D[A]+n,D[++A]=+D[A]+a;r.pop(),r=r[R](de(D,L));break;case"M":p=+E[1]+n,m=+E[2]+a;default:for(A=1,F=E.length;A<F;A++)x[A]=+E[A]+(A%2?n:a)}else if(E[0]=="R")D=[n,a][R](E.slice(1)),r.pop(),r=r[R](de(D,L)),x=["R"][R](E.slice(-2));else for(var P=0,I=E.length;P<I;P++)x[P]=E[P];switch(x[0]){case"Z":n=p,a=m;break;case"H":n=x[1];break;case"V":a=x[1];break;case"M":p=x[x.length-2],m=x[x.length-1];default:n=x[x.length-2],a=x[x.length-1]}}return r.toString=o._path2string,i.abs=zt(r),r},ge=function(t,i,r,n){return[t,i,r,n,r,n]},Jt=function(t,i,r,n,a,p){return[1/3*t+2/3*r,1/3*i+2/3*n,1/3*a+2/3*r,1/3*p+2/3*n,a,p]},Ie=function(t,i,r,n,a,p,m,v,x,E){var L,H=120*Lt/180,M=Lt/180*(+a||0),D=[],A=Rt(function(Si,Ei,ze){return{x:Si*K.cos(ze)-Ei*K.sin(ze),y:Si*K.sin(ze)+Ei*K.cos(ze)}});if(E)ot=E[0],ut=E[1],$=E[2],dt=E[3];else{t=(L=A(t,i,-M)).x,i=L.y,v=(L=A(v,x,-M)).x,x=L.y;var F=(t-v)/2,P=(i-x)/2,I=F*F/(r*r)+P*P/(n*n);I>1&&(r*=I=K.sqrt(I),n*=I);var Z=r*r,O=n*n,X=(p==m?-1:1)*K.sqrt(Et((Z*O-Z*P*P-O*F*F)/(Z*P*P+O*F*F))),$=X*r*P/n+(t+v)/2,dt=X*-n*F/r+(i+x)/2,ot=K.asin(((i-dt)/n).toFixed(9)),ut=K.asin(((x-dt)/n).toFixed(9));(ot=t<$?Lt-ot:ot)<0&&(ot=2*Lt+ot),(ut=v<$?Lt-ut:ut)<0&&(ut=2*Lt+ut),m&&ot>ut&&(ot-=2*Lt),!m&&ut>ot&&(ut-=2*Lt)}var me=ut-ot;if(Et(me)>H){var Be=ut,Ht=v,Xt=x;ut=ot+H*(m&&ut>ot?1:-1),v=$+r*K.cos(ut),x=dt+n*K.sin(ut),D=Ie(v,x,r,n,a,0,m,Ht,Xt,[ut,Be,$,dt])}me=ut-ot;var ye=K.cos(ot),xe=K.sin(ot),Ae=K.cos(ut),qt=K.sin(ut),oe=K.tan(me/4),Pe=4/3*r*oe,mi=4/3*n*oe,yi=[t,i],be=[t+Pe*xe,i-mi*ye],xi=[v+Pe*qt,x-mi*Ae],bi=[v,x];if(be[0]=2*yi[0]-be[0],be[1]=2*yi[1]-be[1],E)return[be,xi,bi][R](D);for(var wi=[],ee=0,tr=(D=[be,xi,bi][R](D).join()[tt](",")).length;ee<tr;ee++)wi[ee]=ee%2?A(D[ee-1],D[ee],M).y:A(D[ee],D[ee+1],M).x;return wi},re=function(t,i,r,n,a,p,m,v,x){var E=1-x;return{x:Dt(E,3)*t+3*Dt(E,2)*x*r+3*E*x*x*a+Dt(x,3)*m,y:Dt(E,3)*i+3*Dt(E,2)*x*n+3*E*x*x*p+Dt(x,3)*v}},Me=Rt(function(t,i,r,n,a,p,m,v){var x,E=a-2*r+t-(m-2*a+r),L=2*(r-t)-2*(a-r),H=t-r,M=(-L+K.sqrt(L*L-4*E*H))/2/E,D=(-L-K.sqrt(L*L-4*E*H))/2/E,A=[i,v],F=[t,m];return Et(M)>"1e12"&&(M=.5),Et(D)>"1e12"&&(D=.5),M>0&&M<1&&(x=re(t,i,r,n,a,p,m,v,M),F.push(x.x),A.push(x.y)),D>0&&D<1&&(x=re(t,i,r,n,a,p,m,v,D),F.push(x.x),A.push(x.y)),E=p-2*n+i-(v-2*p+n),H=i-n,M=(-(L=2*(n-i)-2*(p-n))+K.sqrt(L*L-4*E*H))/2/E,D=(-L-K.sqrt(L*L-4*E*H))/2/E,Et(M)>"1e12"&&(M=.5),Et(D)>"1e12"&&(D=.5),M>0&&M<1&&(x=re(t,i,r,n,a,p,m,v,M),F.push(x.x),A.push(x.y)),D>0&&D<1&&(x=re(t,i,r,n,a,p,m,v,D),F.push(x.x),A.push(x.y)),{min:{x:it[U](0,F),y:it[U](0,A)},max:{x:st[U](0,F),y:st[U](0,A)}}}),ke=o._path2curve=Rt(function(t,i){var r=!i&&Yt(t);if(!i&&r.curve)return zt(r.curve);for(var n=fe(t),a=i&&fe(i),p={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null},m={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null},v=function(X,$,dt){var ot,ut;if(!X)return["C",$.x,$.y,$.x,$.y,$.x,$.y];switch(!(X[0]in{T:1,Q:1})&&($.qx=$.qy=null),X[0]){case"M":$.X=X[1],$.Y=X[2];break;case"A":X=["C"][R](Ie[U](0,[$.x,$.y][R](X.slice(1))));break;case"S":dt=="C"||dt=="S"?(ot=2*$.x-$.bx,ut=2*$.y-$.by):(ot=$.x,ut=$.y),X=["C",ot,ut][R](X.slice(1));break;case"T":dt=="Q"||dt=="T"?($.qx=2*$.x-$.qx,$.qy=2*$.y-$.qy):($.qx=$.x,$.qy=$.y),X=["C"][R](Jt($.x,$.y,$.qx,$.qy,X[1],X[2]));break;case"Q":$.qx=X[1],$.qy=X[2],X=["C"][R](Jt($.x,$.y,X[1],X[2],X[3],X[4]));break;case"L":X=["C"][R](ge($.x,$.y,X[1],X[2]));break;case"H":X=["C"][R](ge($.x,$.y,X[1],$.y));break;case"V":X=["C"][R](ge($.x,$.y,$.x,X[1]));break;case"Z":X=["C"][R](ge($.x,$.y,$.X,$.Y))}return X},x=function(X,$){if(X[$].length>7){X[$].shift();for(var dt=X[$];dt.length;)L[$]="A",a&&(H[$]="A"),X.splice($++,0,["C"][R](dt.splice(0,6)));X.splice($,1),F=st(n.length,a&&a.length||0)}},E=function(X,$,dt,ot,ut){X&&$&&X[ut][0]=="M"&&$[ut][0]!="M"&&($.splice(ut,0,["M",ot.x,ot.y]),dt.bx=0,dt.by=0,dt.x=X[ut][1],dt.y=X[ut][2],F=st(n.length,a&&a.length||0))},L=[],H=[],M="",D="",A=0,F=st(n.length,a&&a.length||0);A<F;A++){n[A]&&(M=n[A][0]),M!="C"&&(L[A]=M,A&&(D=L[A-1])),n[A]=v(n[A],p,D),L[A]!="A"&&M=="C"&&(L[A]="C"),x(n,A),a&&(a[A]&&(M=a[A][0]),M!="C"&&(H[A]=M,A&&(D=H[A-1])),a[A]=v(a[A],m,D),H[A]!="A"&&M=="C"&&(H[A]="C"),x(a,A)),E(n,a,p,m,A),E(a,n,m,p,A);var P=n[A],I=a&&a[A],Z=P.length,O=a&&I.length;p.x=P[Z-2],p.y=P[Z-1],p.bx=S(P[Z-4])||p.x,p.by=S(P[Z-3])||p.y,m.bx=a&&(S(I[O-4])||m.x),m.by=a&&(S(I[O-3])||m.y),m.x=a&&I[O-2],m.y=a&&I[O-1]}return a||(r.curve=zt(n)),a?[n,a]:n},null,zt),Re=(o._parseDots=Rt(function(t){for(var i=[],r=0,n=t.length;r<n;r++){var a={},p=t[r].match(/^([^:]*):?([\d\.]*)/);if(a.color=o.getRGB(p[1]),a.color.error)return null;a.opacity=a.color.opacity,a.color=a.color.hex,p[2]&&(a.offset=p[2]+"%"),i.push(a)}for(r=1,n=i.length-1;r<n;r++)if(!i[r].offset){for(var m=S(i[r-1].offset||0),v=0,x=r+1;x<n;x++)if(i[x].offset){v=i[x].offset;break}v||(v=100,x=n);for(var E=((v=S(v))-m)/(x-r+1);r<x;r++)m+=E,i[r].offset=m+"%"}return i}),o._tear=function(t,i){t==i.top&&(i.top=t.prev),t==i.bottom&&(i.bottom=t.next),t.next&&(t.next.prev=t.prev),t.prev&&(t.prev.next=t.next)}),Wi=(o._tofront=function(t,i){i.top!==t&&(Re(t,i),t.next=null,t.prev=i.top,i.top.next=t,i.top=t)},o._toback=function(t,i){i.bottom!==t&&(Re(t,i),t.next=i.bottom,t.prev=null,i.bottom.prev=t,i.bottom=t)},o._insertafter=function(t,i,r){Re(t,r),i==r.top&&(r.top=t),i.next&&(i.next.prev=t),t.next=i.next,t.prev=i,i.next=t},o._insertbefore=function(t,i,r){Re(t,r),i==r.bottom&&(r.bottom=t),i.prev&&(i.prev.next=t),t.prev=i.prev,i.prev=t,t.next=i},o.toMatrix=function(t,i){var r=Qt(t),n={_:{transform:rt},getBBox:function(){return r}};return ni(n,i),n.matrix}),ni=(o.transformPath=function(t,i){return Mt(t,Wi(t,i))},o._extractTransform=function(t,i){if(i==null)return t._.transform;i=Y(i).replace(/\.{3}|\u2026/g,t._.transform||rt);var r,n,a=o.parseTransformString(i),p=0,m=1,v=1,x=t._,E=new se;if(x.transform=a||[],a)for(var L=0,H=a.length;L<H;L++){var M,D,A,F,P,I=a[L],Z=I.length,O=Y(I[0]).toLowerCase(),X=I[0]!=O,$=X?E.invert():0;O=="t"&&Z==3?X?(M=$.x(0,0),D=$.y(0,0),A=$.x(I[1],I[2]),F=$.y(I[1],I[2]),E.translate(A-M,F-D)):E.translate(I[1],I[2]):O=="r"?Z==2?(P=P||t.getBBox(1),E.rotate(I[1],P.x+P.width/2,P.y+P.height/2),p+=I[1]):Z==4&&(X?(A=$.x(I[2],I[3]),F=$.y(I[2],I[3]),E.rotate(I[1],A,F)):E.rotate(I[1],I[2],I[3]),p+=I[1]):O=="s"?Z==2||Z==3?(P=P||t.getBBox(1),E.scale(I[1],I[Z-1],P.x+P.width/2,P.y+P.height/2),m*=I[1],v*=I[Z-1]):Z==5&&(X?(A=$.x(I[3],I[4]),F=$.y(I[3],I[4]),E.scale(I[1],I[2],A,F)):E.scale(I[1],I[2],I[3],I[4]),m*=I[1],v*=I[2]):O=="m"&&Z==7&&E.add(I[1],I[2],I[3],I[4],I[5],I[6]),x.dirtyT=1,t.matrix=E}t.matrix=E,x.sx=m,x.sy=v,x.deg=p,x.dx=r=E.e,x.dy=n=E.f,m==1&&v==1&&!p&&x.bbox?(x.bbox.x+=+r,x.bbox.y+=+n):x.dirtyT=1}),oi=function(t){var i=t[0];switch(i.toLowerCase()){case"t":return[i,0,0];case"m":return[i,1,0,0,1,0,0];case"r":return t.length==4?[i,0,t[2],t[3]]:[i,0];case"s":return t.length==5?[i,1,1,t[3],t[4]]:t.length==3?[i,1,1]:[i,1]}},ji=o._equaliseTransform=function(t,i){i=Y(i).replace(/\.{3}|\u2026/g,t),t=o.parseTransformString(t)||[],i=o.parseTransformString(i)||[];for(var r,n,a,p,m=st(t.length,i.length),v=[],x=[],E=0;E<m;E++){if(a=t[E]||oi(i[E]),p=i[E]||oi(a),a[0]!=p[0]||a[0].toLowerCase()=="r"&&(a[2]!=p[2]||a[3]!=p[3])||a[0].toLowerCase()=="s"&&(a[3]!=p[3]||a[4]!=p[4]))return;for(v[E]=[],x[E]=[],r=0,n=st(a.length,p.length);r<n;r++)r in a&&(v[E][r]=a[r]),r in p&&(x[E][r]=p[r])}return{from:v,to:x}};function se(t,i,r,n,a,p){t!=null?(this.a=+t,this.b=+i,this.c=+r,this.d=+n,this.e=+a,this.f=+p):(this.a=1,this.b=0,this.c=0,this.d=1,this.e=0,this.f=0)}o._getContainer=function(t,i,r,n){var a;if((a=n!=null||o.is(t,"object")?t:q.doc.getElementById(t))!=null)return a.tagName?i==null?{container:a,width:a.style.pixelWidth||a.offsetWidth,height:a.style.pixelHeight||a.offsetHeight}:{container:a,width:i,height:r}:{container:1,x:t,y:i,width:r,height:n}},o.pathToRelative=si,o._engine={},o.path2curve=ke,o.matrix=function(t,i,r,n,a,p){return new se(t,i,r,n,a,p)},function(t){function i(n){return n[0]*n[0]+n[1]*n[1]}function r(n){var a=K.sqrt(i(n));n[0]&&(n[0]/=a),n[1]&&(n[1]/=a)}t.add=function(n,a,p,m,v,x){var E,L,H,M,D=[[],[],[]],A=[[this.a,this.c,this.e],[this.b,this.d,this.f],[0,0,1]],F=[[n,p,v],[a,m,x],[0,0,1]];for(n&&n instanceof se&&(F=[[n.a,n.c,n.e],[n.b,n.d,n.f],[0,0,1]]),E=0;E<3;E++)for(L=0;L<3;L++){for(M=0,H=0;H<3;H++)M+=A[E][H]*F[H][L];D[E][L]=M}this.a=D[0][0],this.b=D[1][0],this.c=D[0][1],this.d=D[1][1],this.e=D[0][2],this.f=D[1][2]},t.invert=function(){var n=this,a=n.a*n.d-n.b*n.c;return new se(n.d/a,-n.b/a,-n.c/a,n.a/a,(n.c*n.f-n.d*n.e)/a,(n.b*n.e-n.a*n.f)/a)},t.clone=function(){return new se(this.a,this.b,this.c,this.d,this.e,this.f)},t.translate=function(n,a){this.add(1,0,0,1,n,a)},t.scale=function(n,a,p,m){a==null&&(a=n),(p||m)&&this.add(1,0,0,1,p,m),this.add(n,0,0,a,0,0),(p||m)&&this.add(1,0,0,1,-p,-m)},t.rotate=function(n,a,p){n=o.rad(n),a=a||0,p=p||0;var m=+K.cos(n).toFixed(9),v=+K.sin(n).toFixed(9);this.add(m,v,-v,m,a,p),this.add(1,0,0,1,-a,-p)},t.x=function(n,a){return n*this.a+a*this.c+this.e},t.y=function(n,a){return n*this.b+a*this.d+this.f},t.get=function(n){return+this[Y.fromCharCode(97+n)].toFixed(4)},t.toString=function(){return o.svg?"matrix("+[this.get(0),this.get(1),this.get(2),this.get(3),this.get(4),this.get(5)].join()+")":[this.get(0),this.get(2),this.get(1),this.get(3),0,0].join()},t.toFilter=function(){return"progid:DXImageTransform.Microsoft.Matrix(M11="+this.get(0)+", M12="+this.get(2)+", M21="+this.get(1)+", M22="+this.get(3)+", Dx="+this.get(4)+", Dy="+this.get(5)+", sizingmethod='auto expand')"},t.offset=function(){return[this.e.toFixed(4),this.f.toFixed(4)]},t.split=function(){var n={};n.dx=this.e,n.dy=this.f;var a=[[this.a,this.c],[this.b,this.d]];n.scalex=K.sqrt(i(a[0])),r(a[0]),n.shear=a[0][0]*a[1][0]+a[0][1]*a[1][1],a[1]=[a[1][0]-a[0][0]*n.shear,a[1][1]-a[0][1]*n.shear],n.scaley=K.sqrt(i(a[1])),r(a[1]),n.shear/=n.scaley;var p=-a[0][1],m=a[1][1];return m<0?(n.rotate=o.deg(K.acos(m)),p<0&&(n.rotate=360-n.rotate)):n.rotate=o.deg(K.asin(p)),n.isSimple=!(+n.shear.toFixed(9)||n.scalex.toFixed(9)!=n.scaley.toFixed(9)&&n.rotate),n.isSuperSimple=!+n.shear.toFixed(9)&&n.scalex.toFixed(9)==n.scaley.toFixed(9)&&!n.rotate,n.noRotation=!+n.shear.toFixed(9)&&!n.rotate,n},t.toTransformString=function(n){var a=n||this[tt]();return a.isSimple?(a.scalex=+a.scalex.toFixed(4),a.scaley=+a.scaley.toFixed(4),a.rotate=+a.rotate.toFixed(4),(a.dx||a.dy?"t"+[a.dx,a.dy]:rt)+(a.scalex!=1||a.scaley!=1?"s"+[a.scalex,a.scaley,0,0]:rt)+(a.rotate?"r"+[a.rotate,0,0]:rt)):"m"+[this.get(0),this.get(1),this.get(2),this.get(3),this.get(4),this.get(5)]}}(se.prototype);for(var qi=function(){this.returnValue=!1},Ui=function(){return this.originalEvent.preventDefault()},Ki=function(){this.cancelBubble=!0},Zi=function(){return this.originalEvent.stopPropagation()},ai=function(t){var i=q.doc.documentElement.scrollTop||q.doc.body.scrollTop,r=q.doc.documentElement.scrollLeft||q.doc.body.scrollLeft;return{x:t.clientX+r,y:t.clientY+i}},Qi=q.doc.addEventListener?function(t,i,r,n){var a=function(m){var v=ai(m);return r.call(n,m,v.x,v.y)};if(t.addEventListener(i,a,!1),ct&&wt[i]){var p=function(m){for(var v=ai(m),x=m,E=0,L=m.targetTouches&&m.targetTouches.length;E<L;E++)if(m.targetTouches[E].target==t){(m=m.targetTouches[E]).originalEvent=x,m.preventDefault=Ui,m.stopPropagation=Zi;break}return r.call(n,m,v.x,v.y)};t.addEventListener(wt[i],p,!1)}return function(){return t.removeEventListener(i,a,!1),ct&&wt[i]&&t.removeEventListener(wt[i],p,!1),!0}}:q.doc.attachEvent?function(t,i,r,n){var a=function(p){p=p||q.win.event;var m=q.doc.documentElement.scrollTop||q.doc.body.scrollTop,v=q.doc.documentElement.scrollLeft||q.doc.body.scrollLeft,x=p.clientX+v,E=p.clientY+m;return p.preventDefault=p.preventDefault||qi,p.stopPropagation=p.stopPropagation||Ki,r.call(n,p,x,E)};return t.attachEvent("on"+i,a),function(){return t.detachEvent("on"+i,a),!0}}:void 0,te=[],Ge=function(t){for(var i,r=t.clientX,n=t.clientY,a=q.doc.documentElement.scrollTop||q.doc.body.scrollTop,p=q.doc.documentElement.scrollLeft||q.doc.body.scrollLeft,m=te.length;m--;){if(i=te[m],ct&&t.touches){for(var v,x=t.touches.length;x--;)if((v=t.touches[x]).identifier==i.el._drag.id){r=v.clientX,n=v.clientY,(t.originalEvent?t.originalEvent:t).preventDefault();break}}else t.preventDefault();var E,L=i.el.node,H=L.nextSibling,M=L.parentNode,D=L.style.display;q.win.opera&&M.removeChild(L),L.style.display="none",E=i.el.paper.getElementByPoint(r,n),L.style.display=D,q.win.opera&&(H?M.insertBefore(L,H):M.appendChild(L)),E&&l("raphael.drag.over."+i.el.id,i.el,E),r+=p,n+=a,l("raphael.drag.move."+i.el.id,i.move_scope||i.el,r-i.el._drag.x,n-i.el._drag.y,r,n,t)}},Ve=function(t){o.unmousemove(Ge).unmouseup(Ve);for(var i,r=te.length;r--;)(i=te[r]).el._drag={},l("raphael.drag.end."+i.el.id,i.end_scope||i.start_scope||i.move_scope||i.el,t);te=[]},_t=o.el={},hi=nt.length;hi--;)(function(t){o[t]=_t[t]=function(i,r){return o.is(i,"function")&&(this.events=this.events||[],this.events.push({name:t,f:i,unbind:Qi(this.shape||this.node||q.doc,t,i,r||this)})),this},o["un"+t]=_t["un"+t]=function(i){for(var r=this.events||[],n=r.length;n--;)r[n].name!=t||!o.is(i,"undefined")&&r[n].f!=i||(r[n].unbind(),r.splice(n,1),!r.length&&delete this.events);return this}})(nt[hi]);_t.data=function(t,i){var r=kt[this.id]=kt[this.id]||{};if(arguments.length==0)return r;if(arguments.length==1){if(o.is(t,"object")){for(var n in t)t[Q](n)&&this.data(n,t[n]);return this}return l("raphael.data.get."+this.id,this,r[t],t),r[t]}return r[t]=i,l("raphael.data.set."+this.id,this,i,t),this},_t.removeData=function(t){return t==null?delete kt[this.id]:kt[this.id]&&delete kt[this.id][t],this},_t.getData=function(){return Pt(kt[this.id]||{})},_t.hover=function(t,i,r,n){return this.mouseover(t,r).mouseout(i,n||r)},_t.unhover=function(t,i){return this.unmouseover(t).unmouseout(i)};var ve=[];_t.drag=function(t,i,r,n,a,p){function m(v){(v.originalEvent||v).preventDefault();var x=v.clientX,E=v.clientY,L=q.doc.documentElement.scrollTop||q.doc.body.scrollTop,H=q.doc.documentElement.scrollLeft||q.doc.body.scrollLeft;if(this._drag.id=v.identifier,ct&&v.touches){for(var M,D=v.touches.length;D--;)if(M=v.touches[D],this._drag.id=M.identifier,M.identifier==this._drag.id){x=M.clientX,E=M.clientY;break}}this._drag.x=x+H,this._drag.y=E+L,!te.length&&o.mousemove(Ge).mouseup(Ve),te.push({el:this,move_scope:n,start_scope:a,end_scope:p}),i&&l.on("raphael.drag.start."+this.id,i),t&&l.on("raphael.drag.move."+this.id,t),r&&l.on("raphael.drag.end."+this.id,r),l("raphael.drag.start."+this.id,a||n||this,this._drag.x,this._drag.y,v)}return this._drag={},ve.push({el:this,start:m}),this.mousedown(m),this},_t.onDragOver=function(t){t?l.on("raphael.drag.over."+this.id,t):l.unbind("raphael.drag.over."+this.id)},_t.undrag=function(){for(var t=ve.length;t--;)ve[t].el==this&&(this.unmousedown(ve[t].start),ve.splice(t,1),l.unbind("raphael.drag.*."+this.id));!ve.length&&o.unmousemove(Ge).unmouseup(Ve),te=[]},N.circle=function(t,i,r){var n=o._engine.circle(this,t||0,i||0,r||0);return this.__set__&&this.__set__.push(n),n},N.rect=function(t,i,r,n,a){var p=o._engine.rect(this,t||0,i||0,r||0,n||0,a||0);return this.__set__&&this.__set__.push(p),p},N.ellipse=function(t,i,r,n){var a=o._engine.ellipse(this,t||0,i||0,r||0,n||0);return this.__set__&&this.__set__.push(a),a},N.path=function(t){t&&!o.is(t,"string")&&!o.is(t[0],mt)&&(t+=rt);var i=o._engine.path(o.format[U](o,arguments),this);return this.__set__&&this.__set__.push(i),i},N.image=function(t,i,r,n,a){var p=o._engine.image(this,t||"about:blank",i||0,r||0,n||0,a||0);return this.__set__&&this.__set__.push(p),p},N.text=function(t,i,r){var n=o._engine.text(this,t||0,i||0,Y(r));return this.__set__&&this.__set__.push(n),n},N.set=function(t){!o.is(t,"array")&&(t=Array.prototype.splice.call(arguments,0,arguments.length));var i=new Ne(t);return this.__set__&&this.__set__.push(i),i.paper=this,i.type="set",i},N.setStart=function(t){this.__set__=t||this.set()},N.setFinish=function(t){var i=this.__set__;return delete this.__set__,i},N.getSize=function(){var t=this.canvas.parentNode;return{width:t.offsetWidth,height:t.offsetHeight}},N.setSize=function(t,i){return o._engine.setSize.call(this,t,i)},N.setViewBox=function(t,i,r,n,a){return o._engine.setViewBox.call(this,t,i,r,n,a)},N.top=N.bottom=null,N.raphael=o;function li(){return this.x+pt+this.y+pt+this.width+" × "+this.height}N.getElementByPoint=function(t,i){var r,n,a,p,m,v,x,E=this.canvas,L=q.doc.elementFromPoint(t,i);if(q.win.opera&&L.tagName=="svg"){var H=(n=(r=E).getBoundingClientRect(),a=r.ownerDocument,p=a.body,m=a.documentElement,v=m.clientTop||p.clientTop||0,x=m.clientLeft||p.clientLeft||0,{y:n.top+(q.win.pageYOffset||m.scrollTop||p.scrollTop)-v,x:n.left+(q.win.pageXOffset||m.scrollLeft||p.scrollLeft)-x}),M=E.createSVGRect();M.x=t-H.x,M.y=i-H.y,M.width=M.height=1;var D=E.getIntersectionList(M,null);D.length&&(L=D[D.length-1])}if(!L)return null;for(;L.parentNode&&L!=E.parentNode&&!L.raphael;)L=L.parentNode;return L==this.canvas.parentNode&&(L=E),L=L&&L.raphael?this.getById(L.raphaelid):null},N.getElementsByBBox=function(t){var i=this.set();return this.forEach(function(r){o.isBBoxIntersect(r.getBBox(),t)&&i.push(r)}),i},N.getById=function(t){for(var i=this.bottom;i;){if(i.id==t)return i;i=i.next}return null},N.forEach=function(t,i){for(var r=this.bottom;r;){if(t.call(i,r)===!1)return this;r=r.next}return this},N.getElementsByPoint=function(t,i){var r=this.set();return this.forEach(function(n){n.isPointInside(t,i)&&r.push(n)}),r},_t.isPointInside=function(t,i){var r=this.realPath=Tt[this.type](this);return this.attr("transform")&&this.attr("transform").length&&(r=o.transformPath(r,this.attr("transform"))),o.isPointInsidePath(r,t,i)},_t.getBBox=function(t){if(this.removed)return{};var i=this._;return t?(!i.dirty&&i.bboxwt||(this.realPath=Tt[this.type](this),i.bboxwt=Qt(this.realPath),i.bboxwt.toString=li,i.dirty=0),i.bboxwt):((i.dirty||i.dirtyT||!i.bbox)&&(!i.dirty&&this.realPath||(i.bboxwt=0,this.realPath=Tt[this.type](this)),i.bbox=Qt(Mt(this.realPath,this.matrix)),i.bbox.toString=li,i.dirty=i.dirtyT=0),i.bbox)},_t.clone=function(){if(this.removed)return null;var t=this.paper[this.type]().attr(this.attr());return this.__set__&&this.__set__.push(t),t},_t.glow=function(t){if(this.type=="text")return null;var i={width:((t=t||{}).width||10)+(+this.attr("stroke-width")||1),fill:t.fill||!1,opacity:t.opacity==null?.5:t.opacity,offsetx:t.offsetx||0,offsety:t.offsety||0,color:t.color||"#000"},r=i.width/2,n=this.paper,a=n.set(),p=this.realPath||Tt[this.type](this);p=this.matrix?Mt(p,this.matrix):p;for(var m=1;m<r+1;m++)a.push(n.path(p).attr({stroke:i.color,fill:i.fill?i.color:"none","stroke-linejoin":"round","stroke-linecap":"round","stroke-width":+(i.width/r*m).toFixed(3),opacity:+(i.opacity/r).toFixed(3)}));return a.insertBefore(this).translate(i.offsetx,i.offsety)};var Xe=function(t,i,r,n,a,p,m,v,x){return x==null?Vt(t,i,r,n,a,p,m,v):o.findDotsAtSegment(t,i,r,n,a,p,m,v,function(E,L,H,M,D,A,F,P,I){if(!(I<0||Vt(E,L,H,M,D,A,F,P)<I)){var Z,O=.5,X=1-O;for(Z=Vt(E,L,H,M,D,A,F,P,X);Et(Z-I)>.01;)Z=Vt(E,L,H,M,D,A,F,P,X+=(Z<I?1:-1)*(O/=2));return X}}(t,i,r,n,a,p,m,v,x))},We=function(t,i){return function(r,n,a){for(var p,m,v,x,E,L="",H={},M=0,D=0,A=(r=ke(r)).length;D<A;D++){if((v=r[D])[0]=="M")p=+v[1],m=+v[2];else{if(M+(x=Xe(p,m,v[1],v[2],v[3],v[4],v[5],v[6]))>n){if(i&&!H.start){if(L+=["C"+(E=Xe(p,m,v[1],v[2],v[3],v[4],v[5],v[6],n-M)).start.x,E.start.y,E.m.x,E.m.y,E.x,E.y],a)return L;H.start=L,L=["M"+E.x,E.y+"C"+E.n.x,E.n.y,E.end.x,E.end.y,v[5],v[6]].join(),M+=x,p=+v[5],m=+v[6];continue}if(!t&&!i)return{x:(E=Xe(p,m,v[1],v[2],v[3],v[4],v[5],v[6],n-M)).x,y:E.y,alpha:E.alpha}}M+=x,p=+v[5],m=+v[6]}L+=v.shift()+v}return H.end=L,(E=t?M:i?H:o.findDotsAtSegment(p,m,v[0],v[1],v[2],v[3],v[4],v[5],1)).alpha&&(E={x:E.x,y:E.y,alpha:E.alpha}),E}},ci=We(1),di=We(),je=We(0,1);o.getTotalLength=ci,o.getPointAtLength=di,o.getSubpath=function(t,i,r){if(this.getTotalLength(t)-r<1e-6)return je(t,i).end;var n=je(t,r,1);return i?je(n,i).end:n},_t.getTotalLength=function(){var t=this.getPath();if(t)return this.node.getTotalLength?this.node.getTotalLength():ci(t)},_t.getPointAtLength=function(t){var i=this.getPath();if(i)return di(i,t)},_t.getPath=function(){var t,i=o._getPath[this.type];if(this.type!="text"&&this.type!="set")return i&&(t=i(this)),t},_t.getSubpath=function(t,i){var r=this.getPath();if(r)return o.getSubpath(r,t,i)};var Ot=o.easing_formulas={linear:function(t){return t},"<":function(t){return Dt(t,1.7)},">":function(t){return Dt(t,.48)},"<>":function(t){var i=.48-t/1.04,r=K.sqrt(.1734+i*i),n=r-i,a=-r-i,p=Dt(Et(n),1/3)*(n<0?-1:1)+Dt(Et(a),1/3)*(a<0?-1:1)+.5;return 3*(1-p)*p*p+p*p*p},backIn:function(t){var i=1.70158;return t*t*((i+1)*t-i)},backOut:function(t){var i=1.70158;return(t-=1)*t*((i+1)*t+i)+1},elastic:function(t){return t==!!t?t:Dt(2,-10*t)*K.sin(2*Lt*(t-.075)/.3)+1},bounce:function(t){var i=7.5625,r=2.75;return t<1/r?i*t*t:t<2/r?i*(t-=1.5/r)*t+.75:t<2.5/r?i*(t-=2.25/r)*t+.9375:i*(t-=2.625/r)*t+.984375}};Ot.easeIn=Ot["ease-in"]=Ot["<"],Ot.easeOut=Ot["ease-out"]=Ot[">"],Ot.easeInOut=Ot["ease-in-out"]=Ot["<>"],Ot["back-in"]=Ot.backIn,Ot["back-out"]=Ot.backOut;var xt=[],ui=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(t){setTimeout(t,16)},qe=function(){for(var t=+new Date,i=0;i<xt.length;i++){var r=xt[i];if(!r.el.removed&&!r.paused){var n,a,p=t-r.start,m=r.ms,v=r.easing,x=r.from,E=r.diff,L=r.to,H=(r.t,r.el),M={},D={};if(r.initstatus?(p=(r.initstatus*r.anim.top-r.prev)/(r.percent-r.prev)*m,r.status=r.initstatus,delete r.initstatus,r.stop&&xt.splice(i--,1)):r.status=(r.prev+(r.percent-r.prev)*(p/m))/r.anim.top,!(p<0))if(p<m){var A=v(p/m);for(var F in x)if(x[Q](F)){switch(B[F]){case ft:n=+x[F]+A*m*E[F];break;case"colour":n="rgb("+[Ue(y(x[F].r+A*m*E[F].r)),Ue(y(x[F].g+A*m*E[F].g)),Ue(y(x[F].b+A*m*E[F].b))].join(",")+")";break;case"path":n=[];for(var P=0,I=x[F].length;P<I;P++){n[P]=[x[F][P][0]];for(var Z=1,O=x[F][P].length;Z<O;Z++)n[P][Z]=+x[F][P][Z]+A*m*E[F][P][Z];n[P]=n[P].join(pt)}n=n.join(pt);break;case"transform":if(E[F].real)for(n=[],P=0,I=x[F].length;P<I;P++)for(n[P]=[x[F][P][0]],Z=1,O=x[F][P].length;Z<O;Z++)n[P][Z]=x[F][P][Z]+A*m*E[F][P][Z];else{var X=function(dt){return+x[F][dt]+A*m*E[F][dt]};n=[["m",X(0),X(1),X(2),X(3),X(4),X(5)]]}break;case"csv":if(F=="clip-rect")for(n=[],P=4;P--;)n[P]=+x[F][P]+A*m*E[F][P];break;default:var $=[][R](x[F]);for(n=[],P=H.paper.customAttributes[F].length;P--;)n[P]=+$[P]+A*m*E[F][P]}M[F]=n}H.attr(M),function(dt,ot,ut){setTimeout(function(){l("raphael.anim.frame."+dt,ot,ut)})}(H.id,H,r.anim)}else{if(function(dt,ot,ut){setTimeout(function(){l("raphael.anim.frame."+ot.id,ot,ut),l("raphael.anim.finish."+ot.id,ot,ut),o.is(dt,"function")&&dt.call(ot)})}(r.callback,H,r.anim),H.attr(L),xt.splice(i--,1),r.repeat>1&&!r.next){for(a in L)L[Q](a)&&(D[a]=r.totalOrigin[a]);r.el.attr(D),Ce(r.anim,r.el,r.anim.percents[0],null,r.totalOrigin,r.repeat-1)}r.next&&!r.stop&&Ce(r.anim,r.el,r.next,null,r.totalOrigin,r.repeat)}}}xt.length&&ui(qe)},Ue=function(t){return t>255?255:t<0?0:t};function Ji(t,i,r,n,a,p){var m=3*i,v=3*(n-i)-m,x=1-m-v,E=3*r,L=3*(a-r)-E,H=1-E-L;function M(D){return((x*D+v)*D+m)*D}return function(D,A){var F=function(P,I){var Z,O,X,$,dt,ot;for(X=P,ot=0;ot<8;ot++){if($=M(X)-P,Et($)<I)return X;if(Et(dt=(3*x*X+2*v)*X+m)<1e-6)break;X-=$/dt}if(O=1,(X=P)<(Z=0))return Z;if(X>O)return O;for(;Z<O;){if($=M(X),Et($-P)<I)return X;P>$?Z=X:O=X,X=(O-Z)/2+Z}return X}(D,A);return((H*F+L)*F+E)*F}(t,1/(200*p))}function jt(t,i){var r=[],n={};if(this.ms=i,this.times=1,t){for(var a in t)t[Q](a)&&(n[S(a)]=t[a],r.push(S(a)));r.sort(Nt)}this.anim=n,this.top=r[r.length-1],this.percents=r}function Ce(t,i,r,n,a,p){r=S(r);var m,v,x,E,L,H,M=t.ms,D={},A={},F={};if(n)for(I=0,Z=xt.length;I<Z;I++){var P=xt[I];if(P.el.id==i.id&&P.anim==t){P.percent!=r?(xt.splice(I,1),x=1):v=P,i.attr(P.totalOrigin);break}}else n=+A;for(var I=0,Z=t.percents.length;I<Z;I++){if(t.percents[I]==r||t.percents[I]>n*t.top){r=t.percents[I],L=t.percents[I-1]||0,M=M/t.top*(r-L),E=t.percents[I+1],m=t.anim[r];break}n&&i.attr(t.anim[t.percents[I]])}if(m){if(v)v.initstatus=n,v.start=new Date-v.ms*n;else{for(var O in m)if(m[Q](O)&&(B[Q](O)||i.paper.customAttributes[Q](O)))switch(D[O]=i.attr(O),D[O]==null&&(D[O]=z[O]),A[O]=m[O],B[O]){case ft:F[O]=(A[O]-D[O])/M;break;case"colour":D[O]=o.getRGB(D[O]);var X=o.getRGB(A[O]);F[O]={r:(X.r-D[O].r)/M,g:(X.g-D[O].g)/M,b:(X.b-D[O].b)/M};break;case"path":var $=ke(D[O],A[O]),dt=$[1];for(D[O]=$[0],F[O]=[],I=0,Z=D[O].length;I<Z;I++){F[O][I]=[0];for(var ot=1,ut=D[O][I].length;ot<ut;ot++)F[O][I][ot]=(dt[I][ot]-D[O][I][ot])/M}break;case"transform":var me=i._,Be=ji(me[O],A[O]);if(Be)for(D[O]=Be.from,A[O]=Be.to,F[O]=[],F[O].real=!0,I=0,Z=D[O].length;I<Z;I++)for(F[O][I]=[D[O][I][0]],ot=1,ut=D[O][I].length;ot<ut;ot++)F[O][I][ot]=(A[O][I][ot]-D[O][I][ot])/M;else{var Ht=i.matrix||new se,Xt={_:{transform:me.transform},getBBox:function(){return i.getBBox(1)}};D[O]=[Ht.a,Ht.b,Ht.c,Ht.d,Ht.e,Ht.f],ni(Xt,A[O]),A[O]=Xt._.transform,F[O]=[(Xt.matrix.a-Ht.a)/M,(Xt.matrix.b-Ht.b)/M,(Xt.matrix.c-Ht.c)/M,(Xt.matrix.d-Ht.d)/M,(Xt.matrix.e-Ht.e)/M,(Xt.matrix.f-Ht.f)/M]}break;case"csv":var ye=Y(m[O])[tt](V),xe=Y(D[O])[tt](V);if(O=="clip-rect")for(D[O]=xe,F[O]=[],I=xe.length;I--;)F[O][I]=(ye[I]-D[O][I])/M;A[O]=ye;break;default:for(ye=[][R](m[O]),xe=[][R](D[O]),F[O]=[],I=i.paper.customAttributes[O].length;I--;)F[O][I]=((ye[I]||0)-(xe[I]||0))/M}var Ae=m.easing,qt=o.easing_formulas[Ae];if(!qt)if((qt=Y(Ae).match(c))&&qt.length==5){var oe=qt;qt=function(Pe){return Ji(Pe,+oe[1],+oe[2],+oe[3],+oe[4],M)}}else qt=St;if(P={anim:t,percent:r,timestamp:H=m.start||t.start||+new Date,start:H+(t.del||0),status:0,initstatus:n||0,stop:!1,ms:M,easing:qt,from:D,diff:F,to:A,el:i,callback:m.callback,prev:L,next:E,repeat:p||t.times,origin:i.attr(),totalOrigin:a},xt.push(P),n&&!v&&!x&&(P.stop=!0,P.start=new Date-M*n,xt.length==1))return qe();x&&(P.start=new Date-P.ms*n),xt.length==1&&ui(qe)}l("raphael.anim.start."+i.id,i,t)}}function pi(t){for(var i=0;i<xt.length;i++)xt[i].el.paper==t&&xt.splice(i--,1)}_t.animateWith=function(t,i,r,n,a,p){if(this.removed)return p&&p.call(this),this;var m=r instanceof jt?r:o.animation(r,n,a,p);Ce(m,this,m.percents[0],null,this.attr());for(var v=0,x=xt.length;v<x;v++)if(xt[v].anim==i&&xt[v].el==t){xt[x-1].start=xt[v].start;break}return this},_t.onAnimation=function(t){return t?l.on("raphael.anim.frame."+this.id,t):l.unbind("raphael.anim.frame."+this.id),this},jt.prototype.delay=function(t){var i=new jt(this.anim,this.ms);return i.times=this.times,i.del=+t||0,i},jt.prototype.repeat=function(t){var i=new jt(this.anim,this.ms);return i.del=this.del,i.times=K.floor(st(t,0))||1,i},o.animation=function(t,i,r,n){if(t instanceof jt)return t;!o.is(r,"function")&&r||(n=n||r||null,r=null),t=Object(t),i=+i||0;var a,p,m={};for(p in t)t[Q](p)&&S(p)!=p&&S(p)+"%"!=p&&(a=!0,m[p]=t[p]);if(a)return r&&(m.easing=r),n&&(m.callback=n),new jt({100:m},i);if(n){var v=0;for(var x in t){var E=_(x);t[Q](x)&&E>v&&(v=E)}!t[v+="%"].callback&&(t[v].callback=n)}return new jt(t,i)},_t.animate=function(t,i,r,n){if(this.removed)return n&&n.call(this),this;var a=t instanceof jt?t:o.animation(t,i,r,n);return Ce(a,this,a.percents[0],null,this.attr()),this},_t.setTime=function(t,i){return t&&i!=null&&this.status(t,it(i,t.ms)/t.ms),this},_t.status=function(t,i){var r,n,a=[],p=0;if(i!=null)return Ce(t,this,-1,it(i,1)),this;for(r=xt.length;p<r;p++)if((n=xt[p]).el.id==this.id&&(!t||n.anim==t)){if(t)return n.status;a.push({anim:n.anim,status:n.status})}return t?0:a},_t.pause=function(t){for(var i=0;i<xt.length;i++)xt[i].el.id!=this.id||t&&xt[i].anim!=t||l("raphael.anim.pause."+this.id,this,xt[i].anim)!==!1&&(xt[i].paused=!0);return this},_t.resume=function(t){for(var i=0;i<xt.length;i++)if(xt[i].el.id==this.id&&(!t||xt[i].anim==t)){var r=xt[i];l("raphael.anim.resume."+this.id,this,r.anim)!==!1&&(delete r.paused,this.status(r.anim,r.status))}return this},_t.stop=function(t){for(var i=0;i<xt.length;i++)xt[i].el.id!=this.id||t&&xt[i].anim!=t||l("raphael.anim.stop."+this.id,this,xt[i].anim)!==!1&&xt.splice(i--,1);return this},l.on("raphael.remove",pi),l.on("raphael.clear",pi),_t.toString=function(){return"Raphaël’s object"};var fi,gi,ne,vi,Ne=function(t){if(this.items=[],this.length=0,this.type="set",t)for(var i=0,r=t.length;i<r;i++)!t[i]||t[i].constructor!=_t.constructor&&t[i].constructor!=Ne||(this[this.items.length]=this.items[this.items.length]=t[i],this.length++)},At=Ne.prototype;for(var Ke in At.push=function(){for(var t,i,r=0,n=arguments.length;r<n;r++)!(t=arguments[r])||t.constructor!=_t.constructor&&t.constructor!=Ne||(this[i=this.items.length]=this.items[i]=t,this.length++);return this},At.pop=function(){return this.length&&delete this[this.length--],this.items.pop()},At.forEach=function(t,i){for(var r=0,n=this.items.length;r<n;r++)if(t.call(i,this.items[r],r)===!1)return this;return this},_t)_t[Q](Ke)&&(At[Ke]=function(t){return function(){var i=arguments;return this.forEach(function(r){r[t][U](r,i)})}}(Ke));return At.attr=function(t,i){if(t&&o.is(t,mt)&&o.is(t[0],"object"))for(var r=0,n=t.length;r<n;r++)this.items[r].attr(t[r]);else for(var a=0,p=this.items.length;a<p;a++)this.items[a].attr(t,i);return this},At.clear=function(){for(;this.length;)this.pop()},At.splice=function(t,i,r){t=t<0?st(this.length+t,0):t,i=st(0,it(this.length-t,i));var n,a=[],p=[],m=[];for(n=2;n<arguments.length;n++)m.push(arguments[n]);for(n=0;n<i;n++)p.push(this[t+n]);for(;n<this.length-t;n++)a.push(this[t+n]);var v=m.length;for(n=0;n<v+a.length;n++)this.items[t+n]=this[t+n]=n<v?m[n]:a[n-v];for(n=this.items.length=this.length-=i-v;this[n];)delete this[n++];return new Ne(p)},At.exclude=function(t){for(var i=0,r=this.length;i<r;i++)if(this[i]==t)return this.splice(i,1),!0},At.animate=function(t,i,r,n){(o.is(r,"function")||!r)&&(n=r||null);var a,p,m=this.items.length,v=m,x=this;if(!m)return this;n&&(p=function(){!--m&&n.call(x)}),r=o.is(r,"string")?r:p;var E=o.animation(t,i,r,p);for(a=this.items[--v].animate(E);v--;)this.items[v]&&!this.items[v].removed&&this.items[v].animateWith(a,E,E),this.items[v]&&!this.items[v].removed||m--;return this},At.insertAfter=function(t){for(var i=this.items.length;i--;)this.items[i].insertAfter(t);return this},At.getBBox=function(){for(var t=[],i=[],r=[],n=[],a=this.items.length;a--;)if(!this.items[a].removed){var p=this.items[a].getBBox();t.push(p.x),i.push(p.y),r.push(p.x+p.width),n.push(p.y+p.height)}return{x:t=it[U](0,t),y:i=it[U](0,i),x2:r=st[U](0,r),y2:n=st[U](0,n),width:r-t,height:n-i}},At.clone=function(t){t=this.paper.set();for(var i=0,r=this.items.length;i<r;i++)t.push(this.items[i].clone());return t},At.toString=function(){return"Raphaël‘s set"},At.glow=function(t){var i=this.paper.set();return this.forEach(function(r,n){var a=r.glow(t);a!=null&&a.forEach(function(p,m){i.push(p)})}),i},At.isPointInside=function(t,i){var r=!1;return this.forEach(function(n){if(n.isPointInside(t,i))return r=!0,!1}),r},o.registerFont=function(t){if(!t.face)return t;this.fonts=this.fonts||{};var i={w:t.w,face:{},glyphs:{}},r=t.face["font-family"];for(var n in t.face)t.face[Q](n)&&(i.face[n]=t.face[n]);if(this.fonts[r]?this.fonts[r].push(i):this.fonts[r]=[i],!t.svg){for(var a in i.face["units-per-em"]=_(t.face["units-per-em"],10),t.glyphs)if(t.glyphs[Q](a)){var p=t.glyphs[a];if(i.glyphs[a]={w:p.w,k:{},d:p.d&&"M"+p.d.replace(/[mlcxtrv]/g,function(v){return{l:"L",c:"C",x:"z",t:"m",r:"l",v:"c"}[v]||"M"})+"z"},p.k)for(var m in p.k)p[Q](m)&&(i.glyphs[a].k[m]=p.k[m])}}return t},N.getFont=function(t,i,r,n){if(n=n||"normal",r=r||"normal",i=+i||{normal:400,bold:700,lighter:300,bolder:800}[i]||400,o.fonts){var a,p=o.fonts[t];if(!p){var m=new RegExp("(^|\\s)"+t.replace(/[^\w\d\s+!~.:_-]/g,rt)+"(\\s|$)","i");for(var v in o.fonts)if(o.fonts[Q](v)&&m.test(v)){p=o.fonts[v];break}}if(p)for(var x=0,E=p.length;x<E&&((a=p[x]).face["font-weight"]!=i||a.face["font-style"]!=r&&a.face["font-style"]||a.face["font-stretch"]!=n);x++);return a}},N.print=function(t,i,r,n,a,p,m,v){p=p||"middle",m=st(it(m||0,1),-1),v=st(it(v||1,3),1);var x,E=Y(r)[tt](rt),L=0,H=0,M=rt;if(o.is(n,"string")&&(n=this.getFont(n)),n){x=(a||16)/n.face["units-per-em"];for(var D=n.face.bbox[tt](V),A=+D[0],F=D[3]-D[1],P=0,I=+D[1]+(p=="baseline"?F+ +n.face.descent:F/2),Z=0,O=E.length;Z<O;Z++){if(E[Z]==`
`)L=0,$=0,H=0,P+=F*v;else{var X=H&&n.glyphs[E[Z-1]]||{},$=n.glyphs[E[Z]];L+=H?(X.w||n.w)+(X.k&&X.k[E[Z]]||0)+n.w*m:0,H=1}$&&$.d&&(M+=o.transformPath($.d,["t",L*x,P*x,"s",x,x,A,I,"t",(t-A)/x,(i-I)/x]))}}return this.path(M).attr({fill:"#000",stroke:"none"})},N.add=function(t){if(o.is(t,"array"))for(var i,r=this.set(),n=0,a=t.length;n<a;n++)i=t[n]||{},W[Q](i.type)&&r.push(this[i.type]().attr(i));return r},o.format=function(t,i){var r=o.is(i,mt)?[0][R](i):arguments;return t&&o.is(t,"string")&&r.length-1&&(t=t.replace(lt,function(n,a){return r[++a]==null?rt:r[a]})),t||rt},o.fullfill=(fi=/\{([^\}]+)\}/g,gi=/(?:(?:^|\.)(.+?)(?=\[|\.|$|\()|\[('|")(.+?)\2\])(\(\))?/g,function(t,i){return String(t).replace(fi,function(r,n){return function(a,p,m){var v=m;return p.replace(gi,function(x,E,L,H,M){E=E||H,v&&(E in v&&(v=v[E]),typeof v=="function"&&M&&(v=v()))}),v=(v==null||v==m?a:v)+""}(r,n,i)})}),o.ninja=function(){if(J.was)q.win.Raphael=J.is;else{window.Raphael=void 0;try{delete window.Raphael}catch{}}return o},o.st=At,l.on("raphael.DOMload",function(){k=!0}),(ne=document).readyState==null&&ne.addEventListener&&(ne.addEventListener("DOMContentLoaded",vi=function(){ne.removeEventListener("DOMContentLoaded",vi,!1),ne.readyState="complete"},!1),ne.readyState="loading"),function t(){/in/.test(ne.readyState)?setTimeout(t,9):o.eve("raphael.DOMload")}(),o}.apply(h,g))===void 0||(s.exports=w)},function(s,h,u){var g,w;g=[u(0),u(3),u(4)],(w=function(l){return l}.apply(h,g))===void 0||(s.exports=w)},function(s,h,u){var g,w,l,o,k,N,V,W,lt,Q,q,J,Ct,U;o="hasOwnProperty",k=/[\.\/]/,N=/\s*,\s*/,V=function(R,ct){return R-ct},W={n:{}},lt=function(){for(var R=0,ct=this.length;R<ct;R++)if(this[R]!==void 0)return this[R]},Q=function(){for(var R=this.length;--R;)if(this[R]!==void 0)return this[R]},q=Object.prototype.toString,J=String,Ct=Array.isArray||function(R){return R instanceof Array||q.call(R)=="[object Array]"},(U=function(R,ct){var rt,pt=l,Y=Array.prototype.slice.call(arguments,2),tt=U.listeners(R),nt=0,wt=[],at={},K=[],st=w;K.firstDefined=lt,K.lastDefined=Q,w=R,l=0;for(var it=0,Et=tt.length;it<Et;it++)"zIndex"in tt[it]&&(wt.push(tt[it].zIndex),tt[it].zIndex<0&&(at[tt[it].zIndex]=tt[it]));for(wt.sort(V);wt[nt]<0;)if(rt=at[wt[nt++]],K.push(rt.apply(ct,Y)),l)return l=pt,K;for(it=0;it<Et;it++)if("zIndex"in(rt=tt[it]))if(rt.zIndex==wt[nt]){if(K.push(rt.apply(ct,Y)),l)break;do if((rt=at[wt[++nt]])&&K.push(rt.apply(ct,Y)),l)break;while(rt)}else at[rt.zIndex]=rt;else if(K.push(rt.apply(ct,Y)),l)break;return l=pt,w=st,K})._events=W,U.listeners=function(R){var ct,rt,pt,Y,tt,nt,wt,at,K=Ct(R)?R:R.split(k),st=W,it=[st],Et=[];for(Y=0,tt=K.length;Y<tt;Y++){for(at=[],nt=0,wt=it.length;nt<wt;nt++)for(rt=[(st=it[nt].n)[K[Y]],st["*"]],pt=2;pt--;)(ct=rt[pt])&&(at.push(ct),Et=Et.concat(ct.f||[]));it=at}return Et},U.separator=function(R){R?(R="["+(R=J(R).replace(/(?=[\.\^\]\[\-])/g,"\\"))+"]",k=new RegExp(R)):k=/[\.\/]/},U.on=function(R,ct){if(typeof ct!="function")return function(){};for(var rt=Ct(R)?Ct(R[0])?R:[R]:J(R).split(N),pt=0,Y=rt.length;pt<Y;pt++)(function(tt){for(var nt,wt=Ct(tt)?tt:J(tt).split(k),at=W,K=0,st=wt.length;K<st;K++)at=(at=at.n).hasOwnProperty(wt[K])&&at[wt[K]]||(at[wt[K]]={n:{}});for(at.f=at.f||[],K=0,st=at.f.length;K<st;K++)if(at.f[K]==ct){nt=!0;break}!nt&&at.f.push(ct)})(rt[pt]);return function(tt){+tt==+tt&&(ct.zIndex=+tt)}},U.f=function(R){var ct=[].slice.call(arguments,1);return function(){U.apply(null,[R,null].concat(ct).concat([].slice.call(arguments,0)))}},U.stop=function(){l=1},U.nt=function(R){var ct=Ct(w)?w.join("."):w;return R?new RegExp("(?:\\.|\\/|^)"+R+"(?:\\.|\\/|$)").test(ct):ct},U.nts=function(){return Ct(w)?w:w.split(k)},U.off=U.unbind=function(R,ct){if(R){var rt=Ct(R)?Ct(R[0])?R:[R]:J(R).split(N);if(rt.length>1)for(var pt=0,Y=rt.length;pt<Y;pt++)U.off(rt[pt],ct);else{rt=Ct(R)?R:J(R).split(k);var tt,nt,wt,at,K,st=[W];for(pt=0,Y=rt.length;pt<Y;pt++)for(at=0;at<st.length;at+=wt.length-2){if(wt=[at,1],tt=st[at].n,rt[pt]!="*")tt[rt[pt]]&&wt.push(tt[rt[pt]]);else for(nt in tt)tt[o](nt)&&wt.push(tt[nt]);st.splice.apply(st,wt)}for(pt=0,Y=st.length;pt<Y;pt++)for(tt=st[pt];tt.n;){if(ct){if(tt.f){for(at=0,K=tt.f.length;at<K;at++)if(tt.f[at]==ct){tt.f.splice(at,1);break}!tt.f.length&&delete tt.f}for(nt in tt.n)if(tt.n[o](nt)&&tt.n[nt].f){var it=tt.n[nt].f;for(at=0,K=it.length;at<K;at++)if(it[at]==ct){it.splice(at,1);break}!it.length&&delete tt.n[nt].f}}else for(nt in delete tt.f,tt.n)tt.n[o](nt)&&tt.n[nt].f&&delete tt.n[nt].f;tt=tt.n}}}else U._events=W={n:{}}},U.once=function(R,ct){var rt=function(){return U.off(R,rt),ct.apply(this,arguments)};return U.on(R,rt)},U.version="0.5.0",U.toString=function(){return"You are running Eve 0.5.0"},s.exports?s.exports=U:(g=function(){return U}.apply(h,[]))===void 0||(s.exports=g)},function(s,h,u){var g,w;g=[u(0)],(w=function(l){if(!l||l.svg){var o="hasOwnProperty",k=String,N=parseFloat,V=parseInt,W=Math,lt=W.max,Q=W.abs,q=W.pow,J=/[, ]+/,Ct=l.eve,U="",R=" ",ct="http://www.w3.org/1999/xlink",rt={block:"M5,0 0,2.5 5,5z",classic:"M5,0 0,2.5 5,5 3.5,3 3.5,2z",diamond:"M2.5,0 5,2.5 2.5,5 0,2.5z",open:"M6,1 1,3.5 6,6",oval:"M2.5,0A2.5,2.5,0,0,1,2.5,5 2.5,2.5,0,0,1,2.5,0z"},pt={};l.toString=function(){return`Your browser supports SVG.
You are running Raphaël `+this.version};var Y=function(f,d){if(d)for(var c in typeof f=="string"&&(f=Y(f)),d)d[o](c)&&(c.substring(0,6)=="xlink:"?f.setAttributeNS(ct,c.substring(6),k(d[c])):f.setAttribute(c,k(d[c])));else(f=l._g.doc.createElementNS("http://www.w3.org/2000/svg",f)).style&&(f.style.webkitTapHighlightColor="rgba(0,0,0,0)");return f},tt=function(f,d){var c="linear",y=f.id+d,S=.5,_=.5,C=f.node,z=f.paper,B=C.style,G=l._g.doc.getElementById(y);if(!G){if(d=(d=k(d).replace(l._radial_gradient,function(Nt,St,ht){if(c="radial",St&&ht){S=N(St);var It=2*((_=N(ht))>.5)-1;q(S-.5,2)+q(_-.5,2)>.25&&(_=W.sqrt(.25-q(S-.5,2))*It+.5)&&_!=.5&&(_=_.toFixed(5)-1e-5*It)}return U})).split(/\s*\-\s*/),c=="linear"){var j=d.shift();if(j=-N(j),isNaN(j))return null;var et=[0,0,W.cos(l.rad(j)),W.sin(l.rad(j))],gt=1/(lt(Q(et[2]),Q(et[3]))||1);et[2]*=gt,et[3]*=gt,et[2]<0&&(et[0]=-et[2],et[2]=0),et[3]<0&&(et[1]=-et[3],et[3]=0)}var yt=l._parseDots(d);if(!yt)return null;if(y=y.replace(/[\(\)\s,\xb0#]/g,"_"),f.gradient&&y!=f.gradient.id&&(z.defs.removeChild(f.gradient),delete f.gradient),!f.gradient){G=Y(c+"Gradient",{id:y}),f.gradient=G,Y(G,c=="radial"?{fx:S,fy:_}:{x1:et[0],y1:et[1],x2:et[2],y2:et[3],gradientTransform:f.matrix.invert()}),z.defs.appendChild(G);for(var vt=0,kt=yt.length;vt<kt;vt++)G.appendChild(Y("stop",{offset:yt[vt].offset?yt[vt].offset:vt?"100%":"0%","stop-color":yt[vt].color||"#fff","stop-opacity":isFinite(yt[vt].opacity)?yt[vt].opacity:1}))}}return Y(C,{fill:nt(y),opacity:1,"fill-opacity":1}),B.fill=U,B.opacity=1,B.fillOpacity=1,1},nt=function(f){if((d=document.documentMode)&&(d===9||d===10))return"url('#"+f+"')";var d,c=document.location;return"url('"+(c.protocol+"//"+c.host+c.pathname+c.search)+"#"+f+"')"},wt=function(f){var d=f.getBBox(1);Y(f.pattern,{patternTransform:f.matrix.invert()+" translate("+d.x+","+d.y+")"})},at=function(f,d,c){if(f.type=="path"){for(var y,S,_,C,z,B=k(d).toLowerCase().split("-"),G=f.paper,j=c?"end":"start",et=f.node,gt=f.attrs,yt=gt["stroke-width"],vt=B.length,kt="classic",Nt=3,St=3,ht=5;vt--;)switch(B[vt]){case"block":case"classic":case"oval":case"diamond":case"open":case"none":kt=B[vt];break;case"wide":St=5;break;case"narrow":St=2;break;case"long":Nt=5;break;case"short":Nt=2}if(kt=="open"?(Nt+=2,St+=2,ht+=2,_=1,C=c?4:1,z={fill:"none",stroke:gt.stroke}):(C=_=Nt/2,z={fill:gt.stroke,stroke:"none"}),f._.arrows?c?(f._.arrows.endPath&&pt[f._.arrows.endPath]--,f._.arrows.endMarker&&pt[f._.arrows.endMarker]--):(f._.arrows.startPath&&pt[f._.arrows.startPath]--,f._.arrows.startMarker&&pt[f._.arrows.startMarker]--):f._.arrows={},kt!="none"){var It="raphael-marker-"+kt,Tt="raphael-marker-"+j+kt+Nt+St+"-obj"+f.id;l._g.doc.getElementById(It)?pt[It]++:(G.defs.appendChild(Y(Y("path"),{"stroke-linecap":"round",d:rt[kt],id:It})),pt[It]=1);var Mt,Bt=l._g.doc.getElementById(Tt);Bt?(pt[Tt]++,Mt=Bt.getElementsByTagName("use")[0]):(Bt=Y(Y("marker"),{id:Tt,markerHeight:St,markerWidth:Nt,orient:"auto",refX:C,refY:St/2}),Mt=Y(Y("use"),{"xlink:href":"#"+It,transform:(c?"rotate(180 "+Nt/2+" "+St/2+") ":U)+"scale("+Nt/ht+","+St/ht+")","stroke-width":(1/((Nt/ht+St/ht)/2)).toFixed(4)}),Bt.appendChild(Mt),G.defs.appendChild(Bt),pt[Tt]=1),Y(Mt,z);var Ft=_*(kt!="diamond"&&kt!="oval");c?(y=f._.arrows.startdx*yt||0,S=l.getTotalLength(gt.path)-Ft*yt):(y=Ft*yt,S=l.getTotalLength(gt.path)-(f._.arrows.enddx*yt||0)),(z={})["marker-"+j]="url(#"+Tt+")",(S||y)&&(z.d=l.getSubpath(gt.path,y,S)),Y(et,z),f._.arrows[j+"Path"]=It,f._.arrows[j+"Marker"]=Tt,f._.arrows[j+"dx"]=Ft,f._.arrows[j+"Type"]=kt,f._.arrows[j+"String"]=d}else c?(y=f._.arrows.startdx*yt||0,S=l.getTotalLength(gt.path)-y):(y=0,S=l.getTotalLength(gt.path)-(f._.arrows.enddx*yt||0)),f._.arrows[j+"Path"]&&Y(et,{d:l.getSubpath(gt.path,y,S)}),delete f._.arrows[j+"Path"],delete f._.arrows[j+"Marker"],delete f._.arrows[j+"dx"],delete f._.arrows[j+"Type"],delete f._.arrows[j+"String"];for(z in pt)if(pt[o](z)&&!pt[z]){var Pt=l._g.doc.getElementById(z);Pt&&Pt.parentNode.removeChild(Pt)}}},K={"-":[3,1],".":[1,1],"-.":[3,1,1,1],"-..":[3,1,1,1,1,1],". ":[1,3],"- ":[4,3],"--":[8,3],"- .":[4,3,1,3],"--.":[8,3,1,3],"--..":[8,3,1,3,1,3]},st=function(f,d,c){if(d=K[k(d).toLowerCase()]){for(var y=f.attrs["stroke-width"]||"1",S={round:y,square:y,butt:0}[f.attrs["stroke-linecap"]||c["stroke-linecap"]]||0,_=[],C=d.length;C--;)_[C]=d[C]*y+(C%2?1:-1)*S;Y(f.node,{"stroke-dasharray":_.join(",")})}else Y(f.node,{"stroke-dasharray":"none"})},it=function(f,d){var c=f.node,y=f.attrs,S=c.style.visibility;for(var _ in c.style.visibility="hidden",d)if(d[o](_)){if(!l._availableAttrs[o](_))continue;var C=d[_];switch(y[_]=C,_){case"blur":f.blur(C);break;case"title":var z=c.getElementsByTagName("title");if(z.length&&(z=z[0]))z.firstChild.nodeValue=C;else{z=Y("title");var B=l._g.doc.createTextNode(C);z.appendChild(B),c.appendChild(z)}break;case"href":case"target":var G=c.parentNode;if(G.tagName.toLowerCase()!="a"){var j=Y("a");G.insertBefore(j,c),j.appendChild(c),G=j}_=="target"?G.setAttributeNS(ct,"show",C=="blank"?"new":C):G.setAttributeNS(ct,_,C);break;case"cursor":c.style.cursor=C;break;case"transform":f.transform(C);break;case"arrow-start":at(f,C);break;case"arrow-end":at(f,C,1);break;case"clip-rect":var et=k(C).split(J);if(et.length==4){f.clip&&f.clip.parentNode.parentNode.removeChild(f.clip.parentNode);var gt=Y("clipPath"),yt=Y("rect");gt.id=l.createUUID(),Y(yt,{x:et[0],y:et[1],width:et[2],height:et[3]}),gt.appendChild(yt),f.paper.defs.appendChild(gt),Y(c,{"clip-path":"url(#"+gt.id+")"}),f.clip=yt}if(!C){var vt=c.getAttribute("clip-path");if(vt){var kt=l._g.doc.getElementById(vt.replace(/(^url\(#|\)$)/g,U));kt&&kt.parentNode.removeChild(kt),Y(c,{"clip-path":U}),delete f.clip}}break;case"path":f.type=="path"&&(Y(c,{d:C?y.path=l._pathToAbsolute(C):"M0,0"}),f._.dirty=1,f._.arrows&&("startString"in f._.arrows&&at(f,f._.arrows.startString),"endString"in f._.arrows&&at(f,f._.arrows.endString,1)));break;case"width":if(c.setAttribute(_,C),f._.dirty=1,!y.fx)break;_="x",C=y.x;case"x":y.fx&&(C=-y.x-(y.width||0));case"rx":if(_=="rx"&&f.type=="rect")break;case"cx":c.setAttribute(_,C),f.pattern&&wt(f),f._.dirty=1;break;case"height":if(c.setAttribute(_,C),f._.dirty=1,!y.fy)break;_="y",C=y.y;case"y":y.fy&&(C=-y.y-(y.height||0));case"ry":if(_=="ry"&&f.type=="rect")break;case"cy":c.setAttribute(_,C),f.pattern&&wt(f),f._.dirty=1;break;case"r":f.type=="rect"?Y(c,{rx:C,ry:C}):c.setAttribute(_,C),f._.dirty=1;break;case"src":f.type=="image"&&c.setAttributeNS(ct,"href",C);break;case"stroke-width":f._.sx==1&&f._.sy==1||(C/=lt(Q(f._.sx),Q(f._.sy))||1),c.setAttribute(_,C),y["stroke-dasharray"]&&st(f,y["stroke-dasharray"],d),f._.arrows&&("startString"in f._.arrows&&at(f,f._.arrows.startString),"endString"in f._.arrows&&at(f,f._.arrows.endString,1));break;case"stroke-dasharray":st(f,C,d);break;case"fill":var Nt=k(C).match(l._ISURL);if(Nt){gt=Y("pattern");var St=Y("image");gt.id=l.createUUID(),Y(gt,{x:0,y:0,patternUnits:"userSpaceOnUse",height:1,width:1}),Y(St,{x:0,y:0,"xlink:href":Nt[1]}),gt.appendChild(St),function(Bt){l._preload(Nt[1],function(){var Ft=this.offsetWidth,Pt=this.offsetHeight;Y(Bt,{width:Ft,height:Pt}),Y(St,{width:Ft,height:Pt})})}(gt),f.paper.defs.appendChild(gt),Y(c,{fill:"url(#"+gt.id+")"}),f.pattern=gt,f.pattern&&wt(f);break}var ht=l.getRGB(C);if(ht.error){if((f.type=="circle"||f.type=="ellipse"||k(C).charAt()!="r")&&tt(f,C)){if("opacity"in y||"fill-opacity"in y){var It=l._g.doc.getElementById(c.getAttribute("fill").replace(/^url\(#|\)$/g,U));if(It){var Tt=It.getElementsByTagName("stop");Y(Tt[Tt.length-1],{"stop-opacity":("opacity"in y?y.opacity:1)*("fill-opacity"in y?y["fill-opacity"]:1)})}}y.gradient=C,y.fill="none";break}}else delete d.gradient,delete y.gradient,!l.is(y.opacity,"undefined")&&l.is(d.opacity,"undefined")&&Y(c,{opacity:y.opacity}),!l.is(y["fill-opacity"],"undefined")&&l.is(d["fill-opacity"],"undefined")&&Y(c,{"fill-opacity":y["fill-opacity"]});ht[o]("opacity")&&Y(c,{"fill-opacity":ht.opacity>1?ht.opacity/100:ht.opacity});case"stroke":ht=l.getRGB(C),c.setAttribute(_,ht.hex),_=="stroke"&&ht[o]("opacity")&&Y(c,{"stroke-opacity":ht.opacity>1?ht.opacity/100:ht.opacity}),_=="stroke"&&f._.arrows&&("startString"in f._.arrows&&at(f,f._.arrows.startString),"endString"in f._.arrows&&at(f,f._.arrows.endString,1));break;case"gradient":(f.type=="circle"||f.type=="ellipse"||k(C).charAt()!="r")&&tt(f,C);break;case"opacity":y.gradient&&!y[o]("stroke-opacity")&&Y(c,{"stroke-opacity":C>1?C/100:C});case"fill-opacity":if(y.gradient){(It=l._g.doc.getElementById(c.getAttribute("fill").replace(/^url\(#|\)$/g,U)))&&(Tt=It.getElementsByTagName("stop"),Y(Tt[Tt.length-1],{"stop-opacity":C}));break}default:_=="font-size"&&(C=V(C,10)+"px");var Mt=_.replace(/(\-.)/g,function(Bt){return Bt.substring(1).toUpperCase()});c.style[Mt]=C,f._.dirty=1,c.setAttribute(_,C)}}Et(f,d),c.style.visibility=S},Et=function(f,d){if(f.type=="text"&&(d[o]("text")||d[o]("font")||d[o]("font-size")||d[o]("x")||d[o]("y"))){var c=f.attrs,y=f.node,S=y.firstChild?V(l._g.doc.defaultView.getComputedStyle(y.firstChild,U).getPropertyValue("font-size"),10):10;if(d[o]("text")){for(c.text=d.text;y.firstChild;)y.removeChild(y.firstChild);for(var _,C=k(d.text).split(`
`),z=[],B=0,G=C.length;B<G;B++)_=Y("tspan"),B&&Y(_,{dy:1.2*S,x:c.x}),_.appendChild(l._g.doc.createTextNode(C[B])),y.appendChild(_),z[B]=_}else for(B=0,G=(z=y.getElementsByTagName("tspan")).length;B<G;B++)B?Y(z[B],{dy:1.2*S,x:c.x}):Y(z[0],{dy:0});Y(y,{x:c.x,y:c.y}),f._.dirty=1;var j=f._getBBox(),et=c.y-(j.y+j.height/2);et&&l.is(et,"finite")&&Y(z[0],{dy:et})}},Dt=function(f){return f.parentNode&&f.parentNode.tagName.toLowerCase()==="a"?f.parentNode:f},Lt=function(f,d){this[0]=this.node=f,f.raphael=!0,this.id=("0000"+(Math.random()*Math.pow(36,5)<<0).toString(36)).slice(-5),f.raphaelid=this.id,this.matrix=l.matrix(),this.realPath=null,this.paper=d,this.attrs=this.attrs||{},this._={transform:[],sx:1,sy:1,deg:0,dx:0,dy:0,dirty:1},!d.bottom&&(d.bottom=this),this.prev=d.top,d.top&&(d.top.next=this),d.top=this,this.next=null},ft=l.el;Lt.prototype=ft,ft.constructor=Lt,l._engine.path=function(f,d){var c=Y("path");d.canvas&&d.canvas.appendChild(c);var y=new Lt(c,d);return y.type="path",it(y,{fill:"none",stroke:"#000",path:f}),y},ft.rotate=function(f,d,c){if(this.removed)return this;if((f=k(f).split(J)).length-1&&(d=N(f[1]),c=N(f[2])),f=N(f[0]),c==null&&(d=c),d==null||c==null){var y=this.getBBox(1);d=y.x+y.width/2,c=y.y+y.height/2}return this.transform(this._.transform.concat([["r",f,d,c]])),this},ft.scale=function(f,d,c,y){if(this.removed)return this;if((f=k(f).split(J)).length-1&&(d=N(f[1]),c=N(f[2]),y=N(f[3])),f=N(f[0]),d==null&&(d=f),y==null&&(c=y),c==null||y==null)var S=this.getBBox(1);return c=c??S.x+S.width/2,y=y??S.y+S.height/2,this.transform(this._.transform.concat([["s",f,d,c,y]])),this},ft.translate=function(f,d){return this.removed?this:((f=k(f).split(J)).length-1&&(d=N(f[1])),f=N(f[0])||0,d=+d||0,this.transform(this._.transform.concat([["t",f,d]])),this)},ft.transform=function(f){var d=this._;if(f==null)return d.transform;if(l._extractTransform(this,f),this.clip&&Y(this.clip,{transform:this.matrix.invert()}),this.pattern&&wt(this),this.node&&Y(this.node,{transform:this.matrix}),d.sx!=1||d.sy!=1){var c=this.attrs[o]("stroke-width")?this.attrs["stroke-width"]:1;this.attr({"stroke-width":c})}return this},ft.hide=function(){return this.removed||(this.node.style.display="none"),this},ft.show=function(){return this.removed||(this.node.style.display=""),this},ft.remove=function(){var f=Dt(this.node);if(!this.removed&&f.parentNode){var d=this.paper;for(var c in d.__set__&&d.__set__.exclude(this),Ct.unbind("raphael.*.*."+this.id),this.gradient&&d.defs.removeChild(this.gradient),l._tear(this,d),f.parentNode.removeChild(f),this.removeData(),this)this[c]=typeof this[c]=="function"?l._removedFactory(c):null;this.removed=!0}},ft._getBBox=function(){if(this.node.style.display=="none"){this.show();var f=!0}var d,c=!1;this.paper.canvas.parentElement?d=this.paper.canvas.parentElement.style:this.paper.canvas.parentNode&&(d=this.paper.canvas.parentNode.style),d&&d.display=="none"&&(c=!0,d.display="");var y={};try{y=this.node.getBBox()}catch{y={x:this.node.clientLeft,y:this.node.clientTop,width:this.node.clientWidth,height:this.node.clientHeight}}finally{y=y||{},c&&(d.display="none")}return f&&this.hide(),y},ft.attr=function(f,d){if(this.removed)return this;if(f==null){var c={};for(var y in this.attrs)this.attrs[o](y)&&(c[y]=this.attrs[y]);return c.gradient&&c.fill=="none"&&(c.fill=c.gradient)&&delete c.gradient,c.transform=this._.transform,c}if(d==null&&l.is(f,"string")){if(f=="fill"&&this.attrs.fill=="none"&&this.attrs.gradient)return this.attrs.gradient;if(f=="transform")return this._.transform;for(var S=f.split(J),_={},C=0,z=S.length;C<z;C++)(f=S[C])in this.attrs?_[f]=this.attrs[f]:l.is(this.paper.customAttributes[f],"function")?_[f]=this.paper.customAttributes[f].def:_[f]=l._availableAttrs[f];return z-1?_:_[S[0]]}if(d==null&&l.is(f,"array")){for(_={},C=0,z=f.length;C<z;C++)_[f[C]]=this.attr(f[C]);return _}if(d!=null){var B={};B[f]=d}else f!=null&&l.is(f,"object")&&(B=f);for(var G in B)Ct("raphael.attr."+G+"."+this.id,this,B[G]);for(G in this.paper.customAttributes)if(this.paper.customAttributes[o](G)&&B[o](G)&&l.is(this.paper.customAttributes[G],"function")){var j=this.paper.customAttributes[G].apply(this,[].concat(B[G]));for(var et in this.attrs[G]=B[G],j)j[o](et)&&(B[et]=j[et])}return it(this,B),this},ft.toFront=function(){if(this.removed)return this;var f=Dt(this.node);f.parentNode.appendChild(f);var d=this.paper;return d.top!=this&&l._tofront(this,d),this},ft.toBack=function(){if(this.removed)return this;var f=Dt(this.node),d=f.parentNode;return d.insertBefore(f,d.firstChild),l._toback(this,this.paper),this.paper,this},ft.insertAfter=function(f){if(this.removed||!f)return this;var d=Dt(this.node),c=Dt(f.node||f[f.length-1].node);return c.nextSibling?c.parentNode.insertBefore(d,c.nextSibling):c.parentNode.appendChild(d),l._insertafter(this,f,this.paper),this},ft.insertBefore=function(f){if(this.removed||!f)return this;var d=Dt(this.node),c=Dt(f.node||f[0].node);return c.parentNode.insertBefore(d,c),l._insertbefore(this,f,this.paper),this},ft.blur=function(f){var d=this;if(+f!=0){var c=Y("filter"),y=Y("feGaussianBlur");d.attrs.blur=f,c.id=l.createUUID(),Y(y,{stdDeviation:+f||1.5}),c.appendChild(y),d.paper.defs.appendChild(c),d._blur=c,Y(d.node,{filter:"url(#"+c.id+")"})}else d._blur&&(d._blur.parentNode.removeChild(d._blur),delete d._blur,delete d.attrs.blur),d.node.removeAttribute("filter");return d},l._engine.circle=function(f,d,c,y){var S=Y("circle");f.canvas&&f.canvas.appendChild(S);var _=new Lt(S,f);return _.attrs={cx:d,cy:c,r:y,fill:"none",stroke:"#000"},_.type="circle",Y(S,_.attrs),_},l._engine.rect=function(f,d,c,y,S,_){var C=Y("rect");f.canvas&&f.canvas.appendChild(C);var z=new Lt(C,f);return z.attrs={x:d,y:c,width:y,height:S,rx:_||0,ry:_||0,fill:"none",stroke:"#000"},z.type="rect",Y(C,z.attrs),z},l._engine.ellipse=function(f,d,c,y,S){var _=Y("ellipse");f.canvas&&f.canvas.appendChild(_);var C=new Lt(_,f);return C.attrs={cx:d,cy:c,rx:y,ry:S,fill:"none",stroke:"#000"},C.type="ellipse",Y(_,C.attrs),C},l._engine.image=function(f,d,c,y,S,_){var C=Y("image");Y(C,{x:c,y,width:S,height:_,preserveAspectRatio:"none"}),C.setAttributeNS(ct,"href",d),f.canvas&&f.canvas.appendChild(C);var z=new Lt(C,f);return z.attrs={x:c,y,width:S,height:_,src:d},z.type="image",z},l._engine.text=function(f,d,c,y){var S=Y("text");f.canvas&&f.canvas.appendChild(S);var _=new Lt(S,f);return _.attrs={x:d,y:c,"text-anchor":"middle",text:y,"font-family":l._availableAttrs["font-family"],"font-size":l._availableAttrs["font-size"],stroke:"none",fill:"#000"},_.type="text",it(_,_.attrs),_},l._engine.setSize=function(f,d){return this.width=f||this.width,this.height=d||this.height,this.canvas.setAttribute("width",this.width),this.canvas.setAttribute("height",this.height),this._viewBox&&this.setViewBox.apply(this,this._viewBox),this},l._engine.create=function(){var f=l._getContainer.apply(0,arguments),d=f&&f.container;if(!d)throw new Error("SVG container not found.");var c,y=f.x,S=f.y,_=f.width,C=f.height,z=Y("svg"),B="overflow:hidden;";return y=y||0,S=S||0,Y(z,{height:C=C||342,version:1.1,width:_=_||512,xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink"}),d==1?(z.style.cssText=B+"position:absolute;left:"+y+"px;top:"+S+"px",l._g.doc.body.appendChild(z),c=1):(z.style.cssText=B+"position:relative",d.firstChild?d.insertBefore(z,d.firstChild):d.appendChild(z)),(d=new l._Paper).width=_,d.height=C,d.canvas=z,d.clear(),d._left=d._top=0,c&&(d.renderfix=function(){}),d.renderfix(),d},l._engine.setViewBox=function(f,d,c,y,S){Ct("raphael.setViewBox",this,this._viewBox,[f,d,c,y,S]);var _,C,z=this.getSize(),B=lt(c/z.width,y/z.height),G=this.top,j=S?"xMidYMid meet":"xMinYMin";for(f==null?(this._vbSize&&(B=1),delete this._vbSize,_="0 0 "+this.width+R+this.height):(this._vbSize=B,_=f+R+d+R+c+R+y),Y(this.canvas,{viewBox:_,preserveAspectRatio:j});B&&G;)C="stroke-width"in G.attrs?G.attrs["stroke-width"]:1,G.attr({"stroke-width":C}),G._.dirty=1,G._.dirtyT=1,G=G.prev;return this._viewBox=[f,d,c,y,!!S],this},l.prototype.renderfix=function(){var f,d=this.canvas,c=d.style;try{f=d.getScreenCTM()||d.createSVGMatrix()}catch{f=d.createSVGMatrix()}var y=-f.e%1,S=-f.f%1;(y||S)&&(y&&(this._left=(this._left+y)%1,c.left=this._left+"px"),S&&(this._top=(this._top+S)%1,c.top=this._top+"px"))},l.prototype.clear=function(){l.eve("raphael.clear",this);for(var f=this.canvas;f.firstChild;)f.removeChild(f.firstChild);this.bottom=this.top=null,(this.desc=Y("desc")).appendChild(l._g.doc.createTextNode("Created with Raphaël "+l.version)),f.appendChild(this.desc),f.appendChild(this.defs=Y("defs"))},l.prototype.remove=function(){for(var f in Ct("raphael.remove",this),this.canvas.parentNode&&this.canvas.parentNode.removeChild(this.canvas),this)this[f]=typeof this[f]=="function"?l._removedFactory(f):null};var mt=l.st;for(var Wt in ft)ft[o](Wt)&&!mt[o](Wt)&&(mt[Wt]=function(f){return function(){var d=arguments;return this.forEach(function(c){c[f].apply(c,d)})}}(Wt))}}.apply(h,g))===void 0||(s.exports=w)},function(s,h,u){var g,w;g=[u(0)],(w=function(l){if(!l||l.vml){var o="hasOwnProperty",k=String,N=parseFloat,V=Math,W=V.round,lt=V.max,Q=V.min,q=V.abs,J=/[, ]+/,Ct=l.eve,U=" ",R="",ct={M:"m",L:"l",C:"c",Z:"x",m:"t",l:"r",c:"v",z:"x"},rt=/([clmz]),?([^clmz]*)/gi,pt=/ progid:\S+Blur\([^\)]+\)/g,Y=/-?[^,\s-]+/g,tt="position:absolute;left:0;top:0;width:1px;height:1px;behavior:url(#default#VML)",nt=21600,wt={path:1,rect:1,image:1},at={circle:1,ellipse:1},K=function(d,c,y){var S=l.matrix();return S.rotate(-d,.5,.5),{dx:S.x(c,y),dy:S.y(c,y)}},st=function(d,c,y,S,_,C){var z=d._,B=d.matrix,G=z.fillpos,j=d.node,et=j.style,gt=1,yt="",vt=nt/c,kt=nt/y;if(et.visibility="hidden",c&&y){if(j.coordsize=q(vt)+U+q(kt),et.rotation=C*(c*y<0?-1:1),C){var Nt=K(C,S,_);S=Nt.dx,_=Nt.dy}if(c<0&&(yt+="x"),y<0&&(yt+=" y")&&(gt=-1),et.flip=yt,j.coordorigin=S*-vt+U+_*-kt,G||z.fillsize){var St=j.getElementsByTagName("fill");St=St&&St[0],j.removeChild(St),G&&(Nt=K(C,B.x(G[0],G[1]),B.y(G[0],G[1])),St.position=Nt.dx*gt+U+Nt.dy*gt),z.fillsize&&(St.size=z.fillsize[0]*q(c)+U+z.fillsize[1]*q(y)),j.appendChild(St)}et.visibility="visible"}};l.toString=function(){return`Your browser doesn’t support SVG. Falling down to VML.
You are running Raphaël `+this.version};var it,Et=function(d,c,y){for(var S=k(c).toLowerCase().split("-"),_=y?"end":"start",C=S.length,z="classic",B="medium",G="medium";C--;)switch(S[C]){case"block":case"classic":case"oval":case"diamond":case"open":case"none":z=S[C];break;case"wide":case"narrow":G=S[C];break;case"long":case"short":B=S[C]}var j=d.node.getElementsByTagName("stroke")[0];j[_+"arrow"]=z,j[_+"arrowlength"]=B,j[_+"arrowwidth"]=G},Dt=function(d,c){d.attrs=d.attrs||{};var y=d.node,S=d.attrs,_=y.style,C=wt[d.type]&&(c.x!=S.x||c.y!=S.y||c.width!=S.width||c.height!=S.height||c.cx!=S.cx||c.cy!=S.cy||c.rx!=S.rx||c.ry!=S.ry||c.r!=S.r),z=at[d.type]&&(S.cx!=c.cx||S.cy!=c.cy||S.r!=c.r||S.rx!=c.rx||S.ry!=c.ry),B=d;for(var G in c)c[o](G)&&(S[G]=c[G]);if(C&&(S.path=l._getPath[d.type](d),d._.dirty=1),c.href&&(y.href=c.href),c.title&&(y.title=c.title),c.target&&(y.target=c.target),c.cursor&&(_.cursor=c.cursor),"blur"in c&&d.blur(c.blur),(c.path&&d.type=="path"||C)&&(y.path=function(Rt){var Zt=/[ahqstv]/gi,de=l._pathToAbsolute;if(k(Rt).match(Zt)&&(de=l._path2curve),Zt=/[clmz]/g,de==l._pathToAbsolute&&!k(Rt).match(Zt)){var Yt=k(Rt).replace(rt,function(si,fe,ge){var Jt=[],Ie=fe.toLowerCase()=="m",re=ct[fe];return ge.replace(Y,function(Me){Ie&&Jt.length==2&&(re+=Jt+ct[fe=="m"?"l":"L"],Jt=[]),Jt.push(W(Me*nt))}),re+Jt});return Yt}var ue,Vt,Ee=de(Rt);Yt=[];for(var pe=0,_e=Ee.length;pe<_e;pe++){ue=Ee[pe],(Vt=Ee[pe][0].toLowerCase())=="z"&&(Vt="x");for(var Qt=1,zt=ue.length;Qt<zt;Qt++)Vt+=W(ue[Qt]*nt)+(Qt!=zt-1?",":R);Yt.push(Vt)}return Yt.join(U)}(~k(S.path).toLowerCase().indexOf("r")?l._pathToAbsolute(S.path):S.path),d._.dirty=1,d.type=="image"&&(d._.fillpos=[S.x,S.y],d._.fillsize=[S.width,S.height],st(d,1,1,0,0,0))),"transform"in c&&d.transform(c.transform),z){var j=+S.cx,et=+S.cy,gt=+S.rx||+S.r||0,yt=+S.ry||+S.r||0;y.path=l.format("ar{0},{1},{2},{3},{4},{1},{4},{1}x",W((j-gt)*nt),W((et-yt)*nt),W((j+gt)*nt),W((et+yt)*nt),W(j*nt)),d._.dirty=1}if("clip-rect"in c){var vt=k(c["clip-rect"]).split(J);if(vt.length==4){vt[2]=+vt[2]+ +vt[0],vt[3]=+vt[3]+ +vt[1];var kt=y.clipRect||l._g.doc.createElement("div"),Nt=kt.style;Nt.clip=l.format("rect({1}px {2}px {3}px {0}px)",vt),y.clipRect||(Nt.position="absolute",Nt.top=0,Nt.left=0,Nt.width=d.paper.width+"px",Nt.height=d.paper.height+"px",y.parentNode.insertBefore(kt,y),kt.appendChild(y),y.clipRect=kt)}c["clip-rect"]||y.clipRect&&(y.clipRect.style.clip="auto")}if(d.textpath){var St=d.textpath.style;c.font&&(St.font=c.font),c["font-family"]&&(St.fontFamily='"'+c["font-family"].split(",")[0].replace(/^['"]+|['"]+$/g,R)+'"'),c["font-size"]&&(St.fontSize=c["font-size"]),c["font-weight"]&&(St.fontWeight=c["font-weight"]),c["font-style"]&&(St.fontStyle=c["font-style"])}if("arrow-start"in c&&Et(B,c["arrow-start"]),"arrow-end"in c&&Et(B,c["arrow-end"],1),c.opacity!=null||c.fill!=null||c.src!=null||c.stroke!=null||c["stroke-width"]!=null||c["stroke-opacity"]!=null||c["fill-opacity"]!=null||c["stroke-dasharray"]!=null||c["stroke-miterlimit"]!=null||c["stroke-linejoin"]!=null||c["stroke-linecap"]!=null){var ht=y.getElementsByTagName("fill");if(!(ht=ht&&ht[0])&&(ht=it("fill")),d.type=="image"&&c.src&&(ht.src=c.src),c.fill&&(ht.on=!0),ht.on!=null&&c.fill!="none"&&c.fill!==null||(ht.on=!1),ht.on&&c.fill){var It=k(c.fill).match(l._ISURL);if(It){ht.parentNode==y&&y.removeChild(ht),ht.rotate=!0,ht.src=It[1],ht.type="tile";var Tt=d.getBBox(1);ht.position=Tt.x+U+Tt.y,d._.fillpos=[Tt.x,Tt.y],l._preload(It[1],function(){d._.fillsize=[this.offsetWidth,this.offsetHeight]})}else ht.color=l.getRGB(c.fill).hex,ht.src=R,ht.type="solid",l.getRGB(c.fill).error&&(B.type in{circle:1,ellipse:1}||k(c.fill).charAt()!="r")&&Lt(B,c.fill,ht)&&(S.fill="none",S.gradient=c.fill,ht.rotate=!1)}if("fill-opacity"in c||"opacity"in c){var Mt=((+S["fill-opacity"]+1||2)-1)*((+S.opacity+1||2)-1)*((+l.getRGB(c.fill).o+1||2)-1);Mt=Q(lt(Mt,0),1),ht.opacity=Mt,ht.src&&(ht.color="none")}y.appendChild(ht);var Bt=y.getElementsByTagName("stroke")&&y.getElementsByTagName("stroke")[0],Ft=!1;!Bt&&(Ft=Bt=it("stroke")),(c.stroke&&c.stroke!="none"||c["stroke-width"]||c["stroke-opacity"]!=null||c["stroke-dasharray"]||c["stroke-miterlimit"]||c["stroke-linejoin"]||c["stroke-linecap"])&&(Bt.on=!0),(c.stroke=="none"||c.stroke===null||Bt.on==null||c.stroke==0||c["stroke-width"]==0)&&(Bt.on=!1);var Pt=l.getRGB(c.stroke);Bt.on&&c.stroke&&(Bt.color=Pt.hex),Mt=((+S["stroke-opacity"]+1||2)-1)*((+S.opacity+1||2)-1)*((+Pt.o+1||2)-1);var Ut=.75*(N(c["stroke-width"])||1);if(Mt=Q(lt(Mt,0),1),c["stroke-width"]==null&&(Ut=S["stroke-width"]),c["stroke-width"]&&(Bt.weight=Ut),Ut&&Ut<1&&(Mt*=Ut)&&(Bt.weight=1),Bt.opacity=Mt,c["stroke-linejoin"]&&(Bt.joinstyle=c["stroke-linejoin"]||"miter"),Bt.miterlimit=c["stroke-miterlimit"]||8,c["stroke-linecap"]&&(Bt.endcap=c["stroke-linecap"]=="butt"?"flat":c["stroke-linecap"]=="square"?"square":"round"),"stroke-dasharray"in c){var we={"-":"shortdash",".":"shortdot","-.":"shortdashdot","-..":"shortdashdotdot",". ":"dot","- ":"dash","--":"longdash","- .":"dashdot","--.":"longdashdot","--..":"longdashdotdot"};Bt.dashstyle=we[o](c["stroke-dasharray"])?we[c["stroke-dasharray"]]:R}Ft&&y.appendChild(Bt)}if(B.type=="text"){B.paper.canvas.style.display=R;var Kt=B.paper.span,he=S.font&&S.font.match(/\d+(?:\.\d*)?(?=px)/);_=Kt.style,S.font&&(_.font=S.font),S["font-family"]&&(_.fontFamily=S["font-family"]),S["font-weight"]&&(_.fontWeight=S["font-weight"]),S["font-style"]&&(_.fontStyle=S["font-style"]),he=N(S["font-size"]||he&&he[0])||10,_.fontSize=100*he+"px",B.textpath.string&&(Kt.innerHTML=k(B.textpath.string).replace(/</g,"&#60;").replace(/&/g,"&#38;").replace(/\n/g,"<br>"));var le=Kt.getBoundingClientRect();B.W=S.w=(le.right-le.left)/100,B.H=S.h=(le.bottom-le.top)/100,B.X=S.x,B.Y=S.y+B.H/2,("x"in c||"y"in c)&&(B.path.v=l.format("m{0},{1}l{2},{1}",W(S.x*nt),W(S.y*nt),W(S.x*nt)+1));for(var Se=["x","y","text","font","font-family","font-weight","font-style","font-size"],ce=0,Te=Se.length;ce<Te;ce++)if(Se[ce]in c){B._.dirty=1;break}switch(S["text-anchor"]){case"start":B.textpath.style["v-text-align"]="left",B.bbx=B.W/2;break;case"end":B.textpath.style["v-text-align"]="right",B.bbx=-B.W/2;break;default:B.textpath.style["v-text-align"]="center",B.bbx=0}B.textpath.style["v-text-kern"]=!0}},Lt=function(d,c,y){d.attrs=d.attrs||{},d.attrs;var S=Math.pow,_="linear",C=".5 .5";if(d.attrs.gradient=c,c=(c=k(c).replace(l._radial_gradient,function(gt,yt,vt){return _="radial",yt&&vt&&(yt=N(yt),vt=N(vt),S(yt-.5,2)+S(vt-.5,2)>.25&&(vt=V.sqrt(.25-S(yt-.5,2))*(2*(vt>.5)-1)+.5),C=yt+U+vt),R})).split(/\s*\-\s*/),_=="linear"){var z=c.shift();if(z=-N(z),isNaN(z))return null}var B=l._parseDots(c);if(!B)return null;if(d=d.shape||d.node,B.length){d.removeChild(y),y.on=!0,y.method="none",y.color=B[0].color,y.color2=B[B.length-1].color;for(var G=[],j=0,et=B.length;j<et;j++)B[j].offset&&G.push(B[j].offset+U+B[j].color);y.colors=G.length?G.join():"0% "+y.color,_=="radial"?(y.type="gradientTitle",y.focus="100%",y.focussize="0 0",y.focusposition=C,y.angle=0):(y.type="gradient",y.angle=(270-z)%360),d.appendChild(y)}return 1},ft=function(d,c){this[0]=this.node=d,d.raphael=!0,this.id=l._oid++,d.raphaelid=this.id,this.X=0,this.Y=0,this.attrs={},this.paper=c,this.matrix=l.matrix(),this._={transform:[],sx:1,sy:1,dx:0,dy:0,deg:0,dirty:1,dirtyT:1},!c.bottom&&(c.bottom=this),this.prev=c.top,c.top&&(c.top.next=this),c.top=this,this.next=null},mt=l.el;ft.prototype=mt,mt.constructor=ft,mt.transform=function(d){if(d==null)return this._.transform;var c,y=this.paper._viewBoxShift,S=y?"s"+[y.scale,y.scale]+"-1-1t"+[y.dx,y.dy]:R;y&&(c=d=k(d).replace(/\.{3}|\u2026/g,this._.transform||R)),l._extractTransform(this,S+d);var _,C=this.matrix.clone(),z=this.skew,B=this.node,G=~k(this.attrs.fill).indexOf("-"),j=!k(this.attrs.fill).indexOf("url(");if(C.translate(1,1),j||G||this.type=="image")if(z.matrix="1 0 0 1",z.offset="0 0",_=C.split(),G&&_.noRotation||!_.isSimple){B.style.filter=C.toFilter();var et=this.getBBox(),gt=this.getBBox(1),yt=et.x-gt.x,vt=et.y-gt.y;B.coordorigin=yt*-nt+U+vt*-nt,st(this,1,1,yt,vt,0)}else B.style.filter=R,st(this,_.scalex,_.scaley,_.dx,_.dy,_.rotate);else B.style.filter=R,z.matrix=k(C),z.offset=C.offset();return c!==null&&(this._.transform=c,l._extractTransform(this,c)),this},mt.rotate=function(d,c,y){if(this.removed)return this;if(d!=null){if((d=k(d).split(J)).length-1&&(c=N(d[1]),y=N(d[2])),d=N(d[0]),y==null&&(c=y),c==null||y==null){var S=this.getBBox(1);c=S.x+S.width/2,y=S.y+S.height/2}return this._.dirtyT=1,this.transform(this._.transform.concat([["r",d,c,y]])),this}},mt.translate=function(d,c){return this.removed?this:((d=k(d).split(J)).length-1&&(c=N(d[1])),d=N(d[0])||0,c=+c||0,this._.bbox&&(this._.bbox.x+=d,this._.bbox.y+=c),this.transform(this._.transform.concat([["t",d,c]])),this)},mt.scale=function(d,c,y,S){if(this.removed)return this;if((d=k(d).split(J)).length-1&&(c=N(d[1]),y=N(d[2]),S=N(d[3]),isNaN(y)&&(y=null),isNaN(S)&&(S=null)),d=N(d[0]),c==null&&(c=d),S==null&&(y=S),y==null||S==null)var _=this.getBBox(1);return y=y??_.x+_.width/2,S=S??_.y+_.height/2,this.transform(this._.transform.concat([["s",d,c,y,S]])),this._.dirtyT=1,this},mt.hide=function(){return!this.removed&&(this.node.style.display="none"),this},mt.show=function(){return!this.removed&&(this.node.style.display=R),this},mt.auxGetBBox=l.el.getBBox,mt.getBBox=function(){var d=this.auxGetBBox();if(this.paper&&this.paper._viewBoxShift){var c={},y=1/this.paper._viewBoxShift.scale;return c.x=d.x-this.paper._viewBoxShift.dx,c.x*=y,c.y=d.y-this.paper._viewBoxShift.dy,c.y*=y,c.width=d.width*y,c.height=d.height*y,c.x2=c.x+c.width,c.y2=c.y+c.height,c}return d},mt._getBBox=function(){return this.removed?{}:{x:this.X+(this.bbx||0)-this.W/2,y:this.Y-this.H,width:this.W,height:this.H}},mt.remove=function(){if(!this.removed&&this.node.parentNode){for(var d in this.paper.__set__&&this.paper.__set__.exclude(this),l.eve.unbind("raphael.*.*."+this.id),l._tear(this,this.paper),this.node.parentNode.removeChild(this.node),this.shape&&this.shape.parentNode.removeChild(this.shape),this)this[d]=typeof this[d]=="function"?l._removedFactory(d):null;this.removed=!0}},mt.attr=function(d,c){if(this.removed)return this;if(d==null){var y={};for(var S in this.attrs)this.attrs[o](S)&&(y[S]=this.attrs[S]);return y.gradient&&y.fill=="none"&&(y.fill=y.gradient)&&delete y.gradient,y.transform=this._.transform,y}if(c==null&&l.is(d,"string")){if(d=="fill"&&this.attrs.fill=="none"&&this.attrs.gradient)return this.attrs.gradient;for(var _=d.split(J),C={},z=0,B=_.length;z<B;z++)(d=_[z])in this.attrs?C[d]=this.attrs[d]:l.is(this.paper.customAttributes[d],"function")?C[d]=this.paper.customAttributes[d].def:C[d]=l._availableAttrs[d];return B-1?C:C[_[0]]}if(this.attrs&&c==null&&l.is(d,"array")){for(C={},z=0,B=d.length;z<B;z++)C[d[z]]=this.attr(d[z]);return C}var G;for(var j in c!=null&&((G={})[d]=c),c==null&&l.is(d,"object")&&(G=d),G)Ct("raphael.attr."+j+"."+this.id,this,G[j]);if(G){for(j in this.paper.customAttributes)if(this.paper.customAttributes[o](j)&&G[o](j)&&l.is(this.paper.customAttributes[j],"function")){var et=this.paper.customAttributes[j].apply(this,[].concat(G[j]));for(var gt in this.attrs[j]=G[j],et)et[o](gt)&&(G[gt]=et[gt])}G.text&&this.type=="text"&&(this.textpath.string=G.text),Dt(this,G)}return this},mt.toFront=function(){return!this.removed&&this.node.parentNode.appendChild(this.node),this.paper&&this.paper.top!=this&&l._tofront(this,this.paper),this},mt.toBack=function(){return this.removed?this:(this.node.parentNode.firstChild!=this.node&&(this.node.parentNode.insertBefore(this.node,this.node.parentNode.firstChild),l._toback(this,this.paper)),this)},mt.insertAfter=function(d){return this.removed?this:(d.constructor==l.st.constructor&&(d=d[d.length-1]),d.node.nextSibling?d.node.parentNode.insertBefore(this.node,d.node.nextSibling):d.node.parentNode.appendChild(this.node),l._insertafter(this,d,this.paper),this)},mt.insertBefore=function(d){return this.removed?this:(d.constructor==l.st.constructor&&(d=d[0]),d.node.parentNode.insertBefore(this.node,d.node),l._insertbefore(this,d,this.paper),this)},mt.blur=function(d){var c=this.node.runtimeStyle,y=c.filter;return y=y.replace(pt,R),+d!=0?(this.attrs.blur=d,c.filter=y+U+" progid:DXImageTransform.Microsoft.Blur(pixelradius="+(+d||1.5)+")",c.margin=l.format("-{0}px 0 0 -{0}px",W(+d||1.5))):(c.filter=y,c.margin=0,delete this.attrs.blur),this},l._engine.path=function(d,c){var y=it("shape");y.style.cssText=tt,y.coordsize=nt+U+nt,y.coordorigin=c.coordorigin;var S=new ft(y,c),_={fill:"none",stroke:"#000"};d&&(_.path=d),S.type="path",S.path=[],S.Path=R,Dt(S,_),c.canvas&&c.canvas.appendChild(y);var C=it("skew");return C.on=!0,y.appendChild(C),S.skew=C,S.transform(R),S},l._engine.rect=function(d,c,y,S,_,C){var z=l._rectPath(c,y,S,_,C),B=d.path(z),G=B.attrs;return B.X=G.x=c,B.Y=G.y=y,B.W=G.width=S,B.H=G.height=_,G.r=C,G.path=z,B.type="rect",B},l._engine.ellipse=function(d,c,y,S,_){var C=d.path();return C.attrs,C.X=c-S,C.Y=y-_,C.W=2*S,C.H=2*_,C.type="ellipse",Dt(C,{cx:c,cy:y,rx:S,ry:_}),C},l._engine.circle=function(d,c,y,S){var _=d.path();return _.attrs,_.X=c-S,_.Y=y-S,_.W=_.H=2*S,_.type="circle",Dt(_,{cx:c,cy:y,r:S}),_},l._engine.image=function(d,c,y,S,_,C){var z=l._rectPath(y,S,_,C),B=d.path(z).attr({stroke:"none"}),G=B.attrs,j=B.node,et=j.getElementsByTagName("fill")[0];return G.src=c,B.X=G.x=y,B.Y=G.y=S,B.W=G.width=_,B.H=G.height=C,G.path=z,B.type="image",et.parentNode==j&&j.removeChild(et),et.rotate=!0,et.src=c,et.type="tile",B._.fillpos=[y,S],B._.fillsize=[_,C],j.appendChild(et),st(B,1,1,0,0,0),B},l._engine.text=function(d,c,y,S){var _=it("shape"),C=it("path"),z=it("textpath");c=c||0,y=y||0,S=S||"",C.v=l.format("m{0},{1}l{2},{1}",W(c*nt),W(y*nt),W(c*nt)+1),C.textpathok=!0,z.string=k(S),z.on=!0,_.style.cssText=tt,_.coordsize=nt+U+nt,_.coordorigin="0 0";var B=new ft(_,d),G={fill:"#000",stroke:"none",font:l._availableAttrs.font,text:S};B.shape=_,B.path=C,B.textpath=z,B.type="text",B.attrs.text=k(S),B.attrs.x=c,B.attrs.y=y,B.attrs.w=1,B.attrs.h=1,Dt(B,G),_.appendChild(z),_.appendChild(C),d.canvas.appendChild(_);var j=it("skew");return j.on=!0,_.appendChild(j),B.skew=j,B.transform(R),B},l._engine.setSize=function(d,c){var y=this.canvas.style;return this.width=d,this.height=c,d==+d&&(d+="px"),c==+c&&(c+="px"),y.width=d,y.height=c,y.clip="rect(0 "+d+" "+c+" 0)",this._viewBox&&l._engine.setViewBox.apply(this,this._viewBox),this},l._engine.setViewBox=function(d,c,y,S,_){l.eve("raphael.setViewBox",this,this._viewBox,[d,c,y,S,_]);var C,z,B=this.getSize(),G=B.width,j=B.height;return _&&(y*(C=j/S)<G&&(d-=(G-y*C)/2/C),S*(z=G/y)<j&&(c-=(j-S*z)/2/z)),this._viewBox=[d,c,y,S,!!_],this._viewBoxShift={dx:-d,dy:-c,scale:B},this.forEach(function(et){et.transform("...")}),this},l._engine.initWin=function(d){var c=d.document;c.styleSheets.length<31?c.createStyleSheet().addRule(".rvml","behavior:url(#default#VML)"):c.styleSheets[0].addRule(".rvml","behavior:url(#default#VML)");try{!c.namespaces.rvml&&c.namespaces.add("rvml","urn:schemas-microsoft-com:vml"),it=function(y){return c.createElement("<rvml:"+y+' class="rvml">')}}catch{it=function(S){return c.createElement("<"+S+' xmlns="urn:schemas-microsoft.com:vml" class="rvml">')}}},l._engine.initWin(l._g.win),l._engine.create=function(){var d=l._getContainer.apply(0,arguments),c=d.container,y=d.height,S=d.width,_=d.x,C=d.y;if(!c)throw new Error("VML container not found.");var z=new l._Paper,B=z.canvas=l._g.doc.createElement("div"),G=B.style;return _=_||0,C=C||0,S=S||512,y=y||342,z.width=S,z.height=y,S==+S&&(S+="px"),y==+y&&(y+="px"),z.coordsize=216e5+U+216e5,z.coordorigin="0 0",z.span=l._g.doc.createElement("span"),z.span.style.cssText="position:absolute;left:-9999em;top:-9999em;padding:0;margin:0;line-height:1;",B.appendChild(z.span),G.cssText=l.format("top:0;left:0;width:{0};height:{1};display:inline-block;position:relative;clip:rect(0 {0} {1} 0);overflow:hidden",S,y),c==1?(l._g.doc.body.appendChild(B),G.left=_+"px",G.top=C+"px",G.position="absolute"):c.firstChild?c.insertBefore(B,c.firstChild):c.appendChild(B),z.renderfix=function(){},z},l.prototype.clear=function(){l.eve("raphael.clear",this),this.canvas.innerHTML=R,this.span=l._g.doc.createElement("span"),this.span.style.cssText="position:absolute;left:-9999em;top:-9999em;padding:0;margin:0;line-height:1;display:inline;",this.canvas.appendChild(this.span),this.bottom=this.top=null},l.prototype.remove=function(){for(var d in l.eve("raphael.remove",this),this.canvas.parentNode.removeChild(this.canvas),this)this[d]=typeof this[d]=="function"?l._removedFactory(d):null;return!0};var Wt=l.st;for(var f in mt)mt[o](f)&&!Wt[o](f)&&(Wt[f]=function(d){return function(){var c=arguments;return this.forEach(function(y){y[d].apply(y,c)})}}(f))}}.apply(h,g))===void 0||(s.exports=w)}])})})(Pr);const $i=ur(Qe);class zr{constructor(e){b(this,"startX",0);b(this,"startY",0);b(this,"isInit",!1);b(this,"rectShape",null);this.paper=e}init(e,s){this.startX=e,this.startY=s,this.isInit=!0}resize(e,s){if(!this.isInit)return;const{startX:h,startY:u}=this,g=h<e?h:e,w=u<s?u:s,l=Math.abs(h-e),o=Math.abs(u-s);this.rectShape===null?(this.rectShape=this.paper.rect(g,w,l,o),this.rectShape.attr({stroke:"#73a1bf",fill:"rgba(153,124,255,0.1)",opacity:.8})):this.rectShape.attr({x:g,y:w,width:l,height:o})}hide(){var e;this.isInit=!1,(e=this.rectShape)==null||e.remove(),this.rectShape=null}getBBox(){var e;return(e=this.rectShape)==null?void 0:e.getBBox()}}const ki=2;class Hr{constructor({paperWrapper:e,viewport:s,toolOperation:h,selection:u}){b(this,"multiSelectShape");b(this,"viewport");b(this,"selection");b(this,"svgDom");b(this,"toolOperation");b(this,"allNodes",[]);b(this,"preSelectNodes",[]);b(this,"able",!0);b(this,"isStart",!1);b(this,"isMoveInited",!1);b(this,"lastClientX",0);b(this,"lastClientY",0);b(this,"handleMousedown",e=>{this.able&&(this.isStart=!0,this.lastClientX=e.clientX,this.lastClientY=e.clientY,this.selection.empty())});b(this,"handleMousemove",e=>{if(!this.isStart)return;const{clientX:s,clientY:h}=e,u=this.lastClientX-s,g=this.lastClientY-h;if(!this.isMoveInited&&(Math.abs(u)>ki||Math.abs(g)>ki)){const w=this.viewport.getViewportPosition(e.clientX,e.clientY);this.multiSelectShape.init(w.x,w.y);const l=this.toolOperation.getNodeMap();this.allNodes=Object.keys(l).map(o=>l[o]),this.isMoveInited=!0}if(this.isMoveInited){const w=this.viewport.getViewportPosition(e.clientX,e.clientY);this.multiSelectShape.resize(w.x,w.y);const l=this.allNodes.filter(k=>$i.isBBoxIntersect(this.multiSelectShape.getBBox(),k.getBBox()))||[],o=[];for(let k=0;k<this.preSelectNodes.length;k++)l.includes(this.preSelectNodes[k])&&o.push(this.preSelectNodes[k]);for(let k=0;k<l.length;k++)o.includes(l[k])||o.push(l[k]);this.selection.select(o),this.preSelectNodes=o}this.lastClientX=s,this.lastClientY=h});b(this,"handleMouseup",()=>{this.isStart&&(this.multiSelectShape.hide(),this.allNodes=[],this.preSelectNodes=[],this.isStart=!1,this.isMoveInited=!1,this.lastClientX=0,this.lastClientY=0)});var w,l,o;const g=e.getPaper();this.svgDom=e.getSvgDom(),this.multiSelectShape=new zr(g),this.viewport=s,this.selection=u,this.toolOperation=h,(w=this.svgDom)==null||w.addEventListener("mousedown",this.handleMousedown),(l=this.svgDom)==null||l.addEventListener("mousemove",this.handleMousemove),(o=this.svgDom)==null||o.addEventListener("mouseup",this.handleMouseup)}disable(){this.able=!1}enable(){this.able=!0}clear(){var e,s,h;(e=this.svgDom)==null||e.removeEventListener("mousedown",this.handleMousedown),(s=this.svgDom)==null||s.removeEventListener("mousemove",this.handleMousemove),(h=this.svgDom)==null||h.removeEventListener("mouseup",this.handleMouseup)}}class Fr{constructor(){b(this,"allKeydownCallback");b(this,"allKeyupCallback");b(this,"allKeypressCallback");b(this,"keydownCallbacks",[]);b(this,"keyupCallbacks",[]);b(this,"keypressCallbacks",[]);this.allKeydownCallback=e=>{this.keydownCallbacks.forEach(s=>s(e))},document.addEventListener("keydown",this.allKeydownCallback),this.allKeyupCallback=e=>{this.keyupCallbacks.forEach(s=>s(e))},document.addEventListener("keyup",this.allKeyupCallback),this.allKeypressCallback=e=>{this.keypressCallbacks.forEach(s=>s(e))},document.addEventListener("keypress",this.allKeypressCallback)}on(e,s){e==="keydown"?this.keydownCallbacks.push(s):e==="keyup"?this.keyupCallbacks.push(s):e==="keypress"&&this.keypressCallbacks.push(s)}off(e,s){e==="keydown"?this.removeCallback(this.keydownCallbacks,s):e==="keyup"?this.removeCallback(this.keyupCallbacks,s):e==="keypress"&&this.removeCallback(this.keypressCallbacks,s)}clear(){document.removeEventListener("keydown",this.allKeydownCallback),document.removeEventListener("keyup",this.allKeyupCallback),document.removeEventListener("keypress",this.allKeypressCallback)}removeCallback(e,s){const h=e.findIndex(u=>u===s);h>-1&&e.splice(h,1)}}class Or{constructor({toolOperation:e,textEditor:s,selection:h,multiSelect:u,viewportInteraction:g}){b(this,"keyboardEvents");this.keyboardEvents=new Fr,this.keyboardEvents.on("keydown",w=>{const{key:l,ctrlKey:o,shiftKey:k,metaKey:N}=w;if(s.isShowing()){switch(l){case"Tab":case"Enter":{s.finishEdit();break}}return}if(N)if(k)switch(l){case"z":{e.redo();break}}else switch(l){case"z":{e.undo();break}case"=":{w.preventDefault(),g.zoomIn();break}case"-":{w.preventDefault(),g.zoomOut();break}case"Meta":{h.setIsMultiClickMode(!0),u.disable(),g.enableBackgroundDrag(),g.enableMoveScale();break}}else switch(l){case"Enter":{e.addBrotherNode();break}case"Tab":{h.getSelectNodes().length>0&&w.preventDefault(),e.addChildNode();break}case"Backspace":{e.removeNode();break}case"ArrowUp":case"ArrowRight":case"ArrowDown":case"ArrowLeft":{h.selectArrowNext(l);break}}}),this.keyboardEvents.on("keyup",w=>{switch(w.key){case"Meta":{h.setIsMultiClickMode(!1),u.enable(),g.disableBackgroundDrag(),g.disableMoveScale();break}}})}clear(){this.keyboardEvents.clear()}}const Yi="mindmap-graph";class $r{constructor(e){b(this,"containerDom");b(this,"wrapperDom");b(this,"svgDom");b(this,"paper");const s=this.initGraphElement(e);this.containerDom=s.containerDom,this.wrapperDom=s.wrapperDom;const{clientWidth:h,clientHeight:u}=this.wrapperDom;this.paper=new $i(this.wrapperDom,h,u),this.svgDom=document.querySelector("svg")||null}getPaper(){return this.paper}getWrapperDom(){return this.wrapperDom}getContainerDom(){return this.containerDom}getSvgDom(){return this.svgDom}getSize(){return{width:this.wrapperDom.clientWidth,height:this.wrapperDom.clientHeight}}clear(){this.paper.clear(),this.wrapperDom.remove()}initGraphElement(e){const s=typeof e=="string"?document.querySelector(e):e;if(console.log("containerDom---",s),!s)throw new Error("container is not exist");if(s.clientWidth===0||s.clientHeight===0)throw new Error("The width or height of Container is not more than 0");const h=document.createElement("div");h.className="mindmap-graph-background";const u=document.createElement("div");return u.className=Yi,s.appendChild(u),s.appendChild(h),{containerDom:s,wrapperDom:u}}}const Yr=100;class Gr{constructor(){b(this,"past",[]);b(this,"future",[])}add(e){this.past.length>=Yr&&this.past.shift(),this.past.push(JSON.stringify(e)),this.future=[]}canUndo(){return this.past.length>0}canRedo(){return this.future.length>0}undo(e){return this.canUndo()?(this.future.unshift(JSON.stringify(e)),JSON.parse(this.past.pop())):null}redo(e){return this.canRedo()?(this.past.push(JSON.stringify(e)),JSON.parse(this.future.shift())):null}}const Gi=T=>{const e=T||{[ei()]:{children:[],label:"中心主题",direction:bt.NONE,isRoot:!0}};return Object.keys(e).forEach(s=>{const h=e[s].isExpand;e[s].isExpand=h===void 0?!0:h}),e};class Vr{constructor({data:e,selection:s,root:h}){b(this,"snapshot");b(this,"selection");b(this,"root");b(this,"eventEmitter");b(this,"data");b(this,"canUndo",()=>this.snapshot.canUndo());b(this,"canRedo",()=>this.snapshot.canRedo());b(this,"getData",()=>this.data);this.snapshot=new Gr,this.root=h,this.selection=s,this.data=Gi(e),this.eventEmitter=new ie}undo(){if(!this.snapshot.canUndo())return null;const e=this.snapshot.undo({data:this.data,selectIds:this.selection.getSelectIds()});return this.data=e.data,this.eventEmitter.emit("changeData"),e}redo(){if(!this.snapshot.canRedo())return null;const e=this.snapshot.redo({data:this.data,selectIds:this.selection.getSelectIds()});return this.data=e.data,this.eventEmitter.emit("changeData"),e}on(e,s){this.eventEmitter.on(e,s)}setData(e,s,h){this.data[e]&&(this.addSnapshot(h),this.data[e]={...this.data[e],...s},console.log("set data",this.data))}resetData(){const e={};this.resetDataInner(this.root,e),this.data=e,console.log("reset data",this.data)}addSnapshot(e){this.snapshot.add({data:this.data,selectIds:e||this.selection.getSelectIds()}),this.eventEmitter.emit("changeData")}resetDataInner(e,s){s[e.id]={children:e.children.map(h=>h.id),label:e.label,direction:e.direction,isRoot:e.isRoot(),isExpand:e.isExpand},e.children.forEach(h=>{this.resetDataInner(h,s)})}}class Xr{constructor(e,s=""){b(this,"dom");typeof e=="string"?(this.dom=document.createElement(e),this.dom.className=s):this.dom=e}getDom(){return this.dom}setChildren(...e){return e.forEach(s=>this.setChild(s)),this}setChild(e){const s=typeof e=="string"?document.createTextNode(e):e.dom;return this.dom.appendChild(s),this}setClassName(e){return this.dom.className=e,this}addClass(e){return this.dom.classList.add(e),this}hasClass(e){return this.dom.classList.contains(e)}removeClass(e){return this.dom.classList.remove(e),this}setHtml(e){return this.dom.innerHTML=e,this}setCss(e){return Object.keys(e).forEach(s=>{this.dom.style[s]=e[s]}),this}addEventListener(...e){this.dom.addEventListener(...e)}removeEventListener(...e){this.dom.removeEventListener(...e)}}const Gt=(T,e="")=>new Xr(T,e),ae=({iconName:T,tipLabel:e,isDisabled:s=!0})=>{const h=Gt("div",`toolbar-btn${s?" disabled":""}`).setChild(Gt("div",`toolbar-icon ${T}-icon`));return{el:Gt("div","toolbar-item").setChildren(h,Gt("div","toolbar-tip").setChild(e)),btnEl:h}};class Wr{constructor({dataProxy:e,toolOperation:s}){b(this,"el");b(this,"btnEl");b(this,"toolOperation");b(this,"dataProxy");this.dataProxy=e,this.toolOperation=s;const h=this.element();this.el=h.el,this.btnEl=h.btnEl}setState(){this.dataProxy.canUndo()?this.btnEl.removeClass("disabled"):this.btnEl.addClass("disabled")}element(){const{el:e,btnEl:s}=ae({iconName:"undo",tipLabel:"撤销"});return s.addEventListener("click",()=>{this.toolOperation.undo()},!1),{el:e,btnEl:s}}}class jr{constructor({toolOperation:e,dataProxy:s}){b(this,"el");b(this,"btnEl");b(this,"dataProxy");b(this,"toolOperation");this.toolOperation=e,this.dataProxy=s;const h=this.element();this.el=h.el,this.btnEl=h.btnEl}setState(){this.dataProxy.canRedo()?this.btnEl.removeClass("disabled"):this.btnEl.addClass("disabled")}element(){const{el:e,btnEl:s}=ae({iconName:"redo",tipLabel:"重做"});return s.addEventListener("click",()=>{this.toolOperation.redo()},!1),{el:e,btnEl:s}}}let qr=class{constructor({toolOperation:e,selection:s}){b(this,"el");b(this,"btnEl");b(this,"toolOperation");b(this,"selection");this.toolOperation=e,this.selection=s;const h=this.element();this.el=h.el,this.btnEl=h.btnEl}setState(){this.selection.getSelectNodes().length===1?this.btnEl.removeClass("disabled"):this.btnEl.addClass("disabled")}element(){const{el:e,btnEl:s}=ae({iconName:"add-child",tipLabel:"添加子主题"});return s.addEventListener("click",()=>{this.toolOperation.addChildNode()},!1),{el:e,btnEl:s}}};class Ur{constructor({toolOperation:e,selection:s}){b(this,"el");b(this,"btnEl");b(this,"toolOperation");b(this,"selection");this.toolOperation=e,this.selection=s;const h=this.element();this.el=h.el,this.btnEl=h.btnEl}setState(){this.selection.getSelectNodes().length===1?this.btnEl.removeClass("disabled"):this.btnEl.addClass("disabled")}element(){const{el:e,btnEl:s}=ae({iconName:"add-brother",tipLabel:"添加同级节点"});return s.addEventListener("click",()=>{this.toolOperation.addBrotherNode()},!1),{el:e,btnEl:s}}}class Kr{constructor({textEditor:e,selection:s}){b(this,"el");b(this,"btnEl");b(this,"textEditor");b(this,"selection");this.textEditor=e,this.selection=s;const h=this.element();this.el=h.el,this.btnEl=h.btnEl}setState(){this.selection.getSelectNodes().length===1?this.btnEl.removeClass("disabled"):this.btnEl.addClass("disabled")}element(){const{el:e,btnEl:s}=ae({iconName:"edit",tipLabel:"编辑"});return s.addEventListener("click",()=>{this.textEditor.showBySelectionLabel()},!1),{el:e,btnEl:s}}}class Zr{constructor({toolOperation:e,textEditor:s,selection:h}){b(this,"el");b(this,"btnEl");b(this,"toolOperation");b(this,"textEditor");b(this,"selection");this.toolOperation=e,this.textEditor=s,this.selection=h;const u=this.element();this.el=u.el,this.btnEl=u.btnEl}setState(){this.selection.getTopNodes().length>0?this.btnEl.removeClass("disabled"):this.btnEl.addClass("disabled")}element(){const{el:e,btnEl:s}=ae({iconName:"delete",tipLabel:"删除"});return s.addEventListener("click",()=>{this.toolOperation.removeNode()},!1),{el:e,btnEl:s}}}class Qr{constructor({viewportInteraction:e}){b(this,"el");b(this,"btnEl");b(this,"viewportInteraction");this.viewportInteraction=e;const s=this.element();this.el=s.el,this.btnEl=s.btnEl}element(){const{el:e,btnEl:s}=ae({iconName:"target",tipLabel:"定位到中间",isDisabled:!1});return s.addEventListener("click",()=>{this.viewportInteraction.translateToCenter()},!1),{el:e,btnEl:s}}}class Jr{constructor({paperWrapper:e,toolOperation:s,selection:h,dataProxy:u,textEditor:g,viewportInteraction:w}){b(this,"undo");b(this,"redo");b(this,"addChildNode");b(this,"addBrotherNode");b(this,"edit");b(this,"delete");b(this,"target");this.undo=new Wr({toolOperation:s,dataProxy:u}),this.redo=new jr({toolOperation:s,dataProxy:u}),this.addChildNode=new qr({toolOperation:s,selection:h}),this.addBrotherNode=new Ur({toolOperation:s,selection:h}),this.edit=new Kr({textEditor:g,selection:h}),this.delete=new Zr({toolOperation:s,textEditor:g,selection:h}),this.target=new Qr({viewportInteraction:w});const l=[this.undo.el,this.redo.el,this.buildDivider(),this.addChildNode.el,this.addBrotherNode.el,this.buildDivider(),this.edit.el,this.delete.el,this.buildDivider(),this.target.el],o=e.getWrapperDom(),k=Gt("div","toolbar");l.forEach(N=>{k.setChildren(N)}),o.appendChild(k.getDom()),h.on("select",()=>{this.setState()}),u.on("changeData",()=>{this.setState()})}buildDivider(){return Gt("div","toolbar-divider")}setState(){this.undo.setState(),this.redo.setState(),this.addChildNode.setState(),this.addBrotherNode.setState(),this.edit.setState(),this.delete.setState()}}const Ci=2;class ts{constructor(e){b(this,"isStart",!1);b(this,"lastClientX",0);b(this,"lastClientY",0);b(this,"isMoveInited",!1);b(this,"handleMousedown",(e,s)=>{this.isStart=!0,this.lastClientX=e,this.lastClientY=s});b(this,"handleMousemove",(e,s)=>{if(!this.isStart)return;const h=this.lastClientX-e,u=this.lastClientY-s;!this.isMoveInited&&(Math.abs(h)>Ci||Math.abs(u)>Ci)&&(this.isMoveInited=!0),this.isMoveInited&&this.viewport.translate(h,u),this.lastClientX=e,this.lastClientY=s});b(this,"handleMouseup",()=>{this.isStart=!1,this.isMoveInited=!1,this.lastClientX=0,this.lastClientY=0});this.viewport=e}}class es{constructor(e,s){b(this,"isStart",!1);b(this,"start",(e,s,h)=>{h.stopPropagation(),this.isStart=!0,this.dragViewportHandler.handleMousedown.call(this.dragViewportHandler,e,s)});b(this,"move",(e,s,h,u)=>{this.isStart&&this.dragViewportHandler.handleMousemove.call(this.dragViewportHandler,h,u)});b(this,"end",()=>{this.isStart=!1,this.dragViewportHandler.handleMouseup.call(this.dragViewportHandler)});this.root=e,this.dragViewportHandler=s,e.on("drag",this.move,this.start,this.end),this.dragViewportHandler=s}}class is{constructor(e,s){b(this,"able",!1);b(this,"handleMousedown",e=>{this.able&&this.dragViewportHandler.handleMousedown(e.clientX,e.clientY)});b(this,"handleMousemove",e=>{this.dragViewportHandler.handleMousemove(e.clientX,e.clientY)});b(this,"handleMouseup",()=>{this.dragViewportHandler.handleMouseup()});var h,u,g;this.svgDom=e,this.dragViewportHandler=s,this.svgDom=e,(h=this.svgDom)==null||h.addEventListener("mousedown",this.handleMousedown),(u=this.svgDom)==null||u.addEventListener("mousemove",this.handleMousemove),(g=this.svgDom)==null||g.addEventListener("mouseup",this.handleMouseup)}disable(){this.able=!1}enable(){this.able=!0}clear(){var e,s,h;(e=this.svgDom)==null||e.removeEventListener("mousedown",this.handleMousedown),(s=this.svgDom)==null||s.removeEventListener("mousemove",this.handleMousemove),(h=this.svgDom)==null||h.removeEventListener("mouseup",this.handleMouseup)}}class rs{constructor(e,s){b(this,"isMoveZoom",!1);b(this,"wheelCallback",e=>{if(e.preventDefault(),e.stopPropagation(),`${e.deltaY}`.includes(".")||this.isMoveZoom){const u=-Math.floor(e.deltaY)*.02;this.viewport.addScale(u)}else{const u=e.deltaX*.6,g=e.deltaY*.6;this.viewport.translate(u,g)}});this.viewport=e,this.wrapperDom=s,s.addEventListener("wheel",this.wheelCallback)}clear(){this.wrapperDom.removeEventListener("wheel",this.wheelCallback)}enableMoveScale(){this.isMoveZoom=!0}disableMoveScale(){this.isMoveZoom=!1}}class ss{constructor(e,s){b(this,"resizeObserver");b(this,"wrapperDom");const h=e.getWrapperDom(),u=e.getSvgDom();this.wrapperDom=h,this.resizeObserver=new ResizeObserver(g=>{for(const w of g)if(w.target.className.includes(Yi)){const{clientWidth:l,clientHeight:o}=w.target;u==null||u.setAttribute("width",`${l}`),u==null||u.setAttribute("height",`${o}`),s.resize(l,o);break}}),this.resizeObserver.observe(h)}clear(){this.resizeObserver.unobserve(this.wrapperDom)}}const Ni=.25;class ns{constructor(e){b(this,"viewport");b(this,"root");b(this,"dragRoot");b(this,"dragBackground");b(this,"viewportWheel");b(this,"viewportResize");b(this,"disableBackgroundDrag",()=>this.dragBackground.disable());b(this,"enableBackgroundDrag",()=>this.dragBackground.enable());b(this,"enableMoveScale",()=>this.viewportWheel.enableMoveScale());b(this,"disableMoveScale",()=>this.viewportWheel.disableMoveScale());const{paperWrapper:s,viewport:h,root:u}=e;this.viewport=h,this.root=u;const g=this.initDrag(e);this.dragRoot=g.dragRoot,this.dragBackground=g.dragBackground;const w=s.getWrapperDom();this.viewportWheel=new rs(h,w),this.viewportResize=new ss(s,h)}zoomIn(){this.viewport.addScale(Ni)}zoomOut(){this.viewport.addScale(-Ni)}translateToCenter(){const e=this.root.getBBox(),s=this.viewport.getViewbox(),h=e.cx-s.width/2,u=e.cy-s.height/2;this.viewport.translateTo(h,u)}clear(){this.dragBackground.clear(),this.viewportWheel.clear(),this.viewportResize.clear()}initDrag({paperWrapper:e,viewport:s,root:h}){const u=new ts(s),g=e.getSvgDom(),w=new es(h,u),l=new is(g,u);return{dragRoot:w,dragBackground:l}}}const Ye=5,$e=3,Je=2,Bi=Ye*2+Je+3;class os{constructor({paper:e,nodeBBox:s,isExpand:h,direction:u}){b(this,"paper");b(this,"circleShape");b(this,"horizontalShape");b(this,"verticalShape");b(this,"shapeSet");b(this,"shapeEventEmitter");b(this,"isExpand");this.paper=e,this.isExpand=h,this.shapeSet=e.set();const{x:g,y:w}=this.getPosition(s,u);this.circleShape=e.circle(g,w,Ye),this.circleShape.attr({fill:"#fff","fill-opacity":1}),this.circleShape.node.style.cursor="pointer";const{cx:l,cy:o}=this.circleShape.getBBox();this.horizontalShape=e.path([`M${l-$e} ${o}`,`L${l+$e} ${o}`].join(" ")),this.verticalShape=this.paper.path([`M${l} ${o-$e}`,`L${l} ${o+$e}`].join(" ")),this.shapeSet.push(this.circleShape).push(this.horizontalShape).push(this.verticalShape),h&&this.verticalShape.hide(),this.shapeSet.attr({stroke:"#000","stroke-opacity":.7}),this.shapeSet.toFront(),this.shapeEventEmitter=new zi(this.shapeSet),this.initHover()}on(e,...s){this.shapeEventEmitter.on(e,...s)}changeExpand(e){this.isExpand!==e&&(e?this.verticalShape.hide():this.verticalShape.show(),this.isExpand=e)}translateTo(e,s){const{x:h,y:u}=this.getPosition(e,s),{cx:g,cy:w}=this.getBBox(),l=h-g,o=u-w;l===0&&o===0||this.shapeSet.translate(l,o)}getBBox(){return this.circleShape.getBBox()}remove(){this.shapeSet.remove(),this.shapeEventEmitter.removeAllListeners()}setStyle(e){switch(e){case"disable":{this.setStyle("base"),this.shapeSet.attr({opacity:.4});break}case"hover":{this.setStyle("base"),this.circleShape.attr({fill:"#E7E7E7","fill-opacity":1});break}case"base":default:{this.shapeSet.attr({opacity:1}),this.circleShape.attr({fill:"#fff","fill-opacity":1});break}}}getPosition(e,s){let h=0;const u=e.cy;return s===bt.RIGHT?h=e.x2+Ye+Je:h=e.x-Ye-Je,{x:h,y:u}}initHover(){this.shapeEventEmitter.on("hover",()=>{this.setStyle("hover")},()=>{this.setStyle("base")})}}const Vi=({paper:T,sourceBBox:e,targetBBox:s,direction:h})=>{const u=e.cx,g=e.cy,w=h===bt.LEFT?s.x2:s.x,l=s.cy,o=.8,k=.2,N=w-o*(w-u),V=l-k*(l-g);return T.path(`M${u} ${g}Q${N} ${V} ${w} ${l}`)},Xi=({paper:T,sourceBBox:e,targetBBox:s,direction:h,targetDepth:u,hasUnder:g=!1})=>{let w=0,l=0,o=0,k=0,N=0,V=0,W=0,lt=0;h===bt.RIGHT?(w=e.x2,o=w+Bi,N=s.x,W=s.x2):(w=e.x,o=w-Bi,N=s.x2,W=s.x),u===2?l=e.cy:l=e.y2,k=l,V=g?s.y2:s.cy,lt=V;const Q=as(o,k,N,V);let q=`M${w} ${l} L${o} ${k} ${Q}`;return g&&(q+=` M ${N} ${V} L${W} ${lt}`),T.path(q)},as=(T,e,s,h)=>{const w=T+.3*(s-T),l=e+.76*(h-e),o=.5,k=0,N=s-o*(s-T),V=h-k*(h-e);return`M${T} ${e}C${w} ${l} ${N} ${V} ${s} ${h}`},hs=55,ls=14,Ze=50,Di=13,Li=3;class Ti{constructor({paper:e,sourceBBox:s,targetBBox1:h,targetBBox2:u,targetDepth:g,direction:w}){b(this,"paper");b(this,"shapeSet");this.paper=e;const l=h||u,o=g===1?hs:ls;let k=0;if(l!==null)k=w===bt.RIGHT?l.x:l.x2-Ze;else{const Q=Pi(g);k=w===bt.RIGHT?s.x2+Q:s.x-Q-Ze}let N=0;h!==null&&u!==null?N=(u.y+h.y2)/2:h!==null&&u===null?(N=h.y2+o,g>1&&(N+=Li)):h===null&&u!==null?(N=u.y-o,g>1&&(N+=Li)):N=s.cy;const V=N-Di/2,W=this.drawRect({x:k,y:V}),lt=this.drawPath({sourceBBox:s,targetBBox:W.getBBox(),targetDepth:g,direction:w});this.shapeSet=e.set().push(W).push(lt)}remove(){this.shapeSet.remove()}drawRect({x:e,y:s}){const h=this.paper.rect(e,s,Ze,Di,6);return h.attr({fill:"#E74C3C","stroke-opacity":0,opacity:.8}),h}drawPath({sourceBBox:e,targetBBox:s,targetDepth:h,direction:u}){const g=h===1?Vi({paper:this.paper,sourceBBox:e,targetBBox:s,direction:u}):Xi({paper:this.paper,sourceBBox:e,targetBBox:s,direction:u,targetDepth:h});return g.attr({stroke:"#E74C3C","stroke-width":2,opacity:.6}),g}}class cs{constructor(e,s){b(this,"shape",null);this.paper=e,this.node=s}draw(e){var s,h,u;if((s=this.shape)==null||s.remove(),e===null)this.shape=null;else{const{father:g,childIndex:w,isOwnArea:l,direction:o}=e,k=this.node.getBBox(),N=g.getBBox();if(l)this.shape=new Ti({paper:this.paper,sourceBBox:N,targetBBox1:k,targetBBox2:k,targetDepth:g.depth+1,direction:o});else{const V=g.getDirectionChildren(o),W=((h=V[w-1])==null?void 0:h.getBBox())||null,lt=((u=V[w])==null?void 0:u.getBBox())||null;this.shape=new Ti({paper:this.paper,sourceBBox:N,targetBBox1:W,targetBBox2:lt,targetDepth:g.depth+1,direction:o})}g.isRoot()&&g.nodeShapeToFront()}}clear(){var e;(e=this.shape)==null||e.remove(),this.shape=null}}let ti={isDebug:!1};const ds=T=>{ti={...ti,...T}},Ii=()=>ti;class us{constructor(e){b(this,"shapeSet",null);this.paper=e}draw(e){const{isDebug:s}=Ii();s&&(this.shapeSet=this.paper.set(),e.forEach(({node:h,areaBox:u,childrenYList:g})=>{var W,lt;let w="green";h.children.length===0?w="red":h.depth===0&&(w="orange");const{x:l,y:o,x2:k,y2:N}=u,V=this.paper.rect(l,o,k-l,N-o).attr({"stroke-opacity":0,fill:w,opacity:.2});(W=this.shapeSet)==null||W.push(V),g==null||g.forEach(Q=>{var J;const q=this.paper.path(`M${l} ${Q}L${k} ${Q}`).attr({stroke:w,opacity:.6});(J=this.shapeSet)==null||J.push(q)}),(lt=this.shapeSet)==null||lt.toBack()}))}clear(){var s;const{isDebug:e}=Ii();e&&((s=this.shapeSet)==null||s.remove())}}const ps=80,Mi=100;class fs{constructor(e,s){b(this,"root");b(this,"drawDragArea",null);b(this,"dragTemp");b(this,"areaList",[]);b(this,"hitArea",null);this.node=s,this.dragTemp=new cs(e,s),this.drawDragArea=new us(e),this.root=s.getRoot()}drawTemp(e,s){const h=this.getHitArea(e,s);this.isSameHitArea(this.hitArea,h)||(this.dragTemp.draw(h),this.hitArea=h)}init(){var e;this.areaList=this.getAreaList(this.root),(e=this.drawDragArea)==null||e.draw(this.areaList)}clear(){var e;this.areaList=[],(e=this.drawDragArea)==null||e.clear(),this.dragTemp.clear()}getCurrentHitArea(){return this.hitArea}getHitArea(e,s){for(let h=0;h<this.areaList.length;h++){const{node:u,areaBox:g,childrenYList:w,direction:l}=this.areaList[h];if(e>=g.x&&e<=g.x2&&s>=g.y&&s<=g.y2){if(!w||w.length===0)return{father:u,childIndex:0,isOwnArea:this.isOwnArea(u,0,l),direction:l};for(let o=0;o<w.length-1;o++)if(s>=w[o]&&s<w[o+1])return{father:u,childIndex:o,isOwnArea:this.isOwnArea(u,o,l),direction:l}}}return null}isOwnArea(e,s,h){var w,l;const u=(w=this.node.father)==null?void 0:w.getDirectionChildren(h),g=u==null?void 0:u.findIndex(o=>o.id===this.node.id);return(e==null?void 0:e.id)===((l=this.node.father)==null?void 0:l.id)&&g!==void 0&&g>-1&&(s===g||s===g+1)}isSameHitArea(e,s){return(e==null?void 0:e.father.id)===(s==null?void 0:s.father.id)&&(e==null?void 0:e.childIndex)===(s==null?void 0:s.childIndex)&&(e==null?void 0:e.direction)===(s==null?void 0:s.direction)}getAreaList(e){const s=[],h=[{node:e,direction:bt.RIGHT},{node:e,direction:bt.LEFT}];for(;h.length>0;){const u=h.length;for(let g=0;g<u;g++){const{node:w,direction:l}=h.shift();if(this.node.id===w.id)continue;const o=this.getArea(w,l);s.unshift(o),w.getDirectionChildren(l).forEach(k=>h.push({node:k,direction:l}))}}return s}getArea(e,s){const h={x:0,y:0,x2:0,y2:0},u=e.getBBox(),g=e.getDirectionChildren(s);let w=0,l=0;if(g.length===0)w=u.y,l=u.y2;else{const V=g[0],W=g[g.length-1];w=V.getBBox().y,l=W.getBBox().y2}const o=this.getNodeYGap(e);w-=o,l+=o;const k=this.getChildBoundaryX(e,s);h.y=w,h.y2=l,e.isRoot()?(h.x=s===bt.RIGHT?u.cx:k,h.x2=s===bt.RIGHT?k:u.cx):(h.x=s===bt.RIGHT?u.x2:k,h.x2=s===bt.RIGHT?k:u.x);const N=this.getChildrenYList(g,h);return{node:e,areaBox:h,direction:s,childrenYList:N}}getChildrenYList(e,s){const h=[s.y];return e.forEach(u=>{const g=u.getBBox();h.push(g.cy)}),h.push(s.y2),h}getNodeYGap(e){const s=e.isRoot()?ps:0;return(ii(e.depth)+s)/2}getChildBoundaryX(e,s){const h=e.getDirectionChildren(s);if(h.length===0){const l=e.getBBox();return s===bt.RIGHT?l.x2+Mi:l.x-Mi}let u=h[0],g=u.getBBox().width;for(let l=1;l<h.length;l++){const o=h[l],k=o.getBBox();k.width>g&&(g=k.width,u=o)}const w=u.getBBox();return s===bt.RIGHT?w.x2:w.x}}class gs{constructor(e){b(this,"clonedNodeShape",null);this.originNodeShape=e}init(){this.clonedNodeShape=this.originNodeShape.clone(),this.clonedNodeShape.setStyle("disable")}translate(e,s){var h;(h=this.clonedNodeShape)==null||h.translate(e,s)}clear(){var e;(e=this.clonedNodeShape)==null||e.remove()}}const Ri=2;class vs{constructor({paper:e,node:s,nodeShape:h,viewport:u,traverse:g}){b(this,"node");b(this,"viewport");b(this,"paper");b(this,"dragArea");b(this,"dragClonedNode");b(this,"eventEmitter");b(this,"hitFather",null);b(this,"traverse");b(this,"isStart",!1);b(this,"isMoveInited",!1);b(this,"startX",0);b(this,"startY",0);b(this,"lastDx",0);b(this,"lastDy",0);b(this,"styleTypeMap",{});b(this,"start",(e,s,h)=>{h.stopPropagation(),this.isStart=!0;const u=this.viewport.getViewportPosition(e,s);this.startX=u.x,this.startY=u.y});b(this,"move",(e,s)=>{var w,l;const h=this.viewport.getScale(),u=e/h,g=s/h;if(this.isStart){if(!this.isMoveInited&&(Math.abs(e)>Ri||Math.abs(s)>Ri)&&(this.dragArea.init(),this.dragClonedNode.init(),this.dragClonedNode.translate(this.lastDx,this.lastDy),this.traverse(this.node,({node:o,nodeShape:k,expander:N,edgeShape:V})=>{this.styleTypeMap[o.id]=k.getStyle(),k.setStyle("disable"),N.setStyle("disable"),V==null||V.setStyle("disable")}),this.isMoveInited=!0,document.body.style.cursor="grabbing"),this.isMoveInited){const o=this.startX+u,k=this.startY+g;this.dragArea.drawTemp(o,k);const N=u-this.lastDx,V=g-this.lastDy;this.dragClonedNode.translate(N,V);const W=this.dragArea.getCurrentHitArea();(W==null?void 0:W.father.id)!==((w=this.hitFather)==null?void 0:w.id)&&(W==null||W.father.setStyle("overlay"),(l=this.hitFather)==null||l.setStyle("base")),this.hitFather=(W==null?void 0:W.father)||null}this.lastDx=u,this.lastDy=g}});b(this,"end",()=>{var s;if(this.isStart=!1,this.startX=0,this.startY=0,!this.isMoveInited)return;this.isMoveInited=!1,this.lastDx=0,this.lastDy=0,(s=this.hitFather)==null||s.setStyle("base"),this.hitFather=null;const e=this.dragArea.getCurrentHitArea();this.eventEmitter.emit("dragEnd",e),this.dragArea.clear(),this.dragClonedNode.clear(),document.body.style.cursor="default",this.traverse(this.node,({node:h,nodeShape:u,expander:g,edgeShape:w})=>{const l=this.styleTypeMap[h.id];u.setStyle(l),g.setStyle("base"),w==null||w.setStyle("base")}),this.styleTypeMap={}});this.paper=e,this.node=s,this.viewport=u,this.traverse=g,this.dragArea=new fs(this.paper,s),this.dragClonedNode=new gs(h),this.eventEmitter=new ie,h.on("drag",this.move,this.start,this.end)}clear(){this.eventEmitter.removeAllListeners()}on(e,s){this.eventEmitter.on(e,s)}}class ms{constructor({paper:e,sourceBBox:s,targetBBox:h,direction:u}){b(this,"shape");this.shape=Vi({paper:e,sourceBBox:s,targetBBox:h,direction:u}),this.shape.attr({stroke:"#000","stroke-width":2}),this.shape.toBack()}setStyle(e){switch(e){case"disable":{this.shape.attr({opacity:.4});break}case"base":default:{this.shape.attr({opacity:1});break}}}remove(){this.shape.remove()}}function ys(T){return new ms(T)}class xs{constructor({paper:e,sourceBBox:s,targetBBox:h,direction:u,targetDepth:g}){b(this,"shape");this.shape=Xi({paper:e,sourceBBox:s,targetBBox:h,direction:u,targetDepth:g,hasUnder:!0}),this.shape.attr({stroke:"#000","stroke-width":1.5}),this.shape.toBack()}setStyle(e){switch(e){case"disable":{this.shape.attr({opacity:.4});break}case"base":default:{this.shape.attr({opacity:1});break}}}remove(){this.shape.remove()}}function bs(T){return new xs(T)}class ws{constructor({paper:e,depth:s,label:h,direction:u,father:g}){b(this,"paper");b(this,"depth");b(this,"label");b(this,"father",null);b(this,"direction");this.paper=e,this.depth=s,this.label=h,this.father=g,this.direction=u}createNode(e,s){const{paper:h,depth:u,label:g}=this,w={paper:h,x:e,y:s,label:g},l=De(u);return l===$t.root?kr(w):l===$t.firstLevel?Br(w):Tr(w)}createEdge(e){const{father:s,direction:h,depth:u}=this;if(!s||!h)return null;const g=De(u);return g===$t.firstLevel?ys({paper:this.paper,sourceBBox:s.getBBox(),targetBBox:e.getBBox(),direction:h}):g===$t.grandchild?bs({paper:this.paper,sourceBBox:s.getBBox(),targetBBox:e.getBBox(),direction:h,targetDepth:this.depth}):null}}class Ss{constructor({paper:e,position:s,node:h,nodeShape:u,isExpand:g,traverse:w}){b(this,"paper");b(this,"position");b(this,"node");b(this,"nodeShape");b(this,"traverse");b(this,"eventEmitter");b(this,"expanderShape",null);b(this,"isExpand");this.paper=e,this.position=s,this.node=h,this.nodeShape=u,this.isExpand=g,this.traverse=w,this.eventEmitter=new ie}getIsExpand(){return this.isExpand}changeExpand(e,s=!0){var h;if(this.isExpand!==e){if(this.node.children.length===0){this.remove();return}(h=this.expanderShape)==null||h.changeExpand(e),this.isExpand=e,e||this.node.children.forEach(u=>{this.traverse(u,this.hideNode)}),s&&this.position.reset(this.node.direction)}}create(){this.createShape(),this.translateShape()}remove(){var e;(e=this.expanderShape)==null||e.remove(),this.expanderShape=null,this.eventEmitter.removeAllListeners()}on(e,s){this.eventEmitter.on(e,s)}setStyle(e){var s;(s=this.expanderShape)==null||s.setStyle(e)}createShape(){var e;this.node.isRoot()||this.expanderShape!==null||this.node.children.length===0||this.nodeShape.getIsHide()||(this.expanderShape=new os({paper:this.paper,nodeBBox:this.node.getBBox(),isExpand:this.isExpand,direction:this.node.direction}),(e=this.expanderShape)==null||e.on("mousedown",s=>{s.stopPropagation();const h=!this.isExpand;this.changeExpand(h),this.eventEmitter.emit("mousedownExpander",h)}))}translateShape(){var e;(e=this.expanderShape)==null||e.translateTo(this.node.getBBox(),this.node.direction)}hideNode({nodeShape:e,expander:s,removeEdgeShape:h}){e.hide(),s.remove(),h()}}class Es{constructor({paper:e,id:s,depth:h,label:u,direction:g,x:w,y:l,father:o=null,isExpand:k,viewport:N}){b(this,"position");b(this,"shapeGenerator");b(this,"_id");b(this,"_depth");b(this,"_direction");b(this,"_father",null);b(this,"nodeShape");b(this,"expander");b(this,"drag",null);b(this,"_label");b(this,"_children");b(this,"edgeShape",null);b(this,"removeEdgeShape",()=>{var e;(e=this.edgeShape)==null||e.remove(),this.edgeShape=null});this._id=s,this._depth=h,this._direction=g,this._father=o||null,this._label=u,this._children=[],this.shapeGenerator=new ws({paper:e,depth:h,label:u,direction:g,father:o}),this.nodeShape=this.shapeGenerator.createNode(w,l),(w!==void 0||l!==void 0)&&(this.edgeShape=this.shapeGenerator.createEdge(this.nodeShape)),this.isRoot()||(this.drag=new vs({paper:e,node:this,viewport:N,nodeShape:this.nodeShape,traverse:this.traverse})),this.position=new ri(this.getRoot()),this.expander=new Ss({paper:e,position:this.position,node:this,nodeShape:this.nodeShape,isExpand:k===void 0?!0:k,traverse:this.traverse})}get id(){return this._id}get depth(){return this._depth}get direction(){return this._direction}get father(){return this._father}get label(){return this._label}get children(){return this._children}get isExpand(){return this.expander.getIsExpand()}getDirectionChildren(e){var s;return((s=this.children)==null?void 0:s.filter(h=>h.direction===e))||[]}getBBox(){return this.nodeShape.getBBox()}getDepthType(){return De(this.depth)}getRoot(){let e=this;for(;e&&e.getDepthType()!==$t.root;)e=e.father;return e}isRoot(){return this.getDepthType()===$t.root}on(e,...s){var w;const h=["mousedown","click","dblclick","drag"],u=["mousedownExpander"],g=["dragEnd"];if(h.includes(e)){if(e==="drag"&&!this.isRoot())return;this.nodeShape.on(e,...s)}else u.includes(e)?this.expander.on(e,...s):g.includes(e)&&((w=this.drag)==null||w.on(e,...s))}clearChild(){this._children=[]}pushChild(e){this.children.push(e)}insertAfterChild(e,s){const h=this.children.findIndex(u=>u.id===e.id);h>-1&&this.children.splice(h+1,0,s)}spliceChild(e,s,h,u){if(this.isRoot()){let g=-1,w=0,l=0;for(l=0;l<this.children.length;l++)if(this.children[l].direction===h){if(e===w){g=l;break}w++}g===-1&&(g=l),this.children.splice(g,s,...u)}else this.children.splice(e,s,...u)}changeExpand(e,s=!0){e!==void 0&&this.expander.changeExpand(e,s)}translateTo(e,s){var h;this.nodeShape.translateTo(e,s),this.removeEdgeShape(),this.edgeShape=this.shapeGenerator.createEdge(this.nodeShape),(h=this.father)==null||h.expander.create(),this.expander.create()}remove(){var e,s;if(!this.isRoot()){const h=(e=this.father)==null?void 0:e.children;if(!h)return;const u=h==null?void 0:h.findIndex(g=>this.id===g.id);u>-1&&h.splice(u,1),h.length===0&&((s=this.father)==null||s.expander.remove())}this.traverse(this,({node:h})=>{var u;h.nodeShape.remove(),h.removeEdgeShape(),h.expander.remove(),(u=h.drag)==null||u.clear()})}setLabel(e,s=!0){this._label=e,this.nodeShape.setLabel(e,this.direction),s&&this.position.reset(this.direction)}setStyle(e){this.nodeShape.setStyle(e)}nodeShapeToFront(){this.nodeShape.toFront()}traverse(e,s){s({node:e,nodeShape:e.nodeShape,expander:e.expander,edgeShape:e.edgeShape,removeEdgeShape:e.removeEdgeShape}),e.children.forEach(h=>this.traverse(h,s))}}const _s=["mousedown","click","dblclick","mousedownExpander","dragEnd"];class ks{constructor({paper:e,viewport:s}){b(this,"paper");b(this,"viewport");b(this,"eventEmitter");b(this,"createNode",({id:e,depth:s,label:h,direction:u,x:g,y:w,father:l,isExpand:o})=>{const k=new Es({paper:this.paper,id:e||ei(),depth:s,label:h,direction:u,x:g,y:w,father:l,isExpand:o,viewport:this.viewport});return _s.forEach(N=>{k.on(N,(...V)=>{this.eventEmitter.emit(N,k,...V)})}),k});this.paper=e,this.viewport=s,this.eventEmitter=new ie}on(e,s){this.eventEmitter.on(e,s)}clear(){this.eventEmitter.removeAllListeners()}}class Cs{constructor({nodeCreator:e,selection:s,textEditor:h,dataProxy:u,treeOperation:g}){e.on("mousedown",w=>{s.selectSingle(w)}),e.on("dblclick",()=>{h.showBySelectionLabel()}),e.on("dragEnd",(w,l)=>{var o;l!==null&&!l.isOwnArea&&((o=g.changeFather)==null||o.call(g,{newFather:l.father,direction:l.direction,nodes:[w],childIndex:l.childIndex}))}),e.on("mousedownExpander",(w,l)=>{u.setData(w.id,{isExpand:l}),s.select([w])})}}class Ns{constructor({root:e,tree:s,selection:h,dataProxy:u,treeOperation:g}){b(this,"root");b(this,"tree");b(this,"selection");b(this,"dataProxy");b(this,"treeOperation");this.root=e,this.tree=s,this.selection=h,this.dataProxy=u,this.treeOperation=g}undo(){const{data:e,selectIds:s}=this.dataProxy.undo()||{};this.tree.render(e),this.selectByIds(s)}redo(){const{data:e,selectIds:s}=this.dataProxy.redo()||{};this.tree.render(e),this.selectByIds(s)}addChildNode(){this.treeOperation.addChildNode()}addBrotherNode(){this.treeOperation.addBrotherNode()}removeNode(){this.treeOperation.removeNode()}getNodeMap(){const e={};return this.setNodeMapInner(this.root,e),e}selectByIds(e){if(!e)return;const s=this.getNodeMap(),h=e.reduce((u,g)=>(s[g]&&u.push(s[g]),u),[]);this.selection.select(h)}setNodeMapInner(e,s){s[e.id]=e,e.children.forEach(h=>this.setNodeMapInner(h,s))}}const Ai=.25;class Bs{constructor({paperWrapper:e,viewport:s}){b(this,"viewport");b(this,"el");b(this,"scaleLabelEl");this.viewport=s;const h=this.element();this.el=h.el,this.scaleLabelEl=h.scaleLabelEl,e.getWrapperDom().appendChild(this.el.getDom()),s.on("changeScale",g=>{this.scaleLabelEl.setHtml(this.getScalePercent(g))})}element(){const e=this.viewport.getScale(),s=Gt("div","scale-btn").setChild(Gt("div","scale-btn-icon zoom-out")),h=Gt("div","scale-btn").setChild(Gt("div","scale-btn-icon zoom-in")),u=Gt("div","scale-label").setChild(this.getScalePercent(e)),g=Gt("div","viewport-scale-controller").setChildren(s,u,h);return s.addEventListener("click",()=>{this.viewport.addScale(-Ai)},!1),h.addEventListener("click",()=>{this.viewport.addScale(Ai)},!1),u.addEventListener("click",()=>{this.viewport.setScale(1)},!1),{el:g,scaleLabelEl:u}}getScalePercent(e){return`${Math.floor(e*100)}%`}}class Is{constructor({container:e,data:s,isDebug:h=!1}){b(this,"paperWrapper");b(this,"viewportInteraction");b(this,"tree");b(this,"keyboard");b(this,"multiSelect");b(this,"nodeCreator");ds({isDebug:h}),this.paperWrapper=new $r(e);const u=this.paperWrapper.getPaper(),g=new fr(this.paperWrapper),w=new Ar;this.nodeCreator=new ks({paper:u,viewport:g});const l=Gi(s);this.tree=new lr({viewport:g,data:l,selection:w,nodeCreator:this.nodeCreator});const o=this.tree.getRoot(),k=new Vr({data:l,selection:w,root:o}),N=new dr({root:o,selection:w,dataProxy:k,nodeCreator:this.nodeCreator}),V=new Ir({viewport:g,selection:w,dataProxy:k,paperWrapper:this.paperWrapper});new Cs({nodeCreator:this.nodeCreator,selection:w,textEditor:V,dataProxy:k,treeOperation:N}),this.viewportInteraction=new ns({paperWrapper:this.paperWrapper,viewport:g,root:o});const W=new Ns({root:o,tree:this.tree,selection:w,dataProxy:k,treeOperation:N});this.multiSelect=new Hr({paperWrapper:this.paperWrapper,viewport:g,selection:w,toolOperation:W}),this.keyboard=new Or({toolOperation:W,selection:w,textEditor:V,multiSelect:this.multiSelect,viewportInteraction:this.viewportInteraction}),new Jr({paperWrapper:this.paperWrapper,toolOperation:W,selection:w,dataProxy:k,textEditor:V,viewportInteraction:this.viewportInteraction}),new Bs({paperWrapper:this.paperWrapper,viewport:g})}clear(){this.paperWrapper.clear(),this.nodeCreator.clear(),this.tree.clear(),this.viewportInteraction.clear(),this.multiSelect.clear(),this.keyboard.clear()}}const Ds=T=>{const e=new URLSearchParams(window.location.search);return Object.fromEntries(e.entries())[T]||""},Ms=Ds("debug")==="1";export{Is as M,Ms as i};
